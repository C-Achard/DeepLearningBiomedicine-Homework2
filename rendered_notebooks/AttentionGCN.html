

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Attention GCN &#8212; Deep Learning in Biomedicine - Homework 2</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=c5ced968eda925caa686" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=c5ced968eda925caa686" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=c5ced968eda925caa686"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'rendered_notebooks/AttentionGCN';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Edge-Enhanced Attention GCN" href="EdgeAttentionGCN.html" />
    <link rel="prev" title="GraphSAGE" href="SAGE.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Deep Learning in Biomedicine - Homework 2 - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Deep Learning in Biomedicine - Homework 2 - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Dataset &amp; preprocessing</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Dataset.html">MUTAG Dataset</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Hyperparameter tuning</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../wandb_comparisons/GCN_comparison.html">Hyperparameter tuning for GCN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wandb_comparisons/SAGE_comparison.html">Hyperparameter tuning for GraphSAGE</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wandb_comparisons/AttGCN_comparison.html">Hyperparameter tuning for Attention GCN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wandb_comparisons/EdgeAttGCN_comparison.html">Hyperparameter tuning for Edge-Enhanced Attention GCN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wandb_comparisons/best_runs.html">Summary of model performance</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Best models notebooks</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="GCN.html">Graph Convolutional Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="SAGE.html">GraphSAGE</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Attention GCN</a></li>
<li class="toctree-l1"><a class="reference internal" href="EdgeAttentionGCN.html">Edge-Enhanced Attention GCN</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/C-Achard/DeepLearningBiomedicine-Homework2" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/rendered_notebooks/AttentionGCN.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Attention GCN</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-definition">Layer definition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training">Training</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model">Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-parameters">Training parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#train-loop">Train loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plots-of-training-history">Plots of training history</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-on-unseen-data">Validation on unseen data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#full-dataset-performance">Full dataset performance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-roc-curve">Full ROC curve</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predictions-distribution">Predictions distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confusion-matrix">Confusion matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-mislabelled-molecules">Check mislabelled molecules</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="attention-gcn">
<span id="section-attention"></span><h1>Attention GCN<a class="headerlink" href="#attention-gcn" title="Permalink to this heading">#</a></h1>
<section id="layer-definition">
<h2>Layer definition<a class="headerlink" href="#layer-definition" title="Permalink to this heading">#</a></h2>
<p>We use the provided formula to define the Attention GCN layer; the only difference is that in order to obtain attention score for first-order neighbors, as suggested in the original paper, we
multiply the attention score matrix by the adjacency matrix.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">sys</span> <span class="kn">import</span> <span class="n">path</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">environ</span>

<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span>
    <span class="s2">&quot;ignore&quot;</span>
<span class="p">)</span>  <span class="c1"># ignore warnings from missing deterministic implementation</span>
<span class="n">environ</span><span class="p">[</span>
    <span class="s2">&quot;WANDB_NOTEBOOK_NAME&quot;</span>
<span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AttentionGCN.ipynb&quot;</span>  <span class="c1"># set notebook name for wandb</span>
<span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;../code&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span><span class="p">,</span> <span class="n">ConfusionMatrixDisplay</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">model</span> <span class="k">as</span> <span class="nn">m</span>
<span class="kn">import</span> <span class="nn">training</span> <span class="k">as</span> <span class="nn">t</span>
<span class="kn">import</span> <span class="nn">utils</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">LOG</span> <span class="k">as</span> <span class="n">logger</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span>
    <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%(message)s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span>
<span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="c1"># logger.setLevel(logging.DEBUG)</span>

<span class="n">t</span><span class="o">.</span><span class="n">WANDB_MODE</span> <span class="o">=</span> <span class="s2">&quot;disabled&quot;</span>

<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda:0&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataloaders</span><span class="p">,</span> <span class="n">dataset</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">create_dataloaders</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Length of train set: 131
Length of validation set: 28
Length of test set: 29
</pre></div>
</div>
</div>
</div>
</section>
<section id="training">
<h2>Training<a class="headerlink" href="#training" title="Permalink to this heading">#</a></h2>
<section id="model">
<h3>Model<a class="headerlink" href="#model" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node_features</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">node_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">conv_dims</span> <span class="o">=</span> <span class="p">[</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">32</span><span class="p">]</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">AttentionGCN</span><span class="p">(</span>
    <span class="n">num_features</span><span class="o">=</span><span class="n">node_features</span><span class="p">,</span>
    <span class="n">conv_dims</span><span class="o">=</span><span class="n">conv_dims</span><span class="p">,</span>
    <span class="c1"># fcn_layers=[128],</span>
    <span class="n">activation</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">LeakyReLU</span><span class="p">(),</span>
    <span class="n">dropout</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">pooling</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span>
    <span class="n">norm</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">BatchNorm1d</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># utils._print_gradient_hook(model)</span>


<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Initialized model with 5 graph conv layers
Initialized model with 1 fully connected layers
AttentionGCN(
  (convs_layers): ModuleList(
    (0): AttentionConv(
      (weight): Linear(in_features=7, out_features=256, bias=False)
      (S): Linear(in_features=512, out_features=28, bias=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (att_activation): LeakyReLU(negative_slope=0.2)
      (softmax): Softmax(dim=2)
    )
    (1): AttentionConv(
      (weight): Linear(in_features=256, out_features=256, bias=False)
      (S): Linear(in_features=512, out_features=28, bias=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (att_activation): LeakyReLU(negative_slope=0.2)
      (softmax): Softmax(dim=2)
    )
    (2): AttentionConv(
      (weight): Linear(in_features=256, out_features=128, bias=False)
      (S): Linear(in_features=256, out_features=28, bias=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (att_activation): LeakyReLU(negative_slope=0.2)
      (softmax): Softmax(dim=2)
    )
    (3): AttentionConv(
      (weight): Linear(in_features=128, out_features=64, bias=False)
      (S): Linear(in_features=128, out_features=28, bias=False)
      (activation): LeakyReLU(negative_slope=0.01)
      (att_activation): LeakyReLU(negative_slope=0.2)
      (softmax): Softmax(dim=2)
    )
    (4): AttentionConv(
      (weight): Linear(in_features=64, out_features=32, bias=False)
      (S): Linear(in_features=64, out_features=28, bias=False)
      (activation): Identity()
      (att_activation): LeakyReLU(negative_slope=0.2)
      (softmax): Softmax(dim=2)
    )
  )
  (batch_norms): ModuleList(
    (0-1): 2 x BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (4): Identity()
  )
  (fcn_layers): ModuleList(
    (0): Linear(in_features=32, out_features=1, bias=True)
  )
  (dropout): Dropout(p=0.3, inplace=False)
  (pooling): MaxPooling()
)
</pre></div>
</div>
</div>
</div>
</section>
<section id="training-parameters">
<h3>Training parameters<a class="headerlink" href="#training-parameters" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">1e-4</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">1500</span>

<span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

<span class="n">label_counts</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[:][</span><span class="s2">&quot;class_y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pos_weight</span> <span class="o">=</span> <span class="n">label_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">label_counts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">BCEWithLogitsLoss</span><span class="p">(</span><span class="n">pos_weight</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">pos_weight</span><span class="p">))</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">)</span>

<span class="n">history</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;acc&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;val-roc&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;val-ap&quot;</span><span class="p">:</span> <span class="p">[],</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="train-loop">
<h3>Train loop<a class="headerlink" href="#train-loop" title="Permalink to this heading">#</a></h3>
<div class="cell tag_output_scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">train_loop</span><span class="p">(</span>
    <span class="n">history</span><span class="o">=</span><span class="n">history</span><span class="p">,</span>
    <span class="n">train_dataloader</span><span class="o">=</span><span class="n">dataloaders</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">val_dataloader</span><span class="o">=</span><span class="n">dataloaders</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">optimizer</span><span class="o">=</span><span class="n">optimizer</span><span class="p">,</span>
    <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss_fn</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="n">epochs</span><span class="p">,</span>
    <span class="n">device</span><span class="o">=</span><span class="n">DEVICE</span><span class="p">,</span>
    <span class="n">use_scheduler</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">test_dataloader</span><span class="o">=</span><span class="n">dataloaders</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Watching
Epoch   1/1500:Epoch loss: 0.4591 - avg acc: 30.5% - val-roc: 0.2577 - val-ap: 0.4456 (0.4s/epoch)
Epoch   2/1500:Epoch loss: 0.4697 - avg acc: 30.5% - val-roc: 0.2092 - val-ap: 0.4293 (0.1s/epoch)
Epoch   3/1500:Epoch loss: 0.4851 - avg acc: 30.5% - val-roc: 0.2245 - val-ap: 0.4424 (0.1s/epoch)
Epoch   4/1500:Epoch loss: 0.4719 - avg acc: 30.5% - val-roc: 0.2551 - val-ap: 0.4602 (0.1s/epoch)
Epoch   5/1500:Epoch loss: 0.4716 - avg acc: 30.5% - val-roc: 0.3469 - val-ap: 0.4894 (0.2s/epoch)
Epoch   6/1500:Epoch loss: 0.4569 - avg acc: 30.5% - val-roc: 0.6429 - val-ap: 0.6902 (0.1s/epoch)
Epoch   7/1500:Epoch loss: 0.4687 - avg acc: 30.5% - val-roc: 0.8214 - val-ap: 0.8710 (0.2s/epoch)
Epoch   8/1500:Epoch loss: 0.4642 - avg acc: 30.5% - val-roc: 0.8061 - val-ap: 0.8536 (0.1s/epoch)
Epoch   9/1500:Epoch loss: 0.4610 - avg acc: 30.5% - val-roc: 0.7245 - val-ap: 0.7538 (0.1s/epoch)
Epoch  10/1500:Epoch loss: 0.4638 - avg acc: 30.5% - val-roc: 0.6709 - val-ap: 0.6948 (0.1s/epoch)
Epoch  11/1500:Epoch loss: 0.4593 - avg acc: 30.5% - val-roc: 0.4796 - val-ap: 0.5723 (0.2s/epoch)
Epoch  12/1500:Epoch loss: 0.4704 - avg acc: 30.5% - val-roc: 0.6531 - val-ap: 0.6524 (0.2s/epoch)
Epoch  13/1500:Epoch loss: 0.4666 - avg acc: 30.5% - val-roc: 0.7653 - val-ap: 0.7834 (0.2s/epoch)
Epoch  14/1500:Epoch loss: 0.4604 - avg acc: 30.5% - val-roc: 0.6786 - val-ap: 0.7161 (0.1s/epoch)
Epoch  15/1500:Epoch loss: 0.4624 - avg acc: 30.5% - val-roc: 0.6480 - val-ap: 0.7436 (0.1s/epoch)
Epoch  16/1500:Epoch loss: 0.4773 - avg acc: 30.5% - val-roc: 0.6582 - val-ap: 0.6540 (0.2s/epoch)
Epoch  17/1500:Epoch loss: 0.4628 - avg acc: 30.5% - val-roc: 0.6990 - val-ap: 0.7318 (0.1s/epoch)
Epoch  18/1500:Epoch loss: 0.4669 - avg acc: 30.5% - val-roc: 0.7041 - val-ap: 0.6786 (0.1s/epoch)
Epoch  19/1500:Epoch loss: 0.4715 - avg acc: 30.5% - val-roc: 0.7551 - val-ap: 0.7947 (0.1s/epoch)
Epoch  20/1500:Epoch loss: 0.4721 - avg acc: 30.5% - val-roc: 0.7143 - val-ap: 0.7253 (0.2s/epoch)
Epoch  21/1500:Epoch loss: 0.4668 - avg acc: 30.5% - val-roc: 0.6735 - val-ap: 0.6532 (0.1s/epoch)
Epoch  22/1500:Epoch loss: 0.4669 - avg acc: 30.5% - val-roc: 0.7755 - val-ap: 0.8287 (0.2s/epoch)
Epoch  23/1500:Epoch loss: 0.4592 - avg acc: 30.5% - val-roc: 0.8724 - val-ap: 0.9087 (0.1s/epoch)
Epoch  24/1500:Epoch loss: 0.4576 - avg acc: 30.5% - val-roc: 0.8316 - val-ap: 0.8615 (0.2s/epoch)
Epoch  25/1500:Epoch loss: 0.4526 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8914 (0.1s/epoch)
Epoch  26/1500:Epoch loss: 0.4510 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8723 (0.2s/epoch)
Epoch  27/1500:Epoch loss: 0.4458 - avg acc: 30.5% - val-roc: 0.7398 - val-ap: 0.8109 (0.1s/epoch)
Epoch  28/1500:Epoch loss: 0.4462 - avg acc: 30.5% - val-roc: 0.7908 - val-ap: 0.8021 (0.1s/epoch)
Epoch  29/1500:Epoch loss: 0.4489 - avg acc: 30.5% - val-roc: 0.7857 - val-ap: 0.7321 (0.1s/epoch)
Epoch  30/1500:Epoch loss: 0.4567 - avg acc: 30.5% - val-roc: 0.7959 - val-ap: 0.7360 (0.2s/epoch)
Epoch  31/1500:Epoch loss: 0.4659 - avg acc: 30.5% - val-roc: 0.8010 - val-ap: 0.7453 (0.1s/epoch)
Epoch  32/1500:Epoch loss: 0.4576 - avg acc: 30.5% - val-roc: 0.7551 - val-ap: 0.6754 (0.2s/epoch)
Epoch  33/1500:Epoch loss: 0.4490 - avg acc: 30.5% - val-roc: 0.7755 - val-ap: 0.8064 (0.1s/epoch)
Epoch  34/1500:Epoch loss: 0.4600 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8747 (0.2s/epoch)
Epoch  35/1500:Epoch loss: 0.4564 - avg acc: 30.5% - val-roc: 0.8622 - val-ap: 0.8968 (0.2s/epoch)
Epoch  36/1500:Epoch loss: 0.4477 - avg acc: 30.5% - val-roc: 0.8724 - val-ap: 0.9042 (0.2s/epoch)
Epoch  37/1500:Epoch loss: 0.4487 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.9042 (0.2s/epoch)
Epoch  38/1500:Epoch loss: 0.4565 - avg acc: 30.5% - val-roc: 0.9133 - val-ap: 0.9391 (0.1s/epoch)
Epoch  39/1500:Epoch loss: 0.4543 - avg acc: 30.5% - val-roc: 0.8316 - val-ap: 0.8766 (0.2s/epoch)
Epoch  40/1500:Epoch loss: 0.4524 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.9013 (0.2s/epoch)
Epoch  41/1500:Epoch loss: 0.4466 - avg acc: 30.5% - val-roc: 0.8878 - val-ap: 0.9197 (0.2s/epoch)
Epoch  42/1500:Epoch loss: 0.4505 - avg acc: 30.5% - val-roc: 0.8367 - val-ap: 0.8247 (0.2s/epoch)
Epoch  43/1500:Epoch loss: 0.4583 - avg acc: 30.5% - val-roc: 0.8061 - val-ap: 0.8381 (0.2s/epoch)
Epoch  44/1500:Epoch loss: 0.4563 - avg acc: 30.5% - val-roc: 0.7959 - val-ap: 0.8517 (0.1s/epoch)
Epoch  45/1500:Epoch loss: 0.4515 - avg acc: 30.5% - val-roc: 0.7551 - val-ap: 0.7254 (0.1s/epoch)
Epoch  46/1500:Epoch loss: 0.4538 - avg acc: 30.5% - val-roc: 0.7704 - val-ap: 0.7232 (0.2s/epoch)
Epoch  47/1500:Epoch loss: 0.4380 - avg acc: 30.5% - val-roc: 0.8163 - val-ap: 0.8172 (0.2s/epoch)
Epoch  48/1500:Epoch loss: 0.4715 - avg acc: 30.5% - val-roc: 0.7602 - val-ap: 0.7359 (0.1s/epoch)
Epoch  49/1500:Epoch loss: 0.4527 - avg acc: 30.5% - val-roc: 0.8010 - val-ap: 0.7613 (0.1s/epoch)
Epoch  50/1500:Epoch loss: 0.4416 - avg acc: 30.5% - val-roc: 0.8571 - val-ap: 0.8663 (0.1s/epoch)
Epoch  51/1500:Epoch loss: 0.4538 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8183 (0.1s/epoch)
Epoch  52/1500:Epoch loss: 0.4498 - avg acc: 30.5% - val-roc: 0.7959 - val-ap: 0.7740 (0.2s/epoch)
Epoch  53/1500:Epoch loss: 0.4580 - avg acc: 30.5% - val-roc: 0.8010 - val-ap: 0.7498 (0.1s/epoch)
Epoch  54/1500:Epoch loss: 0.4418 - avg acc: 30.5% - val-roc: 0.8367 - val-ap: 0.7764 (0.1s/epoch)
Epoch  55/1500:Epoch loss: 0.4652 - avg acc: 30.5% - val-roc: 0.8418 - val-ap: 0.8586 (0.1s/epoch)
Epoch  56/1500:Epoch loss: 0.4430 - avg acc: 30.5% - val-roc: 0.8163 - val-ap: 0.7645 (0.2s/epoch)
Epoch  57/1500:Epoch loss: 0.4535 - avg acc: 30.5% - val-roc: 0.8214 - val-ap: 0.7673 (0.1s/epoch)
Epoch  58/1500:Epoch loss: 0.4317 - avg acc: 30.5% - val-roc: 0.8418 - val-ap: 0.8112 (0.1s/epoch)
Epoch  59/1500:Epoch loss: 0.4529 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8761 (0.2s/epoch)
Epoch  60/1500:Epoch loss: 0.4423 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8411 (0.2s/epoch)
Epoch  61/1500:Epoch loss: 0.4355 - avg acc: 30.5% - val-roc: 0.8980 - val-ap: 0.9330 (0.2s/epoch)
Epoch  62/1500:Epoch loss: 0.4437 - avg acc: 30.5% - val-roc: 0.8724 - val-ap: 0.8923 (0.2s/epoch)
Epoch  63/1500:Epoch loss: 0.4441 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8804 (0.1s/epoch)
Epoch  64/1500:Epoch loss: 0.4460 - avg acc: 30.5% - val-roc: 0.8520 - val-ap: 0.8600 (0.1s/epoch)
Epoch  65/1500:Epoch loss: 0.4436 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8290 (0.1s/epoch)
Epoch  66/1500:Epoch loss: 0.4504 - avg acc: 30.5% - val-roc: 0.8622 - val-ap: 0.9073 (0.2s/epoch)
Epoch  67/1500:Epoch loss: 0.4429 - avg acc: 30.5% - val-roc: 0.8571 - val-ap: 0.9020 (0.1s/epoch)
Epoch  68/1500:Epoch loss: 0.4386 - avg acc: 30.5% - val-roc: 0.8367 - val-ap: 0.8193 (0.1s/epoch)
Epoch  69/1500:Epoch loss: 0.4527 - avg acc: 30.5% - val-roc: 0.8367 - val-ap: 0.8170 (0.2s/epoch)
Epoch  70/1500:Epoch loss: 0.4546 - avg acc: 30.5% - val-roc: 0.7857 - val-ap: 0.7899 (0.1s/epoch)
Epoch  71/1500:Epoch loss: 0.4438 - avg acc: 30.5% - val-roc: 0.7704 - val-ap: 0.7846 (0.1s/epoch)
Epoch  72/1500:Epoch loss: 0.4371 - avg acc: 30.5% - val-roc: 0.7755 - val-ap: 0.7862 (0.2s/epoch)
Epoch  73/1500:Epoch loss: 0.4436 - avg acc: 30.5% - val-roc: 0.7908 - val-ap: 0.8527 (0.1s/epoch)
Epoch  74/1500:Epoch loss: 0.4340 - avg acc: 30.5% - val-roc: 0.7806 - val-ap: 0.8197 (0.1s/epoch)
Epoch  75/1500:Epoch loss: 0.4558 - avg acc: 30.5% - val-roc: 0.8265 - val-ap: 0.8559 (0.2s/epoch)
Epoch  76/1500:Epoch loss: 0.4405 - avg acc: 30.5% - val-roc: 0.7857 - val-ap: 0.8424 (0.1s/epoch)
Epoch  77/1500:Epoch loss: 0.4348 - avg acc: 30.5% - val-roc: 0.7347 - val-ap: 0.7572 (0.2s/epoch)
Epoch  78/1500:Epoch loss: 0.4355 - avg acc: 30.5% - val-roc: 0.8418 - val-ap: 0.8198 (0.2s/epoch)
Epoch  79/1500:Epoch loss: 0.4495 - avg acc: 30.5% - val-roc: 0.7653 - val-ap: 0.7842 (0.1s/epoch)
Epoch  80/1500:Epoch loss: 0.4364 - avg acc: 30.5% - val-roc: 0.7500 - val-ap: 0.7414 (0.2s/epoch)
Epoch  81/1500:Epoch loss: 0.4338 - avg acc: 30.5% - val-roc: 0.7551 - val-ap: 0.7798 (0.2s/epoch)
Epoch  82/1500:Epoch loss: 0.4386 - avg acc: 30.5% - val-roc: 0.7449 - val-ap: 0.7693 (0.1s/epoch)
Epoch  83/1500:Epoch loss: 0.4386 - avg acc: 30.5% - val-roc: 0.7449 - val-ap: 0.7769 (0.2s/epoch)
Epoch  84/1500:Epoch loss: 0.4365 - avg acc: 30.5% - val-roc: 0.7449 - val-ap: 0.7608 (0.2s/epoch)
Epoch  85/1500:Epoch loss: 0.4459 - avg acc: 30.5% - val-roc: 0.8112 - val-ap: 0.8813 (0.2s/epoch)
Epoch  86/1500:Epoch loss: 0.4519 - avg acc: 30.5% - val-roc: 0.8418 - val-ap: 0.8492 (0.1s/epoch)
Epoch  87/1500:Epoch loss: 0.4421 - avg acc: 30.5% - val-roc: 0.8214 - val-ap: 0.8623 (0.2s/epoch)
Epoch  88/1500:Epoch loss: 0.4386 - avg acc: 30.5% - val-roc: 0.8316 - val-ap: 0.8164 (0.1s/epoch)
Epoch  89/1500:Epoch loss: 0.4480 - avg acc: 30.5% - val-roc: 0.8214 - val-ap: 0.8132 (0.1s/epoch)
Epoch  90/1500:Epoch loss: 0.4308 - avg acc: 30.5% - val-roc: 0.8316 - val-ap: 0.8164 (0.1s/epoch)
Epoch  91/1500:Epoch loss: 0.4485 - avg acc: 30.5% - val-roc: 0.8265 - val-ap: 0.8145 (0.1s/epoch)
Epoch  92/1500:Epoch loss: 0.4491 - avg acc: 30.5% - val-roc: 0.8163 - val-ap: 0.8115 (0.2s/epoch)
Epoch  93/1500:Epoch loss: 0.4425 - avg acc: 30.5% - val-roc: 0.8418 - val-ap: 0.8206 (0.1s/epoch)
Epoch  94/1500:Epoch loss: 0.4436 - avg acc: 30.5% - val-roc: 0.8112 - val-ap: 0.8068 (0.2s/epoch)
Epoch  95/1500:Epoch loss: 0.4553 - avg acc: 30.5% - val-roc: 0.8010 - val-ap: 0.7977 (0.1s/epoch)
Epoch  96/1500:Epoch loss: 0.4703 - avg acc: 30.5% - val-roc: 0.8010 - val-ap: 0.7922 (0.1s/epoch)
Epoch  97/1500:Epoch loss: 0.4595 - avg acc: 30.5% - val-roc: 0.8163 - val-ap: 0.8009 (0.1s/epoch)
Epoch  98/1500:Epoch loss: 0.4448 - avg acc: 30.5% - val-roc: 0.8520 - val-ap: 0.8752 (0.1s/epoch)
Epoch  99/1500:Epoch loss: 0.4305 - avg acc: 30.5% - val-roc: 0.8010 - val-ap: 0.7878 (0.2s/epoch)
Epoch  100/1500:Epoch loss: 0.4390 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8405 (0.1s/epoch)
Epoch  101/1500:Epoch loss: 0.4605 - avg acc: 30.5% - val-roc: 0.8571 - val-ap: 0.8248 (0.1s/epoch)
Epoch  102/1500:Epoch loss: 0.4409 - avg acc: 30.5% - val-roc: 0.8316 - val-ap: 0.8071 (0.1s/epoch)
Epoch  103/1500:Epoch loss: 0.4382 - avg acc: 30.5% - val-roc: 0.8163 - val-ap: 0.8036 (0.1s/epoch)
Epoch  104/1500:Epoch loss: 0.4178 - avg acc: 30.5% - val-roc: 0.8367 - val-ap: 0.8105 (0.1s/epoch)
Epoch  105/1500:Epoch loss: 0.4277 - avg acc: 30.5% - val-roc: 0.8520 - val-ap: 0.8230 (0.1s/epoch)
Epoch  106/1500:Epoch loss: 0.4527 - avg acc: 30.5% - val-roc: 0.8265 - val-ap: 0.8145 (0.1s/epoch)
Epoch  107/1500:Epoch loss: 0.4227 - avg acc: 30.5% - val-roc: 0.8520 - val-ap: 0.8559 (0.1s/epoch)
Epoch  108/1500:Epoch loss: 0.4678 - avg acc: 30.5% - val-roc: 0.8214 - val-ap: 0.8047 (0.1s/epoch)
Epoch  109/1500:Epoch loss: 0.4418 - avg acc: 30.5% - val-roc: 0.8061 - val-ap: 0.7942 (0.1s/epoch)
Epoch  110/1500:Epoch loss: 0.4374 - avg acc: 30.5% - val-roc: 0.8265 - val-ap: 0.8075 (0.1s/epoch)
Epoch  111/1500:Epoch loss: 0.4339 - avg acc: 30.5% - val-roc: 0.8163 - val-ap: 0.8422 (0.2s/epoch)
Epoch  112/1500:Epoch loss: 0.5018 - avg acc: 30.5% - val-roc: 0.8112 - val-ap: 0.8502 (0.1s/epoch)
Epoch  113/1500:Epoch loss: 0.4374 - avg acc: 30.5% - val-roc: 0.8520 - val-ap: 0.8718 (0.2s/epoch)
Epoch  114/1500:Epoch loss: 0.4279 - avg acc: 30.5% - val-roc: 0.8418 - val-ap: 0.8683 (0.1s/epoch)
Epoch  115/1500:Epoch loss: 0.4634 - avg acc: 30.5% - val-roc: 0.8265 - val-ap: 0.8594 (0.2s/epoch)
Epoch  116/1500:Epoch loss: 0.4348 - avg acc: 30.5% - val-roc: 0.8367 - val-ap: 0.8494 (0.2s/epoch)
Epoch  117/1500:Epoch loss: 0.4307 - avg acc: 30.5% - val-roc: 0.8163 - val-ap: 0.7713 (0.1s/epoch)
Epoch  118/1500:Epoch loss: 0.4386 - avg acc: 30.5% - val-roc: 0.8010 - val-ap: 0.7910 (0.1s/epoch)
Epoch  119/1500:Epoch loss: 0.4273 - avg acc: 30.5% - val-roc: 0.8163 - val-ap: 0.7675 (0.2s/epoch)
Epoch  120/1500:Epoch loss: 0.4205 - avg acc: 30.5% - val-roc: 0.8265 - val-ap: 0.7780 (0.1s/epoch)
Epoch  121/1500:Epoch loss: 0.4392 - avg acc: 30.5% - val-roc: 0.8265 - val-ap: 0.8367 (0.1s/epoch)
Epoch  122/1500:Epoch loss: 0.4344 - avg acc: 30.5% - val-roc: 0.8418 - val-ap: 0.8413 (0.1s/epoch)
Epoch  123/1500:Epoch loss: 0.4300 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8210 (0.2s/epoch)
Epoch  124/1500:Epoch loss: 0.4386 - avg acc: 30.5% - val-roc: 0.8520 - val-ap: 0.8427 (0.1s/epoch)
Epoch  125/1500:Epoch loss: 0.4339 - avg acc: 30.5% - val-roc: 0.8622 - val-ap: 0.8243 (0.1s/epoch)
Epoch  126/1500:Epoch loss: 0.4623 - avg acc: 30.5% - val-roc: 0.8776 - val-ap: 0.8336 (0.1s/epoch)
Epoch  127/1500:Epoch loss: 0.4341 - avg acc: 30.5% - val-roc: 0.8827 - val-ap: 0.8739 (0.2s/epoch)
Epoch  128/1500:Epoch loss: 0.4559 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8295 (0.1s/epoch)
Epoch  129/1500:Epoch loss: 0.4170 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8290 (0.1s/epoch)
Epoch  130/1500:Epoch loss: 0.4345 - avg acc: 30.5% - val-roc: 0.8878 - val-ap: 0.8406 (0.1s/epoch)
Epoch  131/1500:Epoch loss: 0.4259 - avg acc: 30.5% - val-roc: 0.8520 - val-ap: 0.8228 (0.2s/epoch)
Epoch  132/1500:Epoch loss: 0.4302 - avg acc: 30.5% - val-roc: 0.8776 - val-ap: 0.8882 (0.2s/epoch)
Epoch  133/1500:Epoch loss: 0.4167 - avg acc: 30.5% - val-roc: 0.8878 - val-ap: 0.8964 (0.2s/epoch)
Epoch  134/1500:Epoch loss: 0.4312 - avg acc: 30.5% - val-roc: 0.8827 - val-ap: 0.8792 (0.1s/epoch)
Epoch  135/1500:Epoch loss: 0.4285 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8361 (0.1s/epoch)
Epoch  136/1500:Epoch loss: 0.4177 - avg acc: 30.5% - val-roc: 0.8571 - val-ap: 0.8300 (0.1s/epoch)
Epoch  137/1500:Epoch loss: 0.4175 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8361 (0.1s/epoch)
Epoch  138/1500:Epoch loss: 0.4242 - avg acc: 30.5% - val-roc: 0.8776 - val-ap: 0.8419 (0.2s/epoch)
Epoch  139/1500:Epoch loss: 0.4171 - avg acc: 30.5% - val-roc: 0.8776 - val-ap: 0.8419 (0.1s/epoch)
Epoch  140/1500:Epoch loss: 0.4228 - avg acc: 30.5% - val-roc: 0.8418 - val-ap: 0.8206 (0.1s/epoch)
Epoch  141/1500:Epoch loss: 0.4372 - avg acc: 30.5% - val-roc: 0.8112 - val-ap: 0.8290 (0.1s/epoch)
Epoch  142/1500:Epoch loss: 0.4154 - avg acc: 30.5% - val-roc: 0.8265 - val-ap: 0.8143 (0.2s/epoch)
Epoch  143/1500:Epoch loss: 0.4491 - avg acc: 30.5% - val-roc: 0.8827 - val-ap: 0.8792 (0.1s/epoch)
Epoch  144/1500:Epoch loss: 0.4205 - avg acc: 30.5% - val-roc: 0.8827 - val-ap: 0.8435 (0.1s/epoch)
Epoch  145/1500:Epoch loss: 0.4423 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8515 (0.1s/epoch)
Epoch  146/1500:Epoch loss: 0.4263 - avg acc: 30.5% - val-roc: 0.8622 - val-ap: 0.8770 (0.1s/epoch)
Epoch  147/1500:Epoch loss: 0.4133 - avg acc: 30.5% - val-roc: 0.8724 - val-ap: 0.8923 (0.1s/epoch)
Epoch  148/1500:Epoch loss: 0.4423 - avg acc: 30.5% - val-roc: 0.8878 - val-ap: 0.9015 (0.1s/epoch)
Epoch  149/1500:Epoch loss: 0.4043 - avg acc: 30.5% - val-roc: 0.8622 - val-ap: 0.8348 (0.1s/epoch)
Epoch  150/1500:Epoch loss: 0.4327 - avg acc: 30.5% - val-roc: 0.8776 - val-ap: 0.8942 (0.1s/epoch)
Epoch  151/1500:Epoch loss: 0.4235 - avg acc: 30.5% - val-roc: 0.8622 - val-ap: 0.8314 (0.1s/epoch)
Epoch  152/1500:Epoch loss: 0.4359 - avg acc: 30.5% - val-roc: 0.8776 - val-ap: 0.9005 (0.1s/epoch)
Epoch  153/1500:Epoch loss: 0.4655 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8784 (0.2s/epoch)
Epoch  154/1500:Epoch loss: 0.4241 - avg acc: 30.5% - val-roc: 0.8673 - val-ap: 0.8784 (0.1s/epoch)
Epoch  155/1500:Epoch loss: 0.4400 - avg acc: 30.5% - val-roc: 0.8980 - val-ap: 0.9238 (0.1s/epoch)
Epoch  156/1500:Epoch loss: 0.4126 - avg acc: 30.5% - val-roc: 0.9133 - val-ap: 0.9434 (0.1s/epoch)
Epoch  157/1500:Epoch loss: 0.4197 - avg acc: 30.5% - val-roc: 0.8520 - val-ap: 0.8234 (0.1s/epoch)
Epoch  158/1500:Epoch loss: 0.4053 - avg acc: 30.5% - val-roc: 0.8724 - val-ap: 0.8893 (0.1s/epoch)
Epoch  159/1500:Epoch loss: 0.4162 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8851 (0.1s/epoch)
Epoch  160/1500:Epoch loss: 0.3967 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8665 (0.2s/epoch)
Epoch  161/1500:Epoch loss: 0.4153 - avg acc: 30.5% - val-roc: 0.8316 - val-ap: 0.8105 (0.2s/epoch)
Epoch  162/1500:Epoch loss: 0.4164 - avg acc: 30.5% - val-roc: 0.8827 - val-ap: 0.9010 (0.1s/epoch)
Epoch  163/1500:Epoch loss: 0.4205 - avg acc: 30.5% - val-roc: 0.8776 - val-ap: 0.9015 (0.1s/epoch)
Epoch  164/1500:Epoch loss: 0.4041 - avg acc: 30.5% - val-roc: 0.8878 - val-ap: 0.9118 (0.2s/epoch)
Epoch  165/1500:Epoch loss: 0.4235 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8879 (0.1s/epoch)
Epoch  166/1500:Epoch loss: 0.4131 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8719 (0.2s/epoch)
Epoch  167/1500:Epoch loss: 0.4012 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8719 (0.1s/epoch)
Epoch  168/1500:Epoch loss: 0.3758 - avg acc: 30.5% - val-roc: 0.8622 - val-ap: 0.8956 (0.2s/epoch)
Epoch  169/1500:Epoch loss: 0.4243 - avg acc: 30.5% - val-roc: 0.8724 - val-ap: 0.8907 (0.2s/epoch)
Epoch  170/1500:Epoch loss: 0.3990 - avg acc: 30.5% - val-roc: 0.9082 - val-ap: 0.9445 (0.2s/epoch)
Epoch  171/1500:Epoch loss: 0.3935 - avg acc: 30.5% - val-roc: 0.8878 - val-ap: 0.9162 (0.1s/epoch)
Epoch  172/1500:Epoch loss: 0.4460 - avg acc: 30.5% - val-roc: 0.8980 - val-ap: 0.9206 (0.1s/epoch)
Epoch  173/1500:Epoch loss: 0.4032 - avg acc: 30.5% - val-roc: 0.8980 - val-ap: 0.9355 (0.1s/epoch)
Epoch  174/1500:Epoch loss: 0.3906 - avg acc: 31.3% - val-roc: 0.9235 - val-ap: 0.9444 (0.1s/epoch)
Epoch  175/1500:Epoch loss: 0.4023 - avg acc: 31.3% - val-roc: 0.9184 - val-ap: 0.9450 (0.2s/epoch)
Epoch  176/1500:Epoch loss: 0.3902 - avg acc: 31.3% - val-roc: 0.9184 - val-ap: 0.9481 (0.2s/epoch)
Epoch  177/1500:Epoch loss: 0.3864 - avg acc: 31.3% - val-roc: 0.8929 - val-ap: 0.9337 (0.2s/epoch)
Epoch  178/1500:Epoch loss: 0.4094 - avg acc: 31.3% - val-roc: 0.9388 - val-ap: 0.9596 (0.1s/epoch)
Epoch  179/1500:Epoch loss: 0.3788 - avg acc: 31.3% - val-roc: 0.9439 - val-ap: 0.9615 (0.2s/epoch)
Epoch  180/1500:Epoch loss: 0.4040 - avg acc: 31.3% - val-roc: 0.9388 - val-ap: 0.9555 (0.1s/epoch)
Epoch  181/1500:Epoch loss: 0.3791 - avg acc: 31.3% - val-roc: 0.9490 - val-ap: 0.9634 (0.1s/epoch)
Epoch  182/1500:Epoch loss: 0.4120 - avg acc: 31.3% - val-roc: 0.8980 - val-ap: 0.9274 (0.2s/epoch)
Epoch  183/1500:Epoch loss: 0.3932 - avg acc: 31.3% - val-roc: 0.8929 - val-ap: 0.9299 (0.1s/epoch)
Epoch  184/1500:Epoch loss: 0.3846 - avg acc: 31.3% - val-roc: 0.9082 - val-ap: 0.9408 (0.1s/epoch)
Epoch  185/1500:Epoch loss: 0.3890 - avg acc: 31.3% - val-roc: 0.9235 - val-ap: 0.9504 (0.2s/epoch)
Epoch  186/1500:Epoch loss: 0.4251 - avg acc: 31.3% - val-roc: 0.9184 - val-ap: 0.9468 (0.1s/epoch)
Epoch  187/1500:Epoch loss: 0.4086 - avg acc: 31.3% - val-roc: 0.8929 - val-ap: 0.9337 (0.1s/epoch)
Epoch  188/1500:Epoch loss: 0.3737 - avg acc: 31.3% - val-roc: 0.8418 - val-ap: 0.8987 (0.2s/epoch)
Epoch  189/1500:Epoch loss: 0.4102 - avg acc: 31.3% - val-roc: 0.8776 - val-ap: 0.9168 (0.2s/epoch)
Epoch  190/1500:Epoch loss: 0.4111 - avg acc: 31.3% - val-roc: 0.8776 - val-ap: 0.9129 (0.1s/epoch)
Epoch  191/1500:Epoch loss: 0.3675 - avg acc: 31.3% - val-roc: 0.8929 - val-ap: 0.9240 (0.1s/epoch)
Epoch  192/1500:Epoch loss: 0.4189 - avg acc: 31.3% - val-roc: 0.8724 - val-ap: 0.9126 (0.2s/epoch)
Epoch  193/1500:Epoch loss: 0.3784 - avg acc: 31.3% - val-roc: 0.8776 - val-ap: 0.9133 (0.1s/epoch)
Epoch  194/1500:Epoch loss: 0.4060 - avg acc: 30.5% - val-roc: 0.8776 - val-ap: 0.9327 (0.2s/epoch)
Epoch  195/1500:Epoch loss: 0.3855 - avg acc: 30.5% - val-roc: 0.8469 - val-ap: 0.8980 (0.1s/epoch)
Epoch  196/1500:Epoch loss: 0.3649 - avg acc: 31.3% - val-roc: 0.9031 - val-ap: 0.9420 (0.1s/epoch)
Epoch  197/1500:Epoch loss: 0.3638 - avg acc: 31.3% - val-roc: 0.8980 - val-ap: 0.9330 (0.2s/epoch)
Epoch  198/1500:Epoch loss: 0.3698 - avg acc: 37.4% - val-roc: 0.8776 - val-ap: 0.9180 (0.1s/epoch)
Epoch  199/1500:Epoch loss: 0.3817 - avg acc: 37.4% - val-roc: 0.8980 - val-ap: 0.9188 (0.1s/epoch)
Epoch  200/1500:Epoch loss: 0.3812 - avg acc: 37.4% - val-roc: 0.8878 - val-ap: 0.9109 (0.1s/epoch)
Epoch  201/1500:Epoch loss: 0.3825 - avg acc: 37.4% - val-roc: 0.8929 - val-ap: 0.9067 (0.1s/epoch)
Epoch  202/1500:Epoch loss: 0.3982 - avg acc: 37.4% - val-roc: 0.9031 - val-ap: 0.9164 (0.1s/epoch)
Epoch  203/1500:Epoch loss: 0.4016 - avg acc: 37.4% - val-roc: 0.8776 - val-ap: 0.9058 (0.1s/epoch)
Epoch  204/1500:Epoch loss: 0.3763 - avg acc: 37.4% - val-roc: 0.8929 - val-ap: 0.9109 (0.1s/epoch)
Epoch  205/1500:Epoch loss: 0.3657 - avg acc: 37.4% - val-roc: 0.8418 - val-ap: 0.8818 (0.1s/epoch)
Epoch  206/1500:Epoch loss: 0.3893 - avg acc: 37.4% - val-roc: 0.8520 - val-ap: 0.8853 (0.1s/epoch)
Epoch  207/1500:Epoch loss: 0.3840 - avg acc: 37.4% - val-roc: 0.9031 - val-ap: 0.9277 (0.1s/epoch)
Epoch  208/1500:Epoch loss: 0.3692 - avg acc: 37.4% - val-roc: 0.8469 - val-ap: 0.8983 (0.1s/epoch)
Epoch  209/1500:Epoch loss: 0.3882 - avg acc: 37.4% - val-roc: 0.8724 - val-ap: 0.8952 (0.1s/epoch)
Epoch  210/1500:Epoch loss: 0.3615 - avg acc: 37.4% - val-roc: 0.8929 - val-ap: 0.9140 (0.1s/epoch)
Epoch  211/1500:Epoch loss: 0.3683 - avg acc: 36.6% - val-roc: 0.8776 - val-ap: 0.8971 (0.1s/epoch)
Epoch  212/1500:Epoch loss: 0.3875 - avg acc: 37.4% - val-roc: 0.8520 - val-ap: 0.8812 (0.1s/epoch)
Epoch  213/1500:Epoch loss: 0.3786 - avg acc: 37.4% - val-roc: 0.7959 - val-ap: 0.8683 (0.1s/epoch)
Epoch  214/1500:Epoch loss: 0.3618 - avg acc: 37.4% - val-roc: 0.7959 - val-ap: 0.8598 (0.1s/epoch)
Epoch  215/1500:Epoch loss: 0.3649 - avg acc: 37.4% - val-roc: 0.8622 - val-ap: 0.8963 (0.1s/epoch)
Epoch  216/1500:Epoch loss: 0.3884 - avg acc: 37.4% - val-roc: 0.8469 - val-ap: 0.8790 (0.2s/epoch)
Epoch  217/1500:Epoch loss: 0.3601 - avg acc: 37.4% - val-roc: 0.8469 - val-ap: 0.8802 (0.1s/epoch)
Epoch  218/1500:Epoch loss: 0.3508 - avg acc: 37.4% - val-roc: 0.8571 - val-ap: 0.8828 (0.2s/epoch)
Epoch  219/1500:Epoch loss: 0.3734 - avg acc: 36.6% - val-roc: 0.7959 - val-ap: 0.8541 (0.1s/epoch)
Epoch  220/1500:Epoch loss: 0.3700 - avg acc: 37.4% - val-roc: 0.8112 - val-ap: 0.8772 (0.1s/epoch)
Epoch  221/1500:Epoch loss: 0.3713 - avg acc: 37.4% - val-roc: 0.8622 - val-ap: 0.8970 (0.1s/epoch)
Epoch  222/1500:Epoch loss: 0.3801 - avg acc: 38.2% - val-roc: 0.8520 - val-ap: 0.8863 (0.2s/epoch)
Epoch  223/1500:Epoch loss: 0.4106 - avg acc: 39.7% - val-roc: 0.8112 - val-ap: 0.8616 (0.2s/epoch)
Epoch  224/1500:Epoch loss: 0.3368 - avg acc: 40.5% - val-roc: 0.8214 - val-ap: 0.8684 (0.2s/epoch)
Epoch  225/1500:Epoch loss: 0.3732 - avg acc: 40.5% - val-roc: 0.8367 - val-ap: 0.8755 (0.1s/epoch)
Epoch  226/1500:Epoch loss: 0.3444 - avg acc: 40.5% - val-roc: 0.8112 - val-ap: 0.8655 (0.2s/epoch)
Epoch  227/1500:Epoch loss: 0.4232 - avg acc: 40.5% - val-roc: 0.8418 - val-ap: 0.8774 (0.1s/epoch)
Epoch  228/1500:Epoch loss: 0.3559 - avg acc: 39.7% - val-roc: 0.8469 - val-ap: 0.8899 (0.1s/epoch)
Epoch  229/1500:Epoch loss: 0.3794 - avg acc: 37.4% - val-roc: 0.8776 - val-ap: 0.9061 (0.1s/epoch)
Epoch  230/1500:Epoch loss: 0.3647 - avg acc: 38.2% - val-roc: 0.8520 - val-ap: 0.8923 (0.1s/epoch)
Epoch  231/1500:Epoch loss: 0.3302 - avg acc: 39.7% - val-roc: 0.8316 - val-ap: 0.8852 (0.2s/epoch)
Epoch  232/1500:Epoch loss: 0.4051 - avg acc: 38.2% - val-roc: 0.8418 - val-ap: 0.8882 (0.2s/epoch)
Epoch  233/1500:Epoch loss: 0.3711 - avg acc: 37.4% - val-roc: 0.8367 - val-ap: 0.8805 (0.1s/epoch)
Epoch  234/1500:Epoch loss: 0.3675 - avg acc: 38.2% - val-roc: 0.8214 - val-ap: 0.8638 (0.1s/epoch)
Epoch  235/1500:Epoch loss: 0.3549 - avg acc: 38.2% - val-roc: 0.8418 - val-ap: 0.8774 (0.2s/epoch)
Epoch  236/1500:Epoch loss: 0.3229 - avg acc: 38.2% - val-roc: 0.8163 - val-ap: 0.8669 (0.1s/epoch)
Epoch  237/1500:Epoch loss: 0.3800 - avg acc: 38.2% - val-roc: 0.8061 - val-ap: 0.8488 (0.1s/epoch)
Epoch  238/1500:Epoch loss: 0.3767 - avg acc: 37.4% - val-roc: 0.8214 - val-ap: 0.8516 (0.1s/epoch)
Epoch  239/1500:Epoch loss: 0.3588 - avg acc: 39.7% - val-roc: 0.7959 - val-ap: 0.8432 (0.1s/epoch)
Epoch  240/1500:Epoch loss: 0.3425 - avg acc: 42.7% - val-roc: 0.8214 - val-ap: 0.8609 (0.1s/epoch)
Epoch  241/1500:Epoch loss: 0.3982 - avg acc: 37.4% - val-roc: 0.8673 - val-ap: 0.8813 (0.1s/epoch)
Epoch  242/1500:Epoch loss: 0.3616 - avg acc: 37.4% - val-roc: 0.8571 - val-ap: 0.8740 (0.1s/epoch)
Epoch  243/1500:Epoch loss: 0.3484 - avg acc: 37.4% - val-roc: 0.8673 - val-ap: 0.8843 (0.1s/epoch)
Epoch  244/1500:Epoch loss: 0.3419 - avg acc: 37.4% - val-roc: 0.8980 - val-ap: 0.9156 (0.2s/epoch)
Epoch  245/1500:Epoch loss: 0.3338 - avg acc: 37.4% - val-roc: 0.8571 - val-ap: 0.8891 (0.1s/epoch)
Epoch  246/1500:Epoch loss: 0.3860 - avg acc: 38.2% - val-roc: 0.8163 - val-ap: 0.8671 (0.2s/epoch)
Epoch  247/1500:Epoch loss: 0.3639 - avg acc: 38.9% - val-roc: 0.8878 - val-ap: 0.9093 (0.1s/epoch)
Epoch  248/1500:Epoch loss: 0.3546 - avg acc: 38.2% - val-roc: 0.8827 - val-ap: 0.9100 (0.1s/epoch)
Epoch  249/1500:Epoch loss: 0.3401 - avg acc: 45.8% - val-roc: 0.8622 - val-ap: 0.8868 (0.2s/epoch)
Epoch  250/1500:Epoch loss: 0.3932 - avg acc: 45.0% - val-roc: 0.8673 - val-ap: 0.8899 (0.1s/epoch)
Epoch  251/1500:Epoch loss: 0.4055 - avg acc: 44.3% - val-roc: 0.8827 - val-ap: 0.9157 (0.1s/epoch)
Epoch  252/1500:Epoch loss: 0.3575 - avg acc: 37.4% - val-roc: 0.8724 - val-ap: 0.9001 (0.1s/epoch)
Epoch  253/1500:Epoch loss: 0.3113 - avg acc: 37.4% - val-roc: 0.8622 - val-ap: 0.8951 (0.1s/epoch)
Epoch  254/1500:Epoch loss: 0.3652 - avg acc: 37.4% - val-roc: 0.8571 - val-ap: 0.8955 (0.1s/epoch)
Epoch  255/1500:Epoch loss: 0.3519 - avg acc: 37.4% - val-roc: 0.8163 - val-ap: 0.8778 (0.2s/epoch)
Epoch  256/1500:Epoch loss: 0.3609 - avg acc: 37.4% - val-roc: 0.8622 - val-ap: 0.8930 (0.2s/epoch)
Epoch  257/1500:Epoch loss: 0.3286 - avg acc: 37.4% - val-roc: 0.8469 - val-ap: 0.8769 (0.2s/epoch)
Epoch  258/1500:Epoch loss: 0.3716 - avg acc: 37.4% - val-roc: 0.8571 - val-ap: 0.8909 (0.2s/epoch)
Epoch  259/1500:Epoch loss: 0.3247 - avg acc: 37.4% - val-roc: 0.8010 - val-ap: 0.8576 (0.1s/epoch)
Epoch  260/1500:Epoch loss: 0.3368 - avg acc: 39.7% - val-roc: 0.8061 - val-ap: 0.8526 (0.1s/epoch)
Epoch  261/1500:Epoch loss: 0.3463 - avg acc: 56.5% - val-roc: 0.8418 - val-ap: 0.8746 (0.1s/epoch)
Epoch  262/1500:Epoch loss: 0.3553 - avg acc: 70.2% - val-roc: 0.8673 - val-ap: 0.8944 (0.1s/epoch)
Epoch  263/1500:Epoch loss: 0.3618 - avg acc: 62.6% - val-roc: 0.8673 - val-ap: 0.8944 (0.1s/epoch)
Epoch  264/1500:Epoch loss: 0.3917 - avg acc: 62.6% - val-roc: 0.8673 - val-ap: 0.8944 (0.1s/epoch)
Epoch  265/1500:Epoch loss: 0.4133 - avg acc: 41.2% - val-roc: 0.8673 - val-ap: 0.8944 (0.1s/epoch)
Epoch  266/1500:Epoch loss: 0.3407 - avg acc: 45.8% - val-roc: 0.8571 - val-ap: 0.8864 (0.1s/epoch)
Epoch  267/1500:Epoch loss: 0.3314 - avg acc: 40.5% - val-roc: 0.8316 - val-ap: 0.8690 (0.1s/epoch)
Epoch  268/1500:Epoch loss: 0.3970 - avg acc: 41.2% - val-roc: 0.8265 - val-ap: 0.8656 (0.1s/epoch)
Epoch  269/1500:Epoch loss: 0.3444 - avg acc: 38.2% - val-roc: 0.8316 - val-ap: 0.8675 (0.1s/epoch)
Epoch  270/1500:Epoch loss: 0.3498 - avg acc: 37.4% - val-roc: 0.7806 - val-ap: 0.8422 (0.1s/epoch)
Epoch  271/1500:Epoch loss: 0.3922 - avg acc: 37.4% - val-roc: 0.8316 - val-ap: 0.8643 (0.1s/epoch)
Epoch  272/1500:Epoch loss: 0.3764 - avg acc: 37.4% - val-roc: 0.8622 - val-ap: 0.8855 (0.1s/epoch)
Epoch  273/1500:Epoch loss: 0.3992 - avg acc: 37.4% - val-roc: 0.8469 - val-ap: 0.8712 (0.1s/epoch)
Epoch  274/1500:Epoch loss: 0.3537 - avg acc: 37.4% - val-roc: 0.7806 - val-ap: 0.8380 (0.1s/epoch)
Epoch  275/1500:Epoch loss: 0.3568 - avg acc: 37.4% - val-roc: 0.7908 - val-ap: 0.8496 (0.1s/epoch)
Epoch  276/1500:Epoch loss: 0.3424 - avg acc: 38.9% - val-roc: 0.7908 - val-ap: 0.8503 (0.2s/epoch)
Epoch  277/1500:Epoch loss: 0.3483 - avg acc: 38.2% - val-roc: 0.8469 - val-ap: 0.8706 (0.1s/epoch)
Epoch  278/1500:Epoch loss: 0.3210 - avg acc: 37.4% - val-roc: 0.8265 - val-ap: 0.8594 (0.1s/epoch)
Epoch  279/1500:Epoch loss: 0.3463 - avg acc: 37.4% - val-roc: 0.8571 - val-ap: 0.8785 (0.2s/epoch)
Epoch  280/1500:Epoch loss: 0.3287 - avg acc: 37.4% - val-roc: 0.8622 - val-ap: 0.8855 (0.1s/epoch)
Epoch  281/1500:Epoch loss: 0.3490 - avg acc: 37.4% - val-roc: 0.7908 - val-ap: 0.8496 (0.1s/epoch)
Epoch  282/1500:Epoch loss: 0.3692 - avg acc: 37.4% - val-roc: 0.8571 - val-ap: 0.8816 (0.1s/epoch)
Epoch  283/1500:Epoch loss: 0.3490 - avg acc: 36.6% - val-roc: 0.8214 - val-ap: 0.8682 (0.2s/epoch)
Epoch  284/1500:Epoch loss: 0.3303 - avg acc: 37.4% - val-roc: 0.8622 - val-ap: 0.8887 (0.1s/epoch)
Epoch  285/1500:Epoch loss: 0.3254 - avg acc: 40.5% - val-roc: 0.8265 - val-ap: 0.8600 (0.1s/epoch)
Epoch  286/1500:Epoch loss: 0.3548 - avg acc: 41.2% - val-roc: 0.8112 - val-ap: 0.8508 (0.2s/epoch)
Epoch  287/1500:Epoch loss: 0.3530 - avg acc: 39.7% - val-roc: 0.8418 - val-ap: 0.8711 (0.1s/epoch)
Epoch  288/1500:Epoch loss: 0.3260 - avg acc: 41.2% - val-roc: 0.8469 - val-ap: 0.8751 (0.1s/epoch)
Epoch  289/1500:Epoch loss: 0.3584 - avg acc: 41.2% - val-roc: 0.8520 - val-ap: 0.8782 (0.2s/epoch)
Epoch  290/1500:Epoch loss: 0.3274 - avg acc: 48.1% - val-roc: 0.8316 - val-ap: 0.8659 (0.2s/epoch)
Epoch  291/1500:Epoch loss: 0.3267 - avg acc: 45.0% - val-roc: 0.8163 - val-ap: 0.8581 (0.2s/epoch)
Epoch  292/1500:Epoch loss: 0.3819 - avg acc: 36.6% - val-roc: 0.7908 - val-ap: 0.8383 (0.2s/epoch)
Epoch  293/1500:Epoch loss: 0.3505 - avg acc: 36.6% - val-roc: 0.8469 - val-ap: 0.8751 (0.2s/epoch)
Epoch  294/1500:Epoch loss: 0.3974 - avg acc: 36.6% - val-roc: 0.8418 - val-ap: 0.8705 (0.2s/epoch)
Epoch  295/1500:Epoch loss: 0.3551 - avg acc: 36.6% - val-roc: 0.8418 - val-ap: 0.8672 (0.1s/epoch)
Epoch  296/1500:Epoch loss: 0.3190 - avg acc: 36.6% - val-roc: 0.8622 - val-ap: 0.8915 (0.1s/epoch)
Epoch  297/1500:Epoch loss: 0.4175 - avg acc: 36.6% - val-roc: 0.8520 - val-ap: 0.8897 (0.1s/epoch)
Epoch  298/1500:Epoch loss: 0.3283 - avg acc: 36.6% - val-roc: 0.8316 - val-ap: 0.8881 (0.1s/epoch)
Epoch  299/1500:Epoch loss: 0.3082 - avg acc: 36.6% - val-roc: 0.7296 - val-ap: 0.8245 (0.1s/epoch)
Epoch  300/1500:Epoch loss: 0.3147 - avg acc: 36.6% - val-roc: 0.7551 - val-ap: 0.8351 (0.1s/epoch)
Epoch  301/1500:Epoch loss: 0.3341 - avg acc: 38.2% - val-roc: 0.8112 - val-ap: 0.8682 (0.1s/epoch)
Epoch  302/1500:Epoch loss: 0.3310 - avg acc: 38.2% - val-roc: 0.8571 - val-ap: 0.8785 (0.2s/epoch)
Epoch  303/1500:Epoch loss: 0.3054 - avg acc: 38.2% - val-roc: 0.8316 - val-ap: 0.8605 (0.1s/epoch)
Epoch  304/1500:Epoch loss: 0.3351 - avg acc: 38.9% - val-roc: 0.8061 - val-ap: 0.8566 (0.2s/epoch)
Epoch  305/1500:Epoch loss: 0.3445 - avg acc: 36.6% - val-roc: 0.7194 - val-ap: 0.8176 (0.1s/epoch)
Epoch  306/1500:Epoch loss: 0.3319 - avg acc: 36.6% - val-roc: 0.8010 - val-ap: 0.8576 (0.2s/epoch)
Epoch  307/1500:Epoch loss: 0.3244 - avg acc: 38.9% - val-roc: 0.7347 - val-ap: 0.8271 (0.1s/epoch)
Epoch  308/1500:Epoch loss: 0.3298 - avg acc: 42.0% - val-roc: 0.8367 - val-ap: 0.8875 (0.1s/epoch)
Epoch  309/1500:Epoch loss: 0.3034 - avg acc: 38.9% - val-roc: 0.8010 - val-ap: 0.8552 (0.1s/epoch)
Epoch  310/1500:Epoch loss: 0.3350 - avg acc: 38.9% - val-roc: 0.8061 - val-ap: 0.8546 (0.2s/epoch)
Epoch  311/1500:Epoch loss: 0.3299 - avg acc: 37.4% - val-roc: 0.7959 - val-ap: 0.8510 (0.1s/epoch)
Epoch  312/1500:Epoch loss: 0.3416 - avg acc: 37.4% - val-roc: 0.7755 - val-ap: 0.8528 (0.1s/epoch)
Epoch  313/1500:Epoch loss: 0.3206 - avg acc: 36.6% - val-roc: 0.7500 - val-ap: 0.8420 (0.1s/epoch)
Epoch  314/1500:Epoch loss: 0.3569 - avg acc: 37.4% - val-roc: 0.7755 - val-ap: 0.8543 (0.1s/epoch)
Epoch  315/1500:Epoch loss: 0.3231 - avg acc: 41.2% - val-roc: 0.8265 - val-ap: 0.8773 (0.1s/epoch)
Epoch  316/1500:Epoch loss: 0.3079 - avg acc: 51.1% - val-roc: 0.8214 - val-ap: 0.8561 (0.1s/epoch)
Epoch  317/1500:Epoch loss: 0.3190 - avg acc: 52.7% - val-roc: 0.8163 - val-ap: 0.8513 (0.1s/epoch)
Epoch  318/1500:Epoch loss: 0.3216 - avg acc: 41.2% - val-roc: 0.7602 - val-ap: 0.8332 (0.1s/epoch)
Epoch  319/1500:Epoch loss: 0.3244 - avg acc: 37.4% - val-roc: 0.7653 - val-ap: 0.8393 (0.1s/epoch)
Epoch  320/1500:Epoch loss: 0.3319 - avg acc: 37.4% - val-roc: 0.8061 - val-ap: 0.8583 (0.2s/epoch)
Epoch  321/1500:Epoch loss: 0.3207 - avg acc: 37.4% - val-roc: 0.8316 - val-ap: 0.8706 (0.1s/epoch)
Epoch  322/1500:Epoch loss: 0.3455 - avg acc: 37.4% - val-roc: 0.7755 - val-ap: 0.8391 (0.1s/epoch)
Epoch  323/1500:Epoch loss: 0.3232 - avg acc: 38.2% - val-roc: 0.7602 - val-ap: 0.8290 (0.2s/epoch)
Epoch  324/1500:Epoch loss: 0.3066 - avg acc: 38.2% - val-roc: 0.8010 - val-ap: 0.8514 (0.1s/epoch)
Epoch  325/1500:Epoch loss: 0.3370 - avg acc: 38.9% - val-roc: 0.8010 - val-ap: 0.8552 (0.2s/epoch)
Epoch  326/1500:Epoch loss: 0.3448 - avg acc: 45.8% - val-roc: 0.8265 - val-ap: 0.8663 (0.1s/epoch)
Epoch  327/1500:Epoch loss: 0.3300 - avg acc: 45.8% - val-roc: 0.8163 - val-ap: 0.8606 (0.1s/epoch)
Epoch  328/1500:Epoch loss: 0.3115 - avg acc: 44.3% - val-roc: 0.8469 - val-ap: 0.8755 (0.1s/epoch)
Epoch  329/1500:Epoch loss: 0.3342 - avg acc: 46.6% - val-roc: 0.8520 - val-ap: 0.8776 (0.1s/epoch)
Epoch  330/1500:Epoch loss: 0.3204 - avg acc: 41.2% - val-roc: 0.8367 - val-ap: 0.8662 (0.1s/epoch)
Epoch  331/1500:Epoch loss: 0.3283 - avg acc: 45.0% - val-roc: 0.8418 - val-ap: 0.8733 (0.1s/epoch)
Epoch  332/1500:Epoch loss: 0.3274 - avg acc: 38.9% - val-roc: 0.7959 - val-ap: 0.8486 (0.1s/epoch)
Epoch  333/1500:Epoch loss: 0.3296 - avg acc: 51.1% - val-roc: 0.8367 - val-ap: 0.8696 (0.1s/epoch)
Epoch  334/1500:Epoch loss: 0.3590 - avg acc: 51.1% - val-roc: 0.8112 - val-ap: 0.8591 (0.2s/epoch)
Epoch  335/1500:Epoch loss: 0.3205 - avg acc: 45.8% - val-roc: 0.8112 - val-ap: 0.8591 (0.1s/epoch)
Epoch  336/1500:Epoch loss: 0.3219 - avg acc: 45.0% - val-roc: 0.8163 - val-ap: 0.8590 (0.1s/epoch)
Epoch  337/1500:Epoch loss: 0.3210 - avg acc: 44.3% - val-roc: 0.8316 - val-ap: 0.8674 (0.1s/epoch)
Epoch  338/1500:Epoch loss: 0.3309 - avg acc: 43.5% - val-roc: 0.8265 - val-ap: 0.8726 (0.1s/epoch)
Epoch  339/1500:Epoch loss: 0.3076 - avg acc: 44.3% - val-roc: 0.8265 - val-ap: 0.8663 (0.1s/epoch)
Epoch  340/1500:Epoch loss: 0.3319 - avg acc: 45.0% - val-roc: 0.8163 - val-ap: 0.8592 (0.1s/epoch)
Epoch  341/1500:Epoch loss: 0.3615 - avg acc: 45.0% - val-roc: 0.7296 - val-ap: 0.8206 (0.1s/epoch)
Epoch  342/1500:Epoch loss: 0.3172 - avg acc: 45.8% - val-roc: 0.7857 - val-ap: 0.8427 (0.1s/epoch)
Epoch  343/1500:Epoch loss: 0.3221 - avg acc: 35.9% - val-roc: 0.7908 - val-ap: 0.8429 (0.1s/epoch)
Epoch  344/1500:Epoch loss: 0.3411 - avg acc: 30.5% - val-roc: 0.8112 - val-ap: 0.8588 (0.1s/epoch)
Epoch  345/1500:Epoch loss: 0.3243 - avg acc: 36.6% - val-roc: 0.8112 - val-ap: 0.8604 (0.1s/epoch)
Epoch  346/1500:Epoch loss: 0.4269 - avg acc: 43.5% - val-roc: 0.7602 - val-ap: 0.8406 (0.1s/epoch)
Epoch  347/1500:Epoch loss: 0.3221 - avg acc: 48.9% - val-roc: 0.7704 - val-ap: 0.8455 (0.1s/epoch)
Epoch  348/1500:Epoch loss: 0.3271 - avg acc: 44.3% - val-roc: 0.8673 - val-ap: 0.8960 (0.1s/epoch)
Epoch  349/1500:Epoch loss: 0.3031 - avg acc: 50.4% - val-roc: 0.8673 - val-ap: 0.8987 (0.1s/epoch)
Epoch  350/1500:Epoch loss: 0.3005 - avg acc: 51.9% - val-roc: 0.8469 - val-ap: 0.8765 (0.1s/epoch)
Epoch  351/1500:Epoch loss: 0.3088 - avg acc: 51.9% - val-roc: 0.8469 - val-ap: 0.8815 (0.1s/epoch)
Epoch  352/1500:Epoch loss: 0.3220 - avg acc: 52.7% - val-roc: 0.8163 - val-ap: 0.8631 (0.1s/epoch)
Epoch  353/1500:Epoch loss: 0.3362 - avg acc: 45.0% - val-roc: 0.7551 - val-ap: 0.8323 (0.1s/epoch)
Epoch  354/1500:Epoch loss: 0.3095 - avg acc: 49.6% - val-roc: 0.7704 - val-ap: 0.8395 (0.1s/epoch)
Epoch  355/1500:Epoch loss: 0.3405 - avg acc: 44.3% - val-roc: 0.8418 - val-ap: 0.8809 (0.1s/epoch)
Epoch  356/1500:Epoch loss: 0.3305 - avg acc: 43.5% - val-roc: 0.8469 - val-ap: 0.8821 (0.1s/epoch)
Epoch  357/1500:Epoch loss: 0.3167 - avg acc: 45.0% - val-roc: 0.7398 - val-ap: 0.8211 (0.1s/epoch)
Epoch  358/1500:Epoch loss: 0.3505 - avg acc: 45.0% - val-roc: 0.7653 - val-ap: 0.8407 (0.1s/epoch)
Epoch  359/1500:Epoch loss: 0.2921 - avg acc: 45.8% - val-roc: 0.8418 - val-ap: 0.8699 (0.1s/epoch)
Epoch  360/1500:Epoch loss: 0.3008 - avg acc: 47.3% - val-roc: 0.8214 - val-ap: 0.8593 (0.1s/epoch)
Epoch  361/1500:Epoch loss: 0.3055 - avg acc: 46.6% - val-roc: 0.8265 - val-ap: 0.8582 (0.1s/epoch)
Epoch  362/1500:Epoch loss: 0.3124 - avg acc: 45.8% - val-roc: 0.7857 - val-ap: 0.8441 (0.1s/epoch)
Epoch  363/1500:Epoch loss: 0.2982 - avg acc: 60.3% - val-roc: 0.8010 - val-ap: 0.8556 (0.2s/epoch)
Epoch  364/1500:Epoch loss: 0.3251 - avg acc: 40.5% - val-roc: 0.8010 - val-ap: 0.8606 (0.1s/epoch)
Epoch  365/1500:Epoch loss: 0.3377 - avg acc: 55.7% - val-roc: 0.8776 - val-ap: 0.8892 (0.1s/epoch)
Epoch  366/1500:Epoch loss: 0.3470 - avg acc: 56.5% - val-roc: 0.8724 - val-ap: 0.8887 (0.1s/epoch)
Epoch  367/1500:Epoch loss: 0.3636 - avg acc: 55.7% - val-roc: 0.8571 - val-ap: 0.8757 (0.1s/epoch)
Epoch  368/1500:Epoch loss: 0.3077 - avg acc: 49.6% - val-roc: 0.8673 - val-ap: 0.8850 (0.1s/epoch)
Epoch  369/1500:Epoch loss: 0.3090 - avg acc: 46.6% - val-roc: 0.8265 - val-ap: 0.8610 (0.1s/epoch)
Epoch  370/1500:Epoch loss: 0.3493 - avg acc: 39.7% - val-roc: 0.8061 - val-ap: 0.8571 (0.1s/epoch)
Epoch  371/1500:Epoch loss: 0.3672 - avg acc: 45.0% - val-roc: 0.7959 - val-ap: 0.8480 (0.1s/epoch)
Epoch  372/1500:Epoch loss: 0.2950 - avg acc: 54.2% - val-roc: 0.8214 - val-ap: 0.8647 (0.1s/epoch)
Epoch  373/1500:Epoch loss: 0.3209 - avg acc: 53.4% - val-roc: 0.8724 - val-ap: 0.8891 (0.1s/epoch)
Epoch  374/1500:Epoch loss: 0.3144 - avg acc: 50.4% - val-roc: 0.8265 - val-ap: 0.8658 (0.1s/epoch)
Epoch  375/1500:Epoch loss: 0.3101 - avg acc: 52.7% - val-roc: 0.8265 - val-ap: 0.8656 (0.2s/epoch)
Epoch  376/1500:Epoch loss: 0.3070 - avg acc: 51.9% - val-roc: 0.8367 - val-ap: 0.8688 (0.1s/epoch)
Epoch  377/1500:Epoch loss: 0.3395 - avg acc: 37.4% - val-roc: 0.8827 - val-ap: 0.9100 (0.1s/epoch)
Epoch  378/1500:Epoch loss: 0.3552 - avg acc: 45.0% - val-roc: 0.8673 - val-ap: 0.8873 (0.2s/epoch)
Epoch  379/1500:Epoch loss: 0.3167 - avg acc: 45.8% - val-roc: 0.8010 - val-ap: 0.8530 (0.1s/epoch)
Epoch  380/1500:Epoch loss: 0.3157 - avg acc: 45.0% - val-roc: 0.7908 - val-ap: 0.8466 (0.2s/epoch)
Epoch  381/1500:Epoch loss: 0.3142 - avg acc: 45.0% - val-roc: 0.8061 - val-ap: 0.8583 (0.1s/epoch)
Epoch  382/1500:Epoch loss: 0.3025 - avg acc: 54.2% - val-roc: 0.8010 - val-ap: 0.8540 (0.1s/epoch)
Epoch  383/1500:Epoch loss: 0.3165 - avg acc: 51.1% - val-roc: 0.8010 - val-ap: 0.8543 (0.1s/epoch)
Epoch  384/1500:Epoch loss: 0.3179 - avg acc: 53.4% - val-roc: 0.8571 - val-ap: 0.8775 (0.1s/epoch)
Epoch  385/1500:Epoch loss: 0.2954 - avg acc: 57.3% - val-roc: 0.7959 - val-ap: 0.8477 (0.1s/epoch)
Epoch  386/1500:Epoch loss: 0.2806 - avg acc: 56.5% - val-roc: 0.8418 - val-ap: 0.8678 (0.1s/epoch)
Epoch  387/1500:Epoch loss: 0.2958 - avg acc: 46.6% - val-roc: 0.8878 - val-ap: 0.8956 (0.1s/epoch)
Epoch  388/1500:Epoch loss: 0.3110 - avg acc: 48.1% - val-roc: 0.8878 - val-ap: 0.9014 (0.1s/epoch)
Epoch  389/1500:Epoch loss: 0.2963 - avg acc: 46.6% - val-roc: 0.8469 - val-ap: 0.8755 (0.1s/epoch)
Epoch  390/1500:Epoch loss: 0.3034 - avg acc: 43.5% - val-roc: 0.7602 - val-ap: 0.8391 (0.1s/epoch)
Epoch  391/1500:Epoch loss: 0.3215 - avg acc: 45.0% - val-roc: 0.7755 - val-ap: 0.8365 (0.2s/epoch)
Epoch  392/1500:Epoch loss: 0.3319 - avg acc: 45.0% - val-roc: 0.8418 - val-ap: 0.8752 (0.2s/epoch)
Epoch  393/1500:Epoch loss: 0.2927 - avg acc: 44.3% - val-roc: 0.8571 - val-ap: 0.8909 (0.1s/epoch)
Epoch  394/1500:Epoch loss: 0.3251 - avg acc: 51.9% - val-roc: 0.8571 - val-ap: 0.8825 (0.1s/epoch)
Epoch  395/1500:Epoch loss: 0.3113 - avg acc: 49.6% - val-roc: 0.8061 - val-ap: 0.8567 (0.1s/epoch)
Epoch  396/1500:Epoch loss: 0.3076 - avg acc: 51.9% - val-roc: 0.7857 - val-ap: 0.8506 (0.1s/epoch)
Epoch  397/1500:Epoch loss: 0.2929 - avg acc: 51.1% - val-roc: 0.7755 - val-ap: 0.8474 (0.1s/epoch)
Epoch  398/1500:Epoch loss: 0.3011 - avg acc: 52.7% - val-roc: 0.7959 - val-ap: 0.8541 (0.1s/epoch)
Epoch  399/1500:Epoch loss: 0.3249 - avg acc: 55.7% - val-roc: 0.7755 - val-ap: 0.8452 (0.1s/epoch)
Epoch  400/1500:Epoch loss: 0.2994 - avg acc: 48.9% - val-roc: 0.8061 - val-ap: 0.8491 (0.1s/epoch)
Epoch  401/1500:Epoch loss: 0.2876 - avg acc: 38.2% - val-roc: 0.7449 - val-ap: 0.8239 (0.1s/epoch)
Epoch  402/1500:Epoch loss: 0.3248 - avg acc: 37.4% - val-roc: 0.8061 - val-ap: 0.8492 (0.1s/epoch)
Epoch  403/1500:Epoch loss: 0.3028 - avg acc: 38.2% - val-roc: 0.7602 - val-ap: 0.8489 (0.2s/epoch)
Epoch  404/1500:Epoch loss: 0.3241 - avg acc: 52.7% - val-roc: 0.7551 - val-ap: 0.8367 (0.1s/epoch)
Epoch  405/1500:Epoch loss: 0.2970 - avg acc: 45.0% - val-roc: 0.7704 - val-ap: 0.8429 (0.2s/epoch)
Epoch  406/1500:Epoch loss: 0.3299 - avg acc: 32.8% - val-roc: 0.7704 - val-ap: 0.8501 (0.2s/epoch)
Epoch  407/1500:Epoch loss: 0.2954 - avg acc: 37.4% - val-roc: 0.7755 - val-ap: 0.8564 (0.1s/epoch)
Epoch  408/1500:Epoch loss: 0.3264 - avg acc: 38.9% - val-roc: 0.7704 - val-ap: 0.8577 (0.1s/epoch)
Epoch  409/1500:Epoch loss: 0.2903 - avg acc: 45.0% - val-roc: 0.8214 - val-ap: 0.8872 (0.1s/epoch)
Epoch  410/1500:Epoch loss: 0.4472 - avg acc: 54.2% - val-roc: 0.8010 - val-ap: 0.8709 (0.1s/epoch)
Epoch  411/1500:Epoch loss: 0.2959 - avg acc: 49.6% - val-roc: 0.8265 - val-ap: 0.9023 (0.1s/epoch)
Epoch  412/1500:Epoch loss: 0.3014 - avg acc: 48.9% - val-roc: 0.7857 - val-ap: 0.8723 (0.1s/epoch)
Epoch  413/1500:Epoch loss: 0.3075 - avg acc: 49.6% - val-roc: 0.8061 - val-ap: 0.8832 (0.1s/epoch)
Epoch  414/1500:Epoch loss: 0.2936 - avg acc: 49.6% - val-roc: 0.7959 - val-ap: 0.8730 (0.1s/epoch)
Epoch  415/1500:Epoch loss: 0.2874 - avg acc: 48.9% - val-roc: 0.7806 - val-ap: 0.8777 (0.1s/epoch)
Epoch  416/1500:Epoch loss: 0.2978 - avg acc: 49.6% - val-roc: 0.7857 - val-ap: 0.8791 (0.2s/epoch)
Epoch  417/1500:Epoch loss: 0.2886 - avg acc: 55.0% - val-roc: 0.7959 - val-ap: 0.8834 (0.1s/epoch)
Epoch  418/1500:Epoch loss: 0.2810 - avg acc: 55.0% - val-roc: 0.7908 - val-ap: 0.8715 (0.1s/epoch)
Epoch  419/1500:Epoch loss: 0.3073 - avg acc: 59.5% - val-roc: 0.8316 - val-ap: 0.8753 (0.1s/epoch)
Epoch  420/1500:Epoch loss: 0.3818 - avg acc: 59.5% - val-roc: 0.7959 - val-ap: 0.8762 (0.1s/epoch)
Epoch  421/1500:Epoch loss: 0.2909 - avg acc: 55.0% - val-roc: 0.8724 - val-ap: 0.9132 (0.2s/epoch)
Epoch  422/1500:Epoch loss: 0.3265 - avg acc: 55.7% - val-roc: 0.9082 - val-ap: 0.9303 (0.1s/epoch)
Epoch  423/1500:Epoch loss: 0.2851 - avg acc: 55.7% - val-roc: 0.9031 - val-ap: 0.9288 (0.1s/epoch)
Epoch  424/1500:Epoch loss: 0.2881 - avg acc: 49.6% - val-roc: 0.7755 - val-ap: 0.8637 (0.1s/epoch)
Epoch  425/1500:Epoch loss: 0.2935 - avg acc: 49.6% - val-roc: 0.8214 - val-ap: 0.8851 (0.1s/epoch)
Epoch  426/1500:Epoch loss: 0.2900 - avg acc: 57.3% - val-roc: 0.8776 - val-ap: 0.9090 (0.1s/epoch)
Epoch  427/1500:Epoch loss: 0.2808 - avg acc: 55.7% - val-roc: 0.7857 - val-ap: 0.8634 (0.2s/epoch)
Epoch  428/1500:Epoch loss: 0.2810 - avg acc: 58.8% - val-roc: 0.7755 - val-ap: 0.8591 (0.1s/epoch)
Epoch  429/1500:Epoch loss: 0.2827 - avg acc: 58.8% - val-roc: 0.8061 - val-ap: 0.8804 (0.1s/epoch)
Epoch  430/1500:Epoch loss: 0.3243 - avg acc: 62.6% - val-roc: 0.8418 - val-ap: 0.8884 (0.1s/epoch)
Epoch  431/1500:Epoch loss: 0.3027 - avg acc: 48.9% - val-roc: 0.8520 - val-ap: 0.8942 (0.1s/epoch)
Epoch  432/1500:Epoch loss: 0.2833 - avg acc: 48.1% - val-roc: 0.8061 - val-ap: 0.8752 (0.1s/epoch)
Epoch  433/1500:Epoch loss: 0.2979 - avg acc: 55.0% - val-roc: 0.8163 - val-ap: 0.8854 (0.2s/epoch)
Epoch  434/1500:Epoch loss: 0.2782 - avg acc: 54.2% - val-roc: 0.7857 - val-ap: 0.8735 (0.1s/epoch)
Epoch  435/1500:Epoch loss: 0.3071 - avg acc: 48.9% - val-roc: 0.7806 - val-ap: 0.8699 (0.1s/epoch)
Epoch  436/1500:Epoch loss: 0.2805 - avg acc: 54.2% - val-roc: 0.8061 - val-ap: 0.8748 (0.1s/epoch)
Epoch  437/1500:Epoch loss: 0.3055 - avg acc: 55.0% - val-roc: 0.8571 - val-ap: 0.9044 (0.1s/epoch)
Epoch  438/1500:Epoch loss: 0.2976 - avg acc: 48.9% - val-roc: 0.8214 - val-ap: 0.8813 (0.1s/epoch)
Epoch  439/1500:Epoch loss: 0.2765 - avg acc: 51.1% - val-roc: 0.7398 - val-ap: 0.8506 (0.1s/epoch)
Epoch  440/1500:Epoch loss: 0.2990 - avg acc: 57.3% - val-roc: 0.8112 - val-ap: 0.8780 (0.2s/epoch)
Epoch  441/1500:Epoch loss: 0.2967 - avg acc: 58.8% - val-roc: 0.7653 - val-ap: 0.8487 (0.1s/epoch)
Epoch  442/1500:Epoch loss: 0.3692 - avg acc: 64.9% - val-roc: 0.8469 - val-ap: 0.8866 (0.1s/epoch)
Epoch  443/1500:Epoch loss: 0.2921 - avg acc: 64.9% - val-roc: 0.8163 - val-ap: 0.8829 (0.1s/epoch)
Epoch  444/1500:Epoch loss: 0.2757 - avg acc: 64.1% - val-roc: 0.8163 - val-ap: 0.8816 (0.2s/epoch)
Epoch  445/1500:Epoch loss: 0.2867 - avg acc: 59.5% - val-roc: 0.8316 - val-ap: 0.8892 (0.1s/epoch)
Epoch  446/1500:Epoch loss: 0.2758 - avg acc: 56.5% - val-roc: 0.8316 - val-ap: 0.8895 (0.1s/epoch)
Epoch  447/1500:Epoch loss: 0.2897 - avg acc: 48.1% - val-roc: 0.8622 - val-ap: 0.8989 (0.1s/epoch)
Epoch  448/1500:Epoch loss: 0.2928 - avg acc: 51.9% - val-roc: 0.8673 - val-ap: 0.9068 (0.1s/epoch)
Epoch  449/1500:Epoch loss: 0.3025 - avg acc: 54.2% - val-roc: 0.8265 - val-ap: 0.8919 (0.1s/epoch)
Epoch  450/1500:Epoch loss: 0.3113 - avg acc: 48.1% - val-roc: 0.8367 - val-ap: 0.8963 (0.1s/epoch)
Epoch  451/1500:Epoch loss: 0.2846 - avg acc: 50.4% - val-roc: 0.7653 - val-ap: 0.8568 (0.1s/epoch)
Epoch  452/1500:Epoch loss: 0.2866 - avg acc: 52.7% - val-roc: 0.6786 - val-ap: 0.8099 (0.1s/epoch)
Epoch  453/1500:Epoch loss: 0.2826 - avg acc: 52.7% - val-roc: 0.8214 - val-ap: 0.8938 (0.1s/epoch)
Epoch  454/1500:Epoch loss: 0.2875 - avg acc: 47.3% - val-roc: 0.8316 - val-ap: 0.8907 (0.1s/epoch)
Epoch  455/1500:Epoch loss: 0.2772 - avg acc: 51.9% - val-roc: 0.8418 - val-ap: 0.8880 (0.1s/epoch)
Epoch  456/1500:Epoch loss: 0.3006 - avg acc: 41.2% - val-roc: 0.8878 - val-ap: 0.9241 (0.1s/epoch)
Epoch  457/1500:Epoch loss: 0.2813 - avg acc: 46.6% - val-roc: 0.8622 - val-ap: 0.9059 (0.1s/epoch)
Epoch  458/1500:Epoch loss: 0.2765 - avg acc: 46.6% - val-roc: 0.8010 - val-ap: 0.8626 (0.1s/epoch)
Epoch  459/1500:Epoch loss: 0.2921 - avg acc: 46.6% - val-roc: 0.8112 - val-ap: 0.8719 (0.1s/epoch)
Epoch  460/1500:Epoch loss: 0.2777 - avg acc: 47.3% - val-roc: 0.8673 - val-ap: 0.9073 (0.3s/epoch)
Epoch  461/1500:Epoch loss: 0.2968 - avg acc: 52.7% - val-roc: 0.8622 - val-ap: 0.8988 (0.1s/epoch)
Epoch  462/1500:Epoch loss: 0.2999 - avg acc: 58.8% - val-roc: 0.8316 - val-ap: 0.8823 (0.1s/epoch)
Epoch  463/1500:Epoch loss: 0.2720 - avg acc: 58.8% - val-roc: 0.8214 - val-ap: 0.8647 (0.1s/epoch)
Epoch  464/1500:Epoch loss: 0.2836 - avg acc: 58.8% - val-roc: 0.7398 - val-ap: 0.8302 (0.2s/epoch)
Epoch  465/1500:Epoch loss: 0.2923 - avg acc: 60.3% - val-roc: 0.7551 - val-ap: 0.8475 (0.1s/epoch)
Epoch  466/1500:Epoch loss: 0.2788 - avg acc: 58.0% - val-roc: 0.7347 - val-ap: 0.8331 (0.1s/epoch)
Epoch  467/1500:Epoch loss: 0.2853 - avg acc: 57.3% - val-roc: 0.8010 - val-ap: 0.8702 (0.2s/epoch)
Epoch  468/1500:Epoch loss: 0.2897 - avg acc: 56.5% - val-roc: 0.9031 - val-ap: 0.9253 (0.1s/epoch)
Epoch  469/1500:Epoch loss: 0.3281 - avg acc: 64.9% - val-roc: 0.8776 - val-ap: 0.9155 (0.1s/epoch)
Epoch  470/1500:Epoch loss: 0.2713 - avg acc: 55.7% - val-roc: 0.8776 - val-ap: 0.9155 (0.1s/epoch)
Epoch  471/1500:Epoch loss: 0.2705 - avg acc: 57.3% - val-roc: 0.8724 - val-ap: 0.9142 (0.1s/epoch)
Epoch  472/1500:Epoch loss: 0.2865 - avg acc: 59.5% - val-roc: 0.8265 - val-ap: 0.8894 (0.1s/epoch)
Epoch  473/1500:Epoch loss: 0.2729 - avg acc: 56.5% - val-roc: 0.8316 - val-ap: 0.8792 (0.1s/epoch)
Epoch  474/1500:Epoch loss: 0.2717 - avg acc: 59.5% - val-roc: 0.8571 - val-ap: 0.9011 (0.1s/epoch)
Epoch  475/1500:Epoch loss: 0.2849 - avg acc: 60.3% - val-roc: 0.8367 - val-ap: 0.8795 (0.1s/epoch)
Epoch  476/1500:Epoch loss: 0.2832 - avg acc: 58.0% - val-roc: 0.7500 - val-ap: 0.8528 (0.1s/epoch)
Epoch  477/1500:Epoch loss: 0.2855 - avg acc: 57.3% - val-roc: 0.8673 - val-ap: 0.9070 (0.1s/epoch)
Epoch  478/1500:Epoch loss: 0.2707 - avg acc: 67.2% - val-roc: 0.8776 - val-ap: 0.9166 (0.1s/epoch)
Epoch  479/1500:Epoch loss: 0.2911 - avg acc: 70.2% - val-roc: 0.9082 - val-ap: 0.9206 (0.1s/epoch)
Epoch  480/1500:Epoch loss: 0.2677 - avg acc: 67.9% - val-roc: 0.9133 - val-ap: 0.9230 (0.1s/epoch)
Epoch  481/1500:Epoch loss: 0.2621 - avg acc: 57.3% - val-roc: 0.9031 - val-ap: 0.9198 (0.1s/epoch)
Epoch  482/1500:Epoch loss: 0.2615 - avg acc: 61.8% - val-roc: 0.8724 - val-ap: 0.9108 (0.1s/epoch)
Epoch  483/1500:Epoch loss: 0.2816 - avg acc: 62.6% - val-roc: 0.8776 - val-ap: 0.9133 (0.1s/epoch)
Epoch  484/1500:Epoch loss: 0.2678 - avg acc: 67.2% - val-roc: 0.8776 - val-ap: 0.9155 (0.1s/epoch)
Epoch  485/1500:Epoch loss: 0.2679 - avg acc: 62.6% - val-roc: 0.8929 - val-ap: 0.9202 (0.1s/epoch)
Epoch  486/1500:Epoch loss: 0.2830 - avg acc: 62.6% - val-roc: 0.8265 - val-ap: 0.8881 (0.1s/epoch)
Epoch  487/1500:Epoch loss: 0.2756 - avg acc: 63.4% - val-roc: 0.8724 - val-ap: 0.9142 (0.1s/epoch)
Epoch  488/1500:Epoch loss: 0.2635 - avg acc: 63.4% - val-roc: 0.8776 - val-ap: 0.9166 (0.1s/epoch)
Epoch  489/1500:Epoch loss: 0.2941 - avg acc: 67.9% - val-roc: 0.8571 - val-ap: 0.8986 (0.1s/epoch)
Epoch  490/1500:Epoch loss: 0.3057 - avg acc: 71.0% - val-roc: 0.7551 - val-ap: 0.8460 (0.1s/epoch)
Epoch  491/1500:Epoch loss: 0.2584 - avg acc: 69.5% - val-roc: 0.8878 - val-ap: 0.9207 (0.1s/epoch)
Epoch  492/1500:Epoch loss: 0.2702 - avg acc: 67.2% - val-roc: 0.8827 - val-ap: 0.9127 (0.1s/epoch)
Epoch  493/1500:Epoch loss: 0.2759 - avg acc: 64.9% - val-roc: 0.8827 - val-ap: 0.9115 (0.1s/epoch)
Epoch  494/1500:Epoch loss: 0.2699 - avg acc: 71.8% - val-roc: 0.8776 - val-ap: 0.9090 (0.1s/epoch)
Epoch  495/1500:Epoch loss: 0.2841 - avg acc: 67.9% - val-roc: 0.8622 - val-ap: 0.8959 (0.1s/epoch)
Epoch  496/1500:Epoch loss: 0.2733 - avg acc: 64.1% - val-roc: 0.8444 - val-ap: 0.8926 (0.1s/epoch)
Epoch  497/1500:Epoch loss: 0.2693 - avg acc: 63.4% - val-roc: 0.7245 - val-ap: 0.8292 (0.1s/epoch)
Epoch  498/1500:Epoch loss: 0.2877 - avg acc: 56.5% - val-roc: 0.7347 - val-ap: 0.8273 (0.1s/epoch)
Epoch  499/1500:Epoch loss: 0.3010 - avg acc: 70.2% - val-roc: 0.7500 - val-ap: 0.8448 (0.1s/epoch)
Epoch  500/1500:Epoch loss: 0.2628 - avg acc: 70.2% - val-roc: 0.8827 - val-ap: 0.9095 (0.1s/epoch)
Epoch  501/1500:Epoch loss: 0.2885 - avg acc: 66.4% - val-roc: 0.8520 - val-ap: 0.8851 (0.1s/epoch)
Epoch  502/1500:Epoch loss: 0.2849 - avg acc: 61.1% - val-roc: 0.9031 - val-ap: 0.9253 (0.1s/epoch)
Epoch  503/1500:Epoch loss: 0.3025 - avg acc: 61.8% - val-roc: 0.8827 - val-ap: 0.9180 (0.1s/epoch)
Epoch  504/1500:Epoch loss: 0.2729 - avg acc: 62.6% - val-roc: 0.8878 - val-ap: 0.9265 (0.1s/epoch)
Epoch  505/1500:Epoch loss: 0.2629 - avg acc: 57.3% - val-roc: 0.9082 - val-ap: 0.9316 (0.2s/epoch)
Epoch  506/1500:Epoch loss: 0.3202 - avg acc: 54.2% - val-roc: 0.8929 - val-ap: 0.9265 (0.1s/epoch)
Epoch  507/1500:Epoch loss: 0.2638 - avg acc: 55.0% - val-roc: 0.8724 - val-ap: 0.9012 (0.1s/epoch)
Epoch  508/1500:Epoch loss: 0.2749 - avg acc: 55.7% - val-roc: 0.8673 - val-ap: 0.9029 (0.1s/epoch)
Epoch  509/1500:Epoch loss: 0.2927 - avg acc: 53.4% - val-roc: 0.8827 - val-ap: 0.9159 (0.1s/epoch)
Epoch  510/1500:Epoch loss: 0.2780 - avg acc: 55.0% - val-roc: 0.8776 - val-ap: 0.9143 (0.2s/epoch)
Epoch  511/1500:Epoch loss: 0.2772 - avg acc: 58.8% - val-roc: 0.8112 - val-ap: 0.8818 (0.1s/epoch)
Epoch  512/1500:Epoch loss: 0.2622 - avg acc: 60.3% - val-roc: 0.8776 - val-ap: 0.9127 (0.1s/epoch)
Epoch  513/1500:Epoch loss: 0.2686 - avg acc: 68.7% - val-roc: 0.8469 - val-ap: 0.8944 (0.1s/epoch)
Epoch  514/1500:Epoch loss: 0.2688 - avg acc: 71.8% - val-roc: 0.8163 - val-ap: 0.8840 (0.1s/epoch)
Epoch  515/1500:Epoch loss: 0.2738 - avg acc: 73.3% - val-roc: 0.8724 - val-ap: 0.9087 (0.2s/epoch)
Epoch  516/1500:Epoch loss: 0.2866 - avg acc: 73.3% - val-roc: 0.8724 - val-ap: 0.9087 (0.1s/epoch)
Epoch  517/1500:Epoch loss: 0.2610 - avg acc: 73.3% - val-roc: 0.8520 - val-ap: 0.8932 (0.1s/epoch)
Epoch  518/1500:Epoch loss: 0.2572 - avg acc: 72.5% - val-roc: 0.8776 - val-ap: 0.9166 (0.1s/epoch)
Epoch  519/1500:Epoch loss: 0.2560 - avg acc: 72.5% - val-roc: 0.8520 - val-ap: 0.8932 (0.1s/epoch)
Epoch  520/1500:Epoch loss: 0.2845 - avg acc: 72.5% - val-roc: 0.8724 - val-ap: 0.9087 (0.1s/epoch)
Epoch  521/1500:Epoch loss: 0.2681 - avg acc: 72.5% - val-roc: 0.8724 - val-ap: 0.9142 (0.1s/epoch)
Epoch  522/1500:Epoch loss: 0.2679 - avg acc: 73.3% - val-roc: 0.8724 - val-ap: 0.9142 (0.1s/epoch)
Epoch  523/1500:Epoch loss: 0.2596 - avg acc: 73.3% - val-roc: 0.8776 - val-ap: 0.9166 (0.1s/epoch)
Epoch  524/1500:Epoch loss: 0.2809 - avg acc: 73.3% - val-roc: 0.8724 - val-ap: 0.9142 (0.1s/epoch)
Epoch  525/1500:Epoch loss: 0.2571 - avg acc: 73.3% - val-roc: 0.8878 - val-ap: 0.9194 (0.1s/epoch)
Epoch  526/1500:Epoch loss: 0.2918 - avg acc: 69.5% - val-roc: 0.8827 - val-ap: 0.9169 (0.1s/epoch)
Epoch  527/1500:Epoch loss: 0.2675 - avg acc: 73.3% - val-roc: 0.8878 - val-ap: 0.9185 (0.1s/epoch)
Epoch  528/1500:Epoch loss: 0.2935 - avg acc: 73.3% - val-roc: 0.8827 - val-ap: 0.9180 (0.1s/epoch)
Epoch  529/1500:Epoch loss: 0.2607 - avg acc: 72.5% - val-roc: 0.8878 - val-ap: 0.9194 (0.1s/epoch)
Epoch  530/1500:Epoch loss: 0.2652 - avg acc: 71.8% - val-roc: 0.8776 - val-ap: 0.9166 (0.1s/epoch)
Epoch  531/1500:Epoch loss: 0.2594 - avg acc: 62.6% - val-roc: 0.8163 - val-ap: 0.8744 (0.2s/epoch)
Epoch  532/1500:Epoch loss: 0.2700 - avg acc: 62.6% - val-roc: 0.8673 - val-ap: 0.9095 (0.1s/epoch)
Epoch  533/1500:Epoch loss: 0.2669 - avg acc: 70.2% - val-roc: 0.8776 - val-ap: 0.9166 (0.1s/epoch)
Epoch  534/1500:Epoch loss: 0.2915 - avg acc: 67.9% - val-roc: 0.8980 - val-ap: 0.9281 (0.1s/epoch)
Epoch  535/1500:Epoch loss: 0.3036 - avg acc: 70.2% - val-roc: 0.8776 - val-ap: 0.9191 (0.2s/epoch)
Epoch  536/1500:Epoch loss: 0.2678 - avg acc: 70.2% - val-roc: 0.8980 - val-ap: 0.9417 (0.1s/epoch)
Epoch  537/1500:Epoch loss: 0.2515 - avg acc: 71.0% - val-roc: 0.8776 - val-ap: 0.9213 (0.1s/epoch)
Epoch  538/1500:Epoch loss: 0.2766 - avg acc: 71.8% - val-roc: 0.8776 - val-ap: 0.9166 (0.1s/epoch)
Epoch  539/1500:Epoch loss: 0.2581 - avg acc: 71.8% - val-roc: 0.8827 - val-ap: 0.9227 (0.1s/epoch)
Epoch  540/1500:Epoch loss: 0.2589 - avg acc: 71.8% - val-roc: 0.8469 - val-ap: 0.8933 (0.1s/epoch)
Epoch  541/1500:Epoch loss: 0.2745 - avg acc: 71.0% - val-roc: 0.8776 - val-ap: 0.9155 (0.1s/epoch)
Epoch  542/1500:Epoch loss: 0.2618 - avg acc: 72.5% - val-roc: 0.8673 - val-ap: 0.9120 (0.2s/epoch)
Epoch  543/1500:Epoch loss: 0.2627 - avg acc: 72.5% - val-roc: 0.8673 - val-ap: 0.9120 (0.1s/epoch)
Epoch  544/1500:Epoch loss: 0.2599 - avg acc: 72.5% - val-roc: 0.8520 - val-ap: 0.8983 (0.1s/epoch)
Epoch  545/1500:Epoch loss: 0.2482 - avg acc: 72.5% - val-roc: 0.8724 - val-ap: 0.9142 (0.1s/epoch)
Epoch  546/1500:Epoch loss: 0.2553 - avg acc: 72.5% - val-roc: 0.8827 - val-ap: 0.9227 (0.1s/epoch)
Epoch  547/1500:Epoch loss: 0.2682 - avg acc: 73.3% - val-roc: 0.8827 - val-ap: 0.9180 (0.1s/epoch)
Epoch  548/1500:Epoch loss: 0.2586 - avg acc: 71.0% - val-roc: 0.8980 - val-ap: 0.9406 (0.1s/epoch)
Epoch  549/1500:Epoch loss: 0.2593 - avg acc: 70.2% - val-roc: 0.8827 - val-ap: 0.9278 (0.1s/epoch)
Epoch  550/1500:Epoch loss: 0.2636 - avg acc: 68.7% - val-roc: 0.9031 - val-ap: 0.9444 (0.1s/epoch)
Epoch  551/1500:Epoch loss: 0.2778 - avg acc: 70.2% - val-roc: 0.9031 - val-ap: 0.9431 (0.1s/epoch)
Epoch  552/1500:Epoch loss: 0.2570 - avg acc: 70.2% - val-roc: 0.8929 - val-ap: 0.9393 (0.1s/epoch)
Epoch  553/1500:Epoch loss: 0.2808 - avg acc: 70.2% - val-roc: 0.8929 - val-ap: 0.9351 (0.1s/epoch)
Epoch  554/1500:Epoch loss: 0.2882 - avg acc: 67.2% - val-roc: 0.8827 - val-ap: 0.9238 (0.1s/epoch)
Epoch  555/1500:Epoch loss: 0.2890 - avg acc: 64.1% - val-roc: 0.9133 - val-ap: 0.9460 (0.1s/epoch)
Epoch  556/1500:Epoch loss: 0.2570 - avg acc: 67.2% - val-roc: 0.8367 - val-ap: 0.8889 (0.1s/epoch)
Epoch  557/1500:Epoch loss: 0.2640 - avg acc: 70.2% - val-roc: 0.8163 - val-ap: 0.8867 (0.1s/epoch)
Epoch  558/1500:Epoch loss: 0.2683 - avg acc: 67.2% - val-roc: 0.8214 - val-ap: 0.8975 (0.2s/epoch)
Epoch  559/1500:Epoch loss: 0.2653 - avg acc: 67.2% - val-roc: 0.8469 - val-ap: 0.9005 (0.1s/epoch)
Epoch  560/1500:Epoch loss: 0.2672 - avg acc: 64.9% - val-roc: 0.7908 - val-ap: 0.8721 (0.1s/epoch)
Epoch  561/1500:Epoch loss: 0.2486 - avg acc: 70.2% - val-roc: 0.8163 - val-ap: 0.8855 (0.1s/epoch)
Epoch  562/1500:Epoch loss: 0.2730 - avg acc: 70.2% - val-roc: 0.8827 - val-ap: 0.9238 (0.1s/epoch)
Epoch  563/1500:Epoch loss: 0.2891 - avg acc: 70.2% - val-roc: 0.8776 - val-ap: 0.9166 (0.1s/epoch)
Epoch  564/1500:Epoch loss: 0.2549 - avg acc: 67.2% - val-roc: 0.8316 - val-ap: 0.8867 (0.1s/epoch)
Epoch  565/1500:Epoch loss: 0.2716 - avg acc: 31.3% - val-roc: 0.9056 - val-ap: 0.9267 (0.1s/epoch)
Epoch  566/1500:Epoch loss: 0.2526 - avg acc: 55.0% - val-roc: 0.8827 - val-ap: 0.9124 (0.1s/epoch)
Epoch  567/1500:Epoch loss: 0.2541 - avg acc: 64.1% - val-roc: 0.9133 - val-ap: 0.9448 (0.2s/epoch)
Epoch  568/1500:Epoch loss: 0.2505 - avg acc: 65.6% - val-roc: 0.8418 - val-ap: 0.9019 (0.1s/epoch)
Epoch  569/1500:Epoch loss: 0.2532 - avg acc: 70.2% - val-roc: 0.8724 - val-ap: 0.9133 (0.2s/epoch)
Epoch  570/1500:Epoch loss: 0.2716 - avg acc: 67.9% - val-roc: 0.8265 - val-ap: 0.9023 (0.1s/epoch)
Epoch  571/1500:Epoch loss: 0.2644 - avg acc: 67.2% - val-roc: 0.8010 - val-ap: 0.8791 (0.1s/epoch)
Epoch  572/1500:Epoch loss: 0.2881 - avg acc: 66.4% - val-roc: 0.8878 - val-ap: 0.9364 (0.1s/epoch)
Epoch  573/1500:Epoch loss: 0.2623 - avg acc: 67.2% - val-roc: 0.8010 - val-ap: 0.8791 (0.1s/epoch)
Epoch  574/1500:Epoch loss: 0.2665 - avg acc: 68.7% - val-roc: 0.8112 - val-ap: 0.8839 (0.1s/epoch)
Epoch  575/1500:Epoch loss: 0.2578 - avg acc: 66.4% - val-roc: 0.8520 - val-ap: 0.9070 (0.1s/epoch)
Epoch  576/1500:Epoch loss: 0.2518 - avg acc: 67.9% - val-roc: 0.8061 - val-ap: 0.8813 (0.1s/epoch)
Epoch  577/1500:Epoch loss: 0.2512 - avg acc: 67.9% - val-roc: 0.8827 - val-ap: 0.9180 (0.1s/epoch)
Epoch  578/1500:Epoch loss: 0.2712 - avg acc: 74.0% - val-roc: 0.8469 - val-ap: 0.8947 (0.1s/epoch)
Epoch  579/1500:Epoch loss: 0.3383 - avg acc: 70.2% - val-roc: 0.9133 - val-ap: 0.9460 (0.1s/epoch)
Epoch  580/1500:Epoch loss: 0.2507 - avg acc: 72.5% - val-roc: 0.8878 - val-ap: 0.9194 (0.1s/epoch)
Epoch  581/1500:Epoch loss: 0.2427 - avg acc: 67.2% - val-roc: 0.8673 - val-ap: 0.9086 (0.1s/epoch)
Epoch  582/1500:Epoch loss: 0.2899 - avg acc: 70.2% - val-roc: 0.8929 - val-ap: 0.9221 (0.2s/epoch)
Epoch  583/1500:Epoch loss: 0.2517 - avg acc: 67.9% - val-roc: 0.8878 - val-ap: 0.9194 (0.2s/epoch)
Epoch  584/1500:Epoch loss: 0.2578 - avg acc: 55.0% - val-roc: 0.8827 - val-ap: 0.9169 (0.1s/epoch)
Epoch  585/1500:Epoch loss: 0.2528 - avg acc: 64.1% - val-roc: 0.8878 - val-ap: 0.9142 (0.1s/epoch)
Epoch  586/1500:Epoch loss: 0.2585 - avg acc: 67.2% - val-roc: 0.8724 - val-ap: 0.9053 (0.1s/epoch)
Epoch  587/1500:Epoch loss: 0.2569 - avg acc: 73.3% - val-roc: 0.8673 - val-ap: 0.9063 (0.1s/epoch)
Epoch  588/1500:Epoch loss: 0.2763 - avg acc: 74.0% - val-roc: 0.8673 - val-ap: 0.9040 (0.1s/epoch)
Epoch  589/1500:Epoch loss: 0.2601 - avg acc: 74.0% - val-roc: 0.8265 - val-ap: 0.8830 (0.2s/epoch)
Epoch  590/1500:Epoch loss: 0.2545 - avg acc: 73.3% - val-roc: 0.8265 - val-ap: 0.8862 (0.1s/epoch)
Epoch  591/1500:Epoch loss: 0.2663 - avg acc: 71.0% - val-roc: 0.8776 - val-ap: 0.9090 (0.2s/epoch)
Epoch  592/1500:Epoch loss: 0.2595 - avg acc: 70.2% - val-roc: 0.8776 - val-ap: 0.9090 (0.1s/epoch)
Epoch  593/1500:Epoch loss: 0.2508 - avg acc: 70.2% - val-roc: 0.8776 - val-ap: 0.9090 (0.2s/epoch)
Epoch  594/1500:Epoch loss: 0.2644 - avg acc: 74.0% - val-roc: 0.8776 - val-ap: 0.9100 (0.2s/epoch)
Epoch  595/1500:Epoch loss: 0.2423 - avg acc: 74.0% - val-roc: 0.8724 - val-ap: 0.9068 (0.2s/epoch)
Epoch  596/1500:Epoch loss: 0.2333 - avg acc: 71.0% - val-roc: 0.8929 - val-ap: 0.9221 (0.3s/epoch)
Epoch  597/1500:Epoch loss: 0.2504 - avg acc: 74.0% - val-roc: 0.8878 - val-ap: 0.9194 (0.2s/epoch)
Epoch  598/1500:Epoch loss: 0.2594 - avg acc: 72.5% - val-roc: 0.8827 - val-ap: 0.9169 (0.1s/epoch)
Epoch  599/1500:Epoch loss: 0.2576 - avg acc: 73.3% - val-roc: 0.8878 - val-ap: 0.9185 (0.2s/epoch)
Epoch  600/1500:Epoch loss: 0.2409 - avg acc: 68.7% - val-roc: 0.8724 - val-ap: 0.9092 (0.1s/epoch)
Epoch  601/1500:Epoch loss: 0.2627 - avg acc: 67.2% - val-roc: 0.8622 - val-ap: 0.9028 (0.1s/epoch)
Epoch  602/1500:Epoch loss: 0.2543 - avg acc: 66.4% - val-roc: 0.8418 - val-ap: 0.8884 (0.2s/epoch)
Epoch  603/1500:Epoch loss: 0.2545 - avg acc: 68.7% - val-roc: 0.8316 - val-ap: 0.8926 (0.1s/epoch)
Epoch  604/1500:Epoch loss: 0.2529 - avg acc: 73.3% - val-roc: 0.8163 - val-ap: 0.8852 (0.1s/epoch)
Epoch  605/1500:Epoch loss: 0.3240 - avg acc: 74.0% - val-roc: 0.8878 - val-ap: 0.9251 (0.1s/epoch)
Epoch  606/1500:Epoch loss: 0.2621 - avg acc: 74.8% - val-roc: 0.8929 - val-ap: 0.9237 (0.2s/epoch)
Epoch  607/1500:Epoch loss: 0.2511 - avg acc: 74.0% - val-roc: 0.8878 - val-ap: 0.9158 (0.1s/epoch)
Epoch  608/1500:Epoch loss: 0.2613 - avg acc: 74.8% - val-roc: 0.8929 - val-ap: 0.9278 (0.1s/epoch)
Epoch  609/1500:Epoch loss: 0.2473 - avg acc: 72.5% - val-roc: 0.8878 - val-ap: 0.9207 (0.1s/epoch)
Epoch  610/1500:Epoch loss: 0.2430 - avg acc: 72.5% - val-roc: 0.8827 - val-ap: 0.9238 (0.1s/epoch)
Epoch  611/1500:Epoch loss: 0.2492 - avg acc: 71.8% - val-roc: 0.8776 - val-ap: 0.9166 (0.1s/epoch)
Epoch  612/1500:Epoch loss: 0.3120 - avg acc: 74.8% - val-roc: 0.8316 - val-ap: 0.8881 (0.1s/epoch)
Epoch  613/1500:Epoch loss: 0.2794 - avg acc: 74.8% - val-roc: 0.8878 - val-ap: 0.9207 (0.1s/epoch)
Epoch  614/1500:Epoch loss: 0.2404 - avg acc: 71.8% - val-roc: 0.8724 - val-ap: 0.9106 (0.1s/epoch)
Epoch  615/1500:Epoch loss: 0.2474 - avg acc: 71.8% - val-roc: 0.8622 - val-ap: 0.9038 (0.1s/epoch)
Epoch  616/1500:Epoch loss: 0.2892 - avg acc: 73.3% - val-roc: 0.8827 - val-ap: 0.9127 (0.1s/epoch)
Epoch  617/1500:Epoch loss: 0.2487 - avg acc: 73.3% - val-roc: 0.8827 - val-ap: 0.9127 (0.1s/epoch)
Epoch  618/1500:Epoch loss: 0.2434 - avg acc: 71.8% - val-roc: 0.8776 - val-ap: 0.9136 (0.1s/epoch)
Epoch  619/1500:Epoch loss: 0.2488 - avg acc: 73.3% - val-roc: 0.8214 - val-ap: 0.8854 (0.1s/epoch)
Epoch  620/1500:Epoch loss: 0.2378 - avg acc: 73.3% - val-roc: 0.8622 - val-ap: 0.8988 (0.2s/epoch)
Epoch  621/1500:Epoch loss: 0.2499 - avg acc: 73.3% - val-roc: 0.8878 - val-ap: 0.9207 (0.1s/epoch)
Epoch  622/1500:Epoch loss: 0.2482 - avg acc: 69.5% - val-roc: 0.8520 - val-ap: 0.9012 (0.2s/epoch)
Epoch  623/1500:Epoch loss: 0.2427 - avg acc: 67.9% - val-roc: 0.8878 - val-ap: 0.9224 (0.1s/epoch)
Epoch  624/1500:Epoch loss: 0.2450 - avg acc: 69.5% - val-roc: 0.8827 - val-ap: 0.9128 (0.2s/epoch)
Epoch  625/1500:Epoch loss: 0.2616 - avg acc: 69.5% - val-roc: 0.8878 - val-ap: 0.9224 (0.1s/epoch)
Epoch  626/1500:Epoch loss: 0.2471 - avg acc: 70.2% - val-roc: 0.8673 - val-ap: 0.9052 (0.1s/epoch)
Epoch  627/1500:Epoch loss: 0.2534 - avg acc: 71.8% - val-roc: 0.8571 - val-ap: 0.9010 (0.1s/epoch)
Epoch  628/1500:Epoch loss: 0.2548 - avg acc: 69.5% - val-roc: 0.8622 - val-ap: 0.9045 (0.1s/epoch)
Epoch  629/1500:Epoch loss: 0.2433 - avg acc: 71.8% - val-roc: 0.9031 - val-ap: 0.9310 (0.1s/epoch)
Epoch  630/1500:Epoch loss: 0.2416 - avg acc: 74.0% - val-roc: 0.8878 - val-ap: 0.9158 (0.1s/epoch)
Epoch  631/1500:Epoch loss: 0.2374 - avg acc: 73.3% - val-roc: 0.8929 - val-ap: 0.9237 (0.1s/epoch)
Epoch  632/1500:Epoch loss: 0.2400 - avg acc: 72.5% - val-roc: 0.8878 - val-ap: 0.9158 (0.1s/epoch)
Epoch  633/1500:Epoch loss: 0.2593 - avg acc: 73.3% - val-roc: 0.8929 - val-ap: 0.9237 (0.1s/epoch)
Epoch  634/1500:Epoch loss: 0.2419 - avg acc: 71.0% - val-roc: 0.8827 - val-ap: 0.9128 (0.1s/epoch)
Epoch  635/1500:Epoch loss: 0.2439 - avg acc: 73.3% - val-roc: 0.8571 - val-ap: 0.9101 (0.1s/epoch)
Epoch  636/1500:Epoch loss: 0.2541 - avg acc: 77.1% - val-roc: 0.8776 - val-ap: 0.9155 (0.1s/epoch)
Epoch  637/1500:Epoch loss: 0.2645 - avg acc: 76.3% - val-roc: 0.8622 - val-ap: 0.9119 (0.1s/epoch)
Epoch  638/1500:Epoch loss: 0.2467 - avg acc: 75.6% - val-roc: 0.8673 - val-ap: 0.9144 (0.1s/epoch)
Epoch  639/1500:Epoch loss: 0.2490 - avg acc: 73.3% - val-roc: 0.8469 - val-ap: 0.9106 (0.1s/epoch)
Epoch  640/1500:Epoch loss: 0.2478 - avg acc: 70.2% - val-roc: 0.8418 - val-ap: 0.9059 (0.1s/epoch)
Epoch  641/1500:Epoch loss: 0.2551 - avg acc: 70.2% - val-roc: 0.8776 - val-ap: 0.9155 (0.1s/epoch)
Epoch  642/1500:Epoch loss: 0.2459 - avg acc: 71.0% - val-roc: 0.8776 - val-ap: 0.9142 (0.1s/epoch)
Epoch  643/1500:Epoch loss: 0.2451 - avg acc: 70.2% - val-roc: 0.9133 - val-ap: 0.9396 (0.1s/epoch)
Epoch  644/1500:Epoch loss: 0.2354 - avg acc: 68.7% - val-roc: 0.9031 - val-ap: 0.9343 (0.1s/epoch)
Epoch  645/1500:Epoch loss: 0.2412 - avg acc: 72.5% - val-roc: 0.8980 - val-ap: 0.9309 (0.1s/epoch)
Epoch  646/1500:Epoch loss: 0.2482 - avg acc: 76.3% - val-roc: 0.9031 - val-ap: 0.9368 (0.1s/epoch)
Epoch  647/1500:Epoch loss: 0.2937 - avg acc: 76.3% - val-roc: 0.9082 - val-ap: 0.9381 (0.1s/epoch)
Epoch  648/1500:Epoch loss: 0.2422 - avg acc: 76.3% - val-roc: 0.8827 - val-ap: 0.9204 (0.1s/epoch)
Epoch  649/1500:Epoch loss: 0.2530 - avg acc: 77.9% - val-roc: 0.8980 - val-ap: 0.9309 (0.1s/epoch)
Epoch  650/1500:Epoch loss: 0.2692 - avg acc: 77.9% - val-roc: 0.8980 - val-ap: 0.9309 (0.1s/epoch)
Epoch  651/1500:Epoch loss: 0.2583 - avg acc: 77.1% - val-roc: 0.8724 - val-ap: 0.9113 (0.1s/epoch)
Epoch  652/1500:Epoch loss: 0.2387 - avg acc: 71.0% - val-roc: 0.9031 - val-ap: 0.9334 (0.1s/epoch)
Epoch  653/1500:Epoch loss: 0.3111 - avg acc: 65.6% - val-roc: 0.9082 - val-ap: 0.9354 (0.1s/epoch)
Epoch  654/1500:Epoch loss: 0.2707 - avg acc: 56.5% - val-roc: 0.8980 - val-ap: 0.9231 (0.1s/epoch)
Epoch  655/1500:Epoch loss: 0.2788 - avg acc: 56.5% - val-roc: 0.8776 - val-ap: 0.9081 (0.1s/epoch)
Epoch  656/1500:Epoch loss: 0.2698 - avg acc: 58.8% - val-roc: 0.8827 - val-ap: 0.9145 (0.1s/epoch)
Epoch  657/1500:Epoch loss: 0.2487 - avg acc: 66.4% - val-roc: 0.8776 - val-ap: 0.9114 (0.1s/epoch)
Epoch  658/1500:Epoch loss: 0.2508 - avg acc: 69.5% - val-roc: 0.8980 - val-ap: 0.9271 (0.1s/epoch)
Epoch  659/1500:Epoch loss: 0.2378 - avg acc: 71.0% - val-roc: 0.9184 - val-ap: 0.9356 (0.1s/epoch)
Epoch  660/1500:Epoch loss: 0.2449 - avg acc: 71.0% - val-roc: 0.9031 - val-ap: 0.9286 (0.1s/epoch)
Epoch  661/1500:Epoch loss: 0.2373 - avg acc: 72.5% - val-roc: 0.8163 - val-ap: 0.8799 (0.1s/epoch)
Epoch  662/1500:Epoch loss: 0.2428 - avg acc: 73.3% - val-roc: 0.9031 - val-ap: 0.9214 (0.1s/epoch)
Epoch  663/1500:Epoch loss: 0.2500 - avg acc: 73.3% - val-roc: 0.8929 - val-ap: 0.9148 (0.1s/epoch)
Epoch  664/1500:Epoch loss: 0.2453 - avg acc: 73.3% - val-roc: 0.9133 - val-ap: 0.9268 (0.1s/epoch)
Epoch  665/1500:Epoch loss: 0.2422 - avg acc: 73.3% - val-roc: 0.9184 - val-ap: 0.9336 (0.1s/epoch)
Epoch  666/1500:Epoch loss: 0.2450 - avg acc: 74.0% - val-roc: 0.8929 - val-ap: 0.9198 (0.1s/epoch)
Epoch  667/1500:Epoch loss: 0.2962 - avg acc: 74.0% - val-roc: 0.9082 - val-ap: 0.9357 (0.1s/epoch)
Epoch  668/1500:Epoch loss: 0.2521 - avg acc: 73.3% - val-roc: 0.8724 - val-ap: 0.9061 (0.1s/epoch)
Epoch  669/1500:Epoch loss: 0.2419 - avg acc: 73.3% - val-roc: 0.8316 - val-ap: 0.8926 (0.1s/epoch)
Epoch  670/1500:Epoch loss: 0.2489 - avg acc: 71.8% - val-roc: 0.8929 - val-ap: 0.9179 (0.1s/epoch)
Epoch  671/1500:Epoch loss: 0.2481 - avg acc: 74.0% - val-roc: 0.8469 - val-ap: 0.8906 (0.1s/epoch)
Epoch  672/1500:Epoch loss: 0.2367 - avg acc: 74.0% - val-roc: 0.9031 - val-ap: 0.9222 (0.1s/epoch)
Epoch  673/1500:Epoch loss: 0.2336 - avg acc: 74.8% - val-roc: 0.8520 - val-ap: 0.9007 (0.1s/epoch)
Epoch  674/1500:Epoch loss: 0.2374 - avg acc: 74.8% - val-roc: 0.9133 - val-ap: 0.9289 (0.1s/epoch)
Epoch  675/1500:Epoch loss: 0.2457 - avg acc: 64.9% - val-roc: 0.9133 - val-ap: 0.9340 (0.1s/epoch)
Epoch  676/1500:Epoch loss: 0.2402 - avg acc: 68.7% - val-roc: 0.9286 - val-ap: 0.9377 (0.1s/epoch)
Epoch  677/1500:Epoch loss: 0.2558 - avg acc: 67.9% - val-roc: 0.9235 - val-ap: 0.9401 (0.1s/epoch)
Epoch  678/1500:Epoch loss: 0.2414 - avg acc: 73.3% - val-roc: 0.8980 - val-ap: 0.9176 (0.1s/epoch)
Epoch  679/1500:Epoch loss: 0.2341 - avg acc: 71.0% - val-roc: 0.9133 - val-ap: 0.9291 (0.1s/epoch)
Epoch  680/1500:Epoch loss: 0.2540 - avg acc: 74.0% - val-roc: 0.9184 - val-ap: 0.9321 (0.1s/epoch)
Epoch  681/1500:Epoch loss: 0.2426 - avg acc: 74.8% - val-roc: 0.9184 - val-ap: 0.9321 (0.1s/epoch)
Epoch  682/1500:Epoch loss: 0.2447 - avg acc: 77.1% - val-roc: 0.9133 - val-ap: 0.9291 (0.1s/epoch)
Epoch  683/1500:Epoch loss: 0.2399 - avg acc: 74.8% - val-roc: 0.8980 - val-ap: 0.9236 (0.1s/epoch)
Epoch  684/1500:Epoch loss: 0.2377 - avg acc: 74.0% - val-roc: 0.9031 - val-ap: 0.9244 (0.1s/epoch)
Epoch  685/1500:Epoch loss: 0.2483 - avg acc: 75.6% - val-roc: 0.8418 - val-ap: 0.8945 (0.1s/epoch)
Epoch  686/1500:Epoch loss: 0.2486 - avg acc: 76.3% - val-roc: 0.8367 - val-ap: 0.8903 (0.1s/epoch)
Epoch  687/1500:Epoch loss: 0.2401 - avg acc: 74.8% - val-roc: 0.8061 - val-ap: 0.8730 (0.1s/epoch)
Epoch  688/1500:Epoch loss: 0.2380 - avg acc: 76.3% - val-roc: 0.8929 - val-ap: 0.9161 (0.1s/epoch)
Epoch  689/1500:Epoch loss: 0.2348 - avg acc: 71.8% - val-roc: 0.8980 - val-ap: 0.9188 (0.1s/epoch)
Epoch  690/1500:Epoch loss: 0.2652 - avg acc: 72.5% - val-roc: 0.9184 - val-ap: 0.9337 (0.1s/epoch)
Epoch  691/1500:Epoch loss: 0.2497 - avg acc: 73.3% - val-roc: 0.9133 - val-ap: 0.9305 (0.1s/epoch)
Epoch  692/1500:Epoch loss: 0.2373 - avg acc: 74.0% - val-roc: 0.9133 - val-ap: 0.9335 (0.1s/epoch)
Epoch  693/1500:Epoch loss: 0.2320 - avg acc: 74.8% - val-roc: 0.8520 - val-ap: 0.9016 (0.1s/epoch)
Epoch  694/1500:Epoch loss: 0.2273 - avg acc: 74.8% - val-roc: 0.8673 - val-ap: 0.9039 (0.1s/epoch)
Epoch  695/1500:Epoch loss: 0.2550 - avg acc: 73.3% - val-roc: 0.8929 - val-ap: 0.9160 (0.1s/epoch)
Epoch  696/1500:Epoch loss: 0.2464 - avg acc: 70.2% - val-roc: 0.8673 - val-ap: 0.9030 (0.1s/epoch)
Epoch  697/1500:Epoch loss: 0.2382 - avg acc: 68.7% - val-roc: 0.8469 - val-ap: 0.8952 (0.1s/epoch)
Epoch  698/1500:Epoch loss: 0.2445 - avg acc: 68.7% - val-roc: 0.8469 - val-ap: 0.8968 (0.1s/epoch)
Epoch  699/1500:Epoch loss: 0.2354 - avg acc: 70.2% - val-roc: 0.8367 - val-ap: 0.8923 (0.1s/epoch)
Epoch  700/1500:Epoch loss: 0.2363 - avg acc: 68.7% - val-roc: 0.8418 - val-ap: 0.8940 (0.1s/epoch)
Epoch  701/1500:Epoch loss: 0.2307 - avg acc: 70.2% - val-roc: 0.8469 - val-ap: 0.8958 (0.1s/epoch)
Epoch  702/1500:Epoch loss: 0.2363 - avg acc: 67.2% - val-roc: 0.8316 - val-ap: 0.8836 (0.1s/epoch)
Epoch  703/1500:Epoch loss: 0.2497 - avg acc: 67.9% - val-roc: 0.8673 - val-ap: 0.9006 (0.1s/epoch)
Epoch  704/1500:Epoch loss: 0.2360 - avg acc: 71.8% - val-roc: 0.8929 - val-ap: 0.9169 (0.1s/epoch)
Epoch  705/1500:Epoch loss: 0.2434 - avg acc: 74.0% - val-roc: 0.8929 - val-ap: 0.9215 (0.1s/epoch)
Epoch  706/1500:Epoch loss: 0.2347 - avg acc: 77.1% - val-roc: 0.8724 - val-ap: 0.9098 (0.1s/epoch)
Epoch  707/1500:Epoch loss: 0.2463 - avg acc: 74.0% - val-roc: 0.8980 - val-ap: 0.9281 (0.1s/epoch)
Epoch  708/1500:Epoch loss: 0.2762 - avg acc: 75.6% - val-roc: 0.8316 - val-ap: 0.8785 (0.1s/epoch)
Epoch  709/1500:Epoch loss: 0.2283 - avg acc: 76.3% - val-roc: 0.8724 - val-ap: 0.9005 (0.1s/epoch)
Epoch  710/1500:Epoch loss: 0.2283 - avg acc: 77.9% - val-roc: 0.8112 - val-ap: 0.8772 (0.1s/epoch)
Epoch  711/1500:Epoch loss: 0.2328 - avg acc: 77.1% - val-roc: 0.8163 - val-ap: 0.8753 (0.1s/epoch)
Epoch  712/1500:Epoch loss: 0.2238 - avg acc: 76.3% - val-roc: 0.8571 - val-ap: 0.8960 (0.1s/epoch)
Epoch  713/1500:Epoch loss: 0.2278 - avg acc: 76.3% - val-roc: 0.8571 - val-ap: 0.9031 (0.1s/epoch)
Epoch  714/1500:Epoch loss: 0.2413 - avg acc: 76.3% - val-roc: 0.8214 - val-ap: 0.8803 (0.1s/epoch)
Epoch  715/1500:Epoch loss: 0.2467 - avg acc: 69.5% - val-roc: 0.8418 - val-ap: 0.8969 (0.1s/epoch)
Epoch  716/1500:Epoch loss: 0.2305 - avg acc: 70.2% - val-roc: 0.8316 - val-ap: 0.8784 (0.1s/epoch)
Epoch  717/1500:Epoch loss: 0.2281 - avg acc: 71.8% - val-roc: 0.8622 - val-ap: 0.8995 (0.1s/epoch)
Epoch  718/1500:Epoch loss: 0.2390 - avg acc: 75.6% - val-roc: 0.8265 - val-ap: 0.8756 (0.2s/epoch)
Epoch  719/1500:Epoch loss: 0.2237 - avg acc: 75.6% - val-roc: 0.7908 - val-ap: 0.8613 (0.1s/epoch)
Epoch  720/1500:Epoch loss: 0.2406 - avg acc: 75.6% - val-roc: 0.7959 - val-ap: 0.8601 (0.1s/epoch)
Epoch  721/1500:Epoch loss: 0.2392 - avg acc: 76.3% - val-roc: 0.8061 - val-ap: 0.8678 (0.1s/epoch)
Epoch  722/1500:Epoch loss: 0.2361 - avg acc: 76.3% - val-roc: 0.8418 - val-ap: 0.8926 (0.1s/epoch)
Epoch  723/1500:Epoch loss: 0.2281 - avg acc: 76.3% - val-roc: 0.8214 - val-ap: 0.8851 (0.1s/epoch)
Epoch  724/1500:Epoch loss: 0.2356 - avg acc: 77.1% - val-roc: 0.8265 - val-ap: 0.8799 (0.1s/epoch)
Epoch  725/1500:Epoch loss: 0.2357 - avg acc: 74.0% - val-roc: 0.7959 - val-ap: 0.8600 (0.1s/epoch)
Epoch  726/1500:Epoch loss: 0.2243 - avg acc: 75.6% - val-roc: 0.8214 - val-ap: 0.8778 (0.1s/epoch)
Epoch  727/1500:Epoch loss: 0.2396 - avg acc: 74.8% - val-roc: 0.8265 - val-ap: 0.8799 (0.1s/epoch)
Epoch  728/1500:Epoch loss: 0.2362 - avg acc: 74.0% - val-roc: 0.8469 - val-ap: 0.8890 (0.1s/epoch)
Epoch  729/1500:Epoch loss: 0.2291 - avg acc: 75.6% - val-roc: 0.8724 - val-ap: 0.8999 (0.1s/epoch)
Epoch  730/1500:Epoch loss: 0.2301 - avg acc: 77.1% - val-roc: 0.8776 - val-ap: 0.9071 (0.1s/epoch)
Epoch  731/1500:Epoch loss: 0.2290 - avg acc: 77.1% - val-roc: 0.8520 - val-ap: 0.8958 (0.1s/epoch)
Epoch  732/1500:Epoch loss: 0.2354 - avg acc: 74.0% - val-roc: 0.8776 - val-ap: 0.9071 (0.1s/epoch)
Epoch  733/1500:Epoch loss: 0.2213 - avg acc: 74.8% - val-roc: 0.8724 - val-ap: 0.9056 (0.1s/epoch)
Epoch  734/1500:Epoch loss: 0.2290 - avg acc: 74.8% - val-roc: 0.8520 - val-ap: 0.8949 (0.1s/epoch)
Epoch  735/1500:Epoch loss: 0.2278 - avg acc: 77.1% - val-roc: 0.8571 - val-ap: 0.8980 (0.1s/epoch)
Epoch  736/1500:Epoch loss: 0.3153 - avg acc: 78.6% - val-roc: 0.8265 - val-ap: 0.8785 (0.1s/epoch)
Epoch  737/1500:Epoch loss: 0.2333 - avg acc: 77.1% - val-roc: 0.8214 - val-ap: 0.8726 (0.1s/epoch)
Epoch  738/1500:Epoch loss: 0.2329 - avg acc: 77.9% - val-roc: 0.8316 - val-ap: 0.8779 (0.1s/epoch)
Epoch  739/1500:Epoch loss: 0.2281 - avg acc: 70.2% - val-roc: 0.8827 - val-ap: 0.8994 (0.1s/epoch)
Epoch  740/1500:Epoch loss: 0.2298 - avg acc: 74.0% - val-roc: 0.8827 - val-ap: 0.8984 (0.1s/epoch)
Epoch  741/1500:Epoch loss: 0.2453 - avg acc: 74.8% - val-roc: 0.8469 - val-ap: 0.8803 (0.1s/epoch)
Epoch  742/1500:Epoch loss: 0.2484 - avg acc: 77.9% - val-roc: 0.8622 - val-ap: 0.8852 (0.1s/epoch)
Epoch  743/1500:Epoch loss: 0.2405 - avg acc: 70.2% - val-roc: 0.8724 - val-ap: 0.9004 (0.1s/epoch)
Epoch  744/1500:Epoch loss: 0.2328 - avg acc: 68.7% - val-roc: 0.8622 - val-ap: 0.8989 (0.1s/epoch)
Epoch  745/1500:Epoch loss: 0.2249 - avg acc: 67.2% - val-roc: 0.8214 - val-ap: 0.8834 (0.1s/epoch)
Epoch  746/1500:Epoch loss: 0.2324 - avg acc: 68.7% - val-roc: 0.8673 - val-ap: 0.9047 (0.1s/epoch)
Epoch  747/1500:Epoch loss: 0.2356 - avg acc: 70.2% - val-roc: 0.8622 - val-ap: 0.8979 (0.1s/epoch)
Epoch  748/1500:Epoch loss: 0.2249 - avg acc: 77.1% - val-roc: 0.8316 - val-ap: 0.8818 (0.1s/epoch)
Epoch  749/1500:Epoch loss: 0.2388 - avg acc: 69.5% - val-roc: 0.8316 - val-ap: 0.8860 (0.1s/epoch)
Epoch  750/1500:Epoch loss: 0.2605 - avg acc: 72.5% - val-roc: 0.8469 - val-ap: 0.8956 (0.1s/epoch)
Epoch  751/1500:Epoch loss: 0.2504 - avg acc: 71.0% - val-roc: 0.8418 - val-ap: 0.8861 (0.1s/epoch)
Epoch  752/1500:Epoch loss: 0.2238 - avg acc: 77.1% - val-roc: 0.8316 - val-ap: 0.8823 (0.1s/epoch)
Epoch  753/1500:Epoch loss: 0.2317 - avg acc: 76.3% - val-roc: 0.8010 - val-ap: 0.8678 (0.1s/epoch)
Epoch  754/1500:Epoch loss: 0.2270 - avg acc: 71.0% - val-roc: 0.7908 - val-ap: 0.8618 (0.1s/epoch)
Epoch  755/1500:Epoch loss: 0.2169 - avg acc: 67.9% - val-roc: 0.8010 - val-ap: 0.8648 (0.1s/epoch)
Epoch  756/1500:Epoch loss: 0.2247 - avg acc: 67.9% - val-roc: 0.8112 - val-ap: 0.8682 (0.1s/epoch)
Epoch  757/1500:Epoch loss: 0.2539 - avg acc: 75.6% - val-roc: 0.8010 - val-ap: 0.8612 (0.1s/epoch)
Epoch  758/1500:Epoch loss: 0.2157 - avg acc: 76.3% - val-roc: 0.7908 - val-ap: 0.8566 (0.1s/epoch)
Epoch  759/1500:Epoch loss: 0.2269 - avg acc: 77.9% - val-roc: 0.8010 - val-ap: 0.8606 (0.1s/epoch)
Epoch  760/1500:Epoch loss: 0.3907 - avg acc: 79.4% - val-roc: 0.8112 - val-ap: 0.8619 (0.1s/epoch)
Epoch  761/1500:Epoch loss: 0.2382 - avg acc: 77.9% - val-roc: 0.8010 - val-ap: 0.8630 (0.1s/epoch)
Epoch  762/1500:Epoch loss: 0.2538 - avg acc: 71.0% - val-roc: 0.8061 - val-ap: 0.8669 (0.1s/epoch)
Epoch  763/1500:Epoch loss: 0.2541 - avg acc: 60.3% - val-roc: 0.7704 - val-ap: 0.8505 (0.1s/epoch)
Epoch  764/1500:Epoch loss: 0.2234 - avg acc: 67.9% - val-roc: 0.7755 - val-ap: 0.8463 (0.1s/epoch)
Epoch  765/1500:Epoch loss: 0.2306 - avg acc: 71.0% - val-roc: 0.7959 - val-ap: 0.8533 (0.1s/epoch)
Epoch  766/1500:Epoch loss: 0.2282 - avg acc: 67.2% - val-roc: 0.7755 - val-ap: 0.8461 (0.1s/epoch)
Epoch  767/1500:Epoch loss: 0.2374 - avg acc: 68.7% - val-roc: 0.8010 - val-ap: 0.8592 (0.1s/epoch)
Epoch  768/1500:Epoch loss: 0.3029 - avg acc: 75.6% - val-roc: 0.7704 - val-ap: 0.8442 (0.1s/epoch)
Epoch  769/1500:Epoch loss: 0.2295 - avg acc: 75.6% - val-roc: 0.7704 - val-ap: 0.8442 (0.1s/epoch)
Epoch  770/1500:Epoch loss: 0.2484 - avg acc: 73.3% - val-roc: 0.7857 - val-ap: 0.8524 (0.1s/epoch)
Epoch  771/1500:Epoch loss: 0.2537 - avg acc: 71.0% - val-roc: 0.8061 - val-ap: 0.8691 (0.1s/epoch)
Epoch  772/1500:Epoch loss: 0.2272 - avg acc: 71.8% - val-roc: 0.7755 - val-ap: 0.8469 (0.1s/epoch)
Epoch  773/1500:Epoch loss: 0.2205 - avg acc: 65.6% - val-roc: 0.7551 - val-ap: 0.8390 (0.1s/epoch)
Epoch  774/1500:Epoch loss: 0.2327 - avg acc: 71.0% - val-roc: 0.7704 - val-ap: 0.8484 (0.1s/epoch)
Epoch  775/1500:Epoch loss: 0.2253 - avg acc: 72.5% - val-roc: 0.7602 - val-ap: 0.8407 (0.1s/epoch)
Epoch  776/1500:Epoch loss: 0.2225 - avg acc: 67.9% - val-roc: 0.7857 - val-ap: 0.8562 (0.1s/epoch)
Epoch  777/1500:Epoch loss: 0.2216 - avg acc: 71.8% - val-roc: 0.7857 - val-ap: 0.8549 (0.1s/epoch)
Epoch  778/1500:Epoch loss: 0.2417 - avg acc: 72.5% - val-roc: 0.7755 - val-ap: 0.8508 (0.1s/epoch)
Epoch  779/1500:Epoch loss: 0.2407 - avg acc: 74.8% - val-roc: 0.7755 - val-ap: 0.8567 (0.1s/epoch)
Epoch  780/1500:Epoch loss: 0.2088 - avg acc: 69.5% - val-roc: 0.8010 - val-ap: 0.8712 (0.1s/epoch)
Epoch  781/1500:Epoch loss: 0.2239 - avg acc: 71.0% - val-roc: 0.7704 - val-ap: 0.8485 (0.1s/epoch)
Epoch  782/1500:Epoch loss: 0.2095 - avg acc: 65.6% - val-roc: 0.8112 - val-ap: 0.8770 (0.1s/epoch)
Epoch  783/1500:Epoch loss: 0.2157 - avg acc: 66.4% - val-roc: 0.7959 - val-ap: 0.8700 (0.1s/epoch)
Epoch  784/1500:Epoch loss: 0.2177 - avg acc: 71.0% - val-roc: 0.7653 - val-ap: 0.8523 (0.1s/epoch)
Epoch  785/1500:Epoch loss: 0.2239 - avg acc: 76.3% - val-roc: 0.7806 - val-ap: 0.8580 (0.1s/epoch)
Epoch  786/1500:Epoch loss: 0.2201 - avg acc: 76.3% - val-roc: 0.7806 - val-ap: 0.8580 (0.1s/epoch)
Epoch  787/1500:Epoch loss: 0.2353 - avg acc: 77.9% - val-roc: 0.7857 - val-ap: 0.8651 (0.1s/epoch)
Epoch  788/1500:Epoch loss: 0.2253 - avg acc: 77.1% - val-roc: 0.7755 - val-ap: 0.8621 (0.1s/epoch)
Epoch  789/1500:Epoch loss: 0.2114 - avg acc: 77.1% - val-roc: 0.7755 - val-ap: 0.8615 (0.2s/epoch)
Epoch  790/1500:Epoch loss: 0.2244 - avg acc: 77.1% - val-roc: 0.7653 - val-ap: 0.8587 (0.1s/epoch)
Epoch  791/1500:Epoch loss: 0.2119 - avg acc: 77.1% - val-roc: 0.7653 - val-ap: 0.8523 (0.1s/epoch)
Epoch  792/1500:Epoch loss: 0.2132 - avg acc: 77.1% - val-roc: 0.7551 - val-ap: 0.8497 (0.1s/epoch)
Epoch  793/1500:Epoch loss: 0.2157 - avg acc: 77.1% - val-roc: 0.7500 - val-ap: 0.8482 (0.1s/epoch)
Epoch  794/1500:Epoch loss: 0.2103 - avg acc: 76.3% - val-roc: 0.7449 - val-ap: 0.8468 (0.1s/epoch)
Epoch  795/1500:Epoch loss: 0.2111 - avg acc: 75.6% - val-roc: 0.7500 - val-ap: 0.8482 (0.1s/epoch)
Epoch  796/1500:Epoch loss: 0.2142 - avg acc: 74.8% - val-roc: 0.7602 - val-ap: 0.8508 (0.1s/epoch)
Epoch  797/1500:Epoch loss: 0.2003 - avg acc: 75.6% - val-roc: 0.7500 - val-ap: 0.8477 (0.1s/epoch)
Epoch  798/1500:Epoch loss: 0.2306 - avg acc: 76.3% - val-roc: 0.7449 - val-ap: 0.8461 (0.1s/epoch)
Epoch  799/1500:Epoch loss: 0.2033 - avg acc: 77.1% - val-roc: 0.7449 - val-ap: 0.8463 (0.1s/epoch)
Epoch  800/1500:Epoch loss: 0.2104 - avg acc: 76.3% - val-roc: 0.7602 - val-ap: 0.8513 (0.1s/epoch)
Epoch  801/1500:Epoch loss: 0.2074 - avg acc: 78.6% - val-roc: 0.7602 - val-ap: 0.8513 (0.1s/epoch)
Epoch  802/1500:Epoch loss: 0.2131 - avg acc: 78.6% - val-roc: 0.7602 - val-ap: 0.8513 (0.1s/epoch)
Epoch  803/1500:Epoch loss: 0.2097 - avg acc: 78.6% - val-roc: 0.7551 - val-ap: 0.8494 (0.1s/epoch)
Epoch  804/1500:Epoch loss: 0.2273 - avg acc: 78.6% - val-roc: 0.7551 - val-ap: 0.8494 (0.1s/epoch)
Epoch  805/1500:Epoch loss: 0.2035 - avg acc: 79.4% - val-roc: 0.7551 - val-ap: 0.8506 (0.1s/epoch)
Epoch  806/1500:Epoch loss: 0.2048 - avg acc: 76.3% - val-roc: 0.7551 - val-ap: 0.8501 (0.1s/epoch)
Epoch  807/1500:Epoch loss: 0.2319 - avg acc: 78.6% - val-roc: 0.7551 - val-ap: 0.8467 (0.1s/epoch)
Epoch  808/1500:Epoch loss: 0.2156 - avg acc: 78.6% - val-roc: 0.7653 - val-ap: 0.8537 (0.1s/epoch)
Epoch  809/1500:Epoch loss: 0.1939 - avg acc: 79.4% - val-roc: 0.7857 - val-ap: 0.8659 (0.1s/epoch)
Epoch  810/1500:Epoch loss: 0.2153 - avg acc: 78.6% - val-roc: 0.7653 - val-ap: 0.8585 (0.1s/epoch)
Epoch  811/1500:Epoch loss: 0.1960 - avg acc: 80.2% - val-roc: 0.7551 - val-ap: 0.8558 (0.1s/epoch)
Epoch  812/1500:Epoch loss: 0.1983 - avg acc: 80.2% - val-roc: 0.7857 - val-ap: 0.8659 (0.1s/epoch)
Epoch  813/1500:Epoch loss: 0.2038 - avg acc: 74.8% - val-roc: 0.7857 - val-ap: 0.8651 (0.1s/epoch)
Epoch  814/1500:Epoch loss: 0.1974 - avg acc: 74.8% - val-roc: 0.7755 - val-ap: 0.8620 (0.1s/epoch)
Epoch  815/1500:Epoch loss: 0.2101 - avg acc: 74.0% - val-roc: 0.7806 - val-ap: 0.8636 (0.1s/epoch)
Epoch  816/1500:Epoch loss: 0.1983 - avg acc: 78.6% - val-roc: 0.7755 - val-ap: 0.8620 (0.1s/epoch)
Epoch  817/1500:Epoch loss: 0.2133 - avg acc: 80.2% - val-roc: 0.7704 - val-ap: 0.8605 (0.1s/epoch)
Epoch  818/1500:Epoch loss: 0.2320 - avg acc: 80.2% - val-roc: 0.7602 - val-ap: 0.8586 (0.1s/epoch)
Epoch  819/1500:Epoch loss: 0.1934 - avg acc: 79.4% - val-roc: 0.7551 - val-ap: 0.8573 (0.1s/epoch)
Epoch  820/1500:Epoch loss: 0.2089 - avg acc: 80.2% - val-roc: 0.7908 - val-ap: 0.8676 (0.1s/epoch)
Epoch  821/1500:Epoch loss: 0.2138 - avg acc: 75.6% - val-roc: 0.7806 - val-ap: 0.8581 (0.1s/epoch)
Epoch  822/1500:Epoch loss: 0.2084 - avg acc: 76.3% - val-roc: 0.7908 - val-ap: 0.8667 (0.1s/epoch)
Epoch  823/1500:Epoch loss: 0.1797 - avg acc: 72.5% - val-roc: 0.7959 - val-ap: 0.8637 (0.1s/epoch)
Epoch  824/1500:Epoch loss: 0.2062 - avg acc: 71.8% - val-roc: 0.7959 - val-ap: 0.8643 (0.1s/epoch)
Epoch  825/1500:Epoch loss: 0.2322 - avg acc: 74.0% - val-roc: 0.7959 - val-ap: 0.8699 (0.1s/epoch)
Epoch  826/1500:Epoch loss: 0.1970 - avg acc: 75.6% - val-roc: 0.7908 - val-ap: 0.8676 (0.1s/epoch)
Epoch  827/1500:Epoch loss: 0.2156 - avg acc: 76.3% - val-roc: 0.7908 - val-ap: 0.8620 (0.1s/epoch)
Epoch  828/1500:Epoch loss: 0.1828 - avg acc: 76.3% - val-roc: 0.7959 - val-ap: 0.8691 (0.1s/epoch)
Epoch  829/1500:Epoch loss: 0.2065 - avg acc: 76.3% - val-roc: 0.7908 - val-ap: 0.8674 (0.1s/epoch)
Epoch  830/1500:Epoch loss: 0.1973 - avg acc: 78.6% - val-roc: 0.7908 - val-ap: 0.8674 (0.1s/epoch)
Epoch  831/1500:Epoch loss: 0.2001 - avg acc: 76.3% - val-roc: 0.8010 - val-ap: 0.8708 (0.1s/epoch)
Epoch  832/1500:Epoch loss: 0.1899 - avg acc: 76.3% - val-roc: 0.8010 - val-ap: 0.8708 (0.2s/epoch)
Epoch  833/1500:Epoch loss: 0.1908 - avg acc: 75.6% - val-roc: 0.7959 - val-ap: 0.8704 (0.1s/epoch)
Epoch  834/1500:Epoch loss: 0.2071 - avg acc: 71.0% - val-roc: 0.7908 - val-ap: 0.8686 (0.1s/epoch)
Epoch  835/1500:Epoch loss: 0.1891 - avg acc: 72.5% - val-roc: 0.7857 - val-ap: 0.8669 (0.1s/epoch)
Epoch  836/1500:Epoch loss: 0.2067 - avg acc: 75.6% - val-roc: 0.7908 - val-ap: 0.8676 (0.1s/epoch)
Epoch  837/1500:Epoch loss: 0.2170 - avg acc: 74.8% - val-roc: 0.7908 - val-ap: 0.8735 (0.1s/epoch)
Epoch  838/1500:Epoch loss: 0.1792 - avg acc: 76.3% - val-roc: 0.7908 - val-ap: 0.8734 (0.1s/epoch)
Epoch  839/1500:Epoch loss: 0.2035 - avg acc: 73.3% - val-roc: 0.7806 - val-ap: 0.8668 (0.1s/epoch)
Epoch  840/1500:Epoch loss: 0.2172 - avg acc: 71.0% - val-roc: 0.8010 - val-ap: 0.8778 (0.1s/epoch)
Epoch  841/1500:Epoch loss: 0.2225 - avg acc: 72.5% - val-roc: 0.7959 - val-ap: 0.8694 (0.1s/epoch)
Epoch  842/1500:Epoch loss: 0.1966 - avg acc: 74.8% - val-roc: 0.7755 - val-ap: 0.8621 (0.1s/epoch)
Epoch  843/1500:Epoch loss: 0.1999 - avg acc: 76.3% - val-roc: 0.7755 - val-ap: 0.8582 (0.1s/epoch)
Epoch  844/1500:Epoch loss: 0.1823 - avg acc: 78.6% - val-roc: 0.7653 - val-ap: 0.8496 (0.1s/epoch)
Epoch  845/1500:Epoch loss: 0.1895 - avg acc: 79.4% - val-roc: 0.7653 - val-ap: 0.8503 (0.1s/epoch)
Epoch  846/1500:Epoch loss: 0.1926 - avg acc: 77.9% - val-roc: 0.7704 - val-ap: 0.8519 (0.1s/epoch)
Epoch  847/1500:Epoch loss: 0.1984 - avg acc: 77.9% - val-roc: 0.7806 - val-ap: 0.8516 (0.1s/epoch)
Epoch  848/1500:Epoch loss: 0.1928 - avg acc: 74.8% - val-roc: 0.7857 - val-ap: 0.8574 (0.1s/epoch)
Epoch  849/1500:Epoch loss: 0.2020 - avg acc: 77.9% - val-roc: 0.8010 - val-ap: 0.8602 (0.1s/epoch)
Epoch  850/1500:Epoch loss: 0.1980 - avg acc: 78.6% - val-roc: 0.8214 - val-ap: 0.8683 (0.1s/epoch)
Epoch  851/1500:Epoch loss: 0.1939 - avg acc: 77.9% - val-roc: 0.7959 - val-ap: 0.8573 (0.1s/epoch)
Epoch  852/1500:Epoch loss: 0.1984 - avg acc: 78.6% - val-roc: 0.8061 - val-ap: 0.8633 (0.1s/epoch)
Epoch  853/1500:Epoch loss: 0.1942 - avg acc: 78.6% - val-roc: 0.8010 - val-ap: 0.8611 (0.1s/epoch)
Epoch  854/1500:Epoch loss: 0.1811 - avg acc: 78.6% - val-roc: 0.7959 - val-ap: 0.8597 (0.1s/epoch)
Epoch  855/1500:Epoch loss: 0.2035 - avg acc: 78.6% - val-roc: 0.7857 - val-ap: 0.8546 (0.1s/epoch)
Epoch  856/1500:Epoch loss: 0.1708 - avg acc: 78.6% - val-roc: 0.7908 - val-ap: 0.8551 (0.1s/epoch)
Epoch  857/1500:Epoch loss: 0.1873 - avg acc: 77.9% - val-roc: 0.7908 - val-ap: 0.8551 (0.1s/epoch)
Epoch  858/1500:Epoch loss: 0.1722 - avg acc: 77.9% - val-roc: 0.7908 - val-ap: 0.8556 (0.1s/epoch)
Epoch  859/1500:Epoch loss: 0.2053 - avg acc: 80.9% - val-roc: 0.8061 - val-ap: 0.8666 (0.1s/epoch)
Epoch  860/1500:Epoch loss: 0.1792 - avg acc: 79.4% - val-roc: 0.7908 - val-ap: 0.8352 (0.1s/epoch)
Epoch  861/1500:Epoch loss: 0.1776 - avg acc: 71.8% - val-roc: 0.8061 - val-ap: 0.8653 (0.1s/epoch)
Epoch  862/1500:Epoch loss: 0.1752 - avg acc: 71.0% - val-roc: 0.8010 - val-ap: 0.8596 (0.1s/epoch)
Epoch  863/1500:Epoch loss: 0.1662 - avg acc: 71.0% - val-roc: 0.7959 - val-ap: 0.8571 (0.1s/epoch)
Epoch  864/1500:Epoch loss: 0.1815 - avg acc: 74.0% - val-roc: 0.7908 - val-ap: 0.8557 (0.1s/epoch)
Epoch  865/1500:Epoch loss: 0.1637 - avg acc: 76.3% - val-roc: 0.7806 - val-ap: 0.8520 (0.1s/epoch)
Epoch  866/1500:Epoch loss: 0.1744 - avg acc: 78.6% - val-roc: 0.7806 - val-ap: 0.8469 (0.1s/epoch)
Epoch  867/1500:Epoch loss: 0.1856 - avg acc: 77.9% - val-roc: 0.7806 - val-ap: 0.8520 (0.1s/epoch)
Epoch  868/1500:Epoch loss: 0.1984 - avg acc: 78.6% - val-roc: 0.7755 - val-ap: 0.8380 (0.1s/epoch)
Epoch  869/1500:Epoch loss: 0.1690 - avg acc: 77.9% - val-roc: 0.7908 - val-ap: 0.8385 (0.1s/epoch)
Epoch  870/1500:Epoch loss: 0.1888 - avg acc: 78.6% - val-roc: 0.8061 - val-ap: 0.8720 (0.1s/epoch)
Epoch  871/1500:Epoch loss: 0.2068 - avg acc: 73.3% - val-roc: 0.8010 - val-ap: 0.8760 (0.2s/epoch)
Epoch  872/1500:Epoch loss: 0.1725 - avg acc: 75.6% - val-roc: 0.8010 - val-ap: 0.8760 (0.1s/epoch)
Epoch  873/1500:Epoch loss: 0.1676 - avg acc: 72.5% - val-roc: 0.7908 - val-ap: 0.8630 (0.1s/epoch)
Epoch  874/1500:Epoch loss: 0.1758 - avg acc: 73.3% - val-roc: 0.8010 - val-ap: 0.8659 (0.1s/epoch)
Epoch  875/1500:Epoch loss: 0.1626 - avg acc: 78.6% - val-roc: 0.7704 - val-ap: 0.7953 (0.1s/epoch)
Epoch  876/1500:Epoch loss: 0.1860 - avg acc: 81.7% - val-roc: 0.7755 - val-ap: 0.8131 (0.1s/epoch)
Epoch  877/1500:Epoch loss: 0.1610 - avg acc: 79.4% - val-roc: 0.8163 - val-ap: 0.8735 (0.1s/epoch)
Epoch  878/1500:Epoch loss: 0.1830 - avg acc: 77.9% - val-roc: 0.8010 - val-ap: 0.8601 (0.1s/epoch)
Epoch  879/1500:Epoch loss: 0.1824 - avg acc: 77.1% - val-roc: 0.8112 - val-ap: 0.8772 (0.1s/epoch)
Epoch  880/1500:Epoch loss: 0.1524 - avg acc: 77.9% - val-roc: 0.8061 - val-ap: 0.8709 (0.1s/epoch)
Epoch  881/1500:Epoch loss: 0.1933 - avg acc: 78.6% - val-roc: 0.8469 - val-ap: 0.8840 (0.1s/epoch)
Epoch  882/1500:Epoch loss: 0.1890 - avg acc: 74.8% - val-roc: 0.8265 - val-ap: 0.8803 (0.1s/epoch)
Epoch  883/1500:Epoch loss: 0.1772 - avg acc: 77.1% - val-roc: 0.8520 - val-ap: 0.8891 (0.1s/epoch)
Epoch  884/1500:Epoch loss: 0.1910 - avg acc: 76.3% - val-roc: 0.8520 - val-ap: 0.8935 (0.1s/epoch)
Epoch  885/1500:Epoch loss: 0.1925 - avg acc: 77.9% - val-roc: 0.8520 - val-ap: 0.8842 (0.1s/epoch)
Epoch  886/1500:Epoch loss: 0.1729 - avg acc: 79.4% - val-roc: 0.8265 - val-ap: 0.8403 (0.1s/epoch)
Epoch  887/1500:Epoch loss: 0.1769 - avg acc: 73.3% - val-roc: 0.8724 - val-ap: 0.9052 (0.1s/epoch)
Epoch  888/1500:Epoch loss: 0.1896 - avg acc: 74.8% - val-roc: 0.8520 - val-ap: 0.8919 (0.1s/epoch)
Epoch  889/1500:Epoch loss: 0.2828 - avg acc: 80.2% - val-roc: 0.8418 - val-ap: 0.8881 (0.1s/epoch)
Epoch  890/1500:Epoch loss: 0.2119 - avg acc: 77.9% - val-roc: 0.8265 - val-ap: 0.8680 (0.1s/epoch)
Epoch  891/1500:Epoch loss: 0.1872 - avg acc: 77.9% - val-roc: 0.7908 - val-ap: 0.7795 (0.1s/epoch)
Epoch  892/1500:Epoch loss: 0.1738 - avg acc: 80.2% - val-roc: 0.7806 - val-ap: 0.7393 (0.1s/epoch)
Epoch  893/1500:Epoch loss: 0.1806 - avg acc: 80.9% - val-roc: 0.7908 - val-ap: 0.7778 (0.1s/epoch)
Epoch  894/1500:Epoch loss: 0.1824 - avg acc: 80.2% - val-roc: 0.7806 - val-ap: 0.7733 (0.1s/epoch)
Epoch  895/1500:Epoch loss: 0.1441 - avg acc: 79.4% - val-roc: 0.7755 - val-ap: 0.7368 (0.1s/epoch)
Epoch  896/1500:Epoch loss: 0.1718 - avg acc: 79.4% - val-roc: 0.7704 - val-ap: 0.7686 (0.1s/epoch)
Epoch  897/1500:Epoch loss: 0.1791 - avg acc: 80.2% - val-roc: 0.7704 - val-ap: 0.7693 (0.1s/epoch)
Epoch  898/1500:Epoch loss: 0.2000 - avg acc: 78.6% - val-roc: 0.7908 - val-ap: 0.7774 (0.1s/epoch)
Epoch  899/1500:Epoch loss: 0.1417 - avg acc: 78.6% - val-roc: 0.7704 - val-ap: 0.7682 (0.1s/epoch)
Epoch  900/1500:Epoch loss: 0.1498 - avg acc: 74.8% - val-roc: 0.7908 - val-ap: 0.8546 (0.1s/epoch)
Epoch  901/1500:Epoch loss: 0.1590 - avg acc: 75.6% - val-roc: 0.7806 - val-ap: 0.8432 (0.1s/epoch)
Epoch  902/1500:Epoch loss: 0.2277 - avg acc: 80.9% - val-roc: 0.7908 - val-ap: 0.8164 (0.1s/epoch)
Epoch  903/1500:Epoch loss: 0.1832 - avg acc: 73.3% - val-roc: 0.8316 - val-ap: 0.8832 (0.1s/epoch)
Epoch  904/1500:Epoch loss: 0.1698 - avg acc: 77.9% - val-roc: 0.8214 - val-ap: 0.8738 (0.1s/epoch)
Epoch  905/1500:Epoch loss: 0.1656 - avg acc: 70.2% - val-roc: 0.8367 - val-ap: 0.8921 (0.1s/epoch)
Epoch  906/1500:Epoch loss: 0.1797 - avg acc: 66.4% - val-roc: 0.8061 - val-ap: 0.8632 (0.1s/epoch)
Epoch  907/1500:Epoch loss: 0.1773 - avg acc: 58.8% - val-roc: 0.8112 - val-ap: 0.8557 (0.1s/epoch)
Epoch  908/1500:Epoch loss: 0.1714 - avg acc: 56.5% - val-roc: 0.8316 - val-ap: 0.9002 (0.1s/epoch)
Epoch  909/1500:Epoch loss: 0.1983 - avg acc: 57.3% - val-roc: 0.8010 - val-ap: 0.8596 (0.1s/epoch)
Epoch  910/1500:Epoch loss: 0.1710 - avg acc: 60.3% - val-roc: 0.7959 - val-ap: 0.8645 (0.1s/epoch)
Epoch  911/1500:Epoch loss: 0.1744 - avg acc: 67.9% - val-roc: 0.8112 - val-ap: 0.8686 (0.1s/epoch)
Epoch  912/1500:Epoch loss: 0.1682 - avg acc: 70.2% - val-roc: 0.7908 - val-ap: 0.8319 (0.1s/epoch)
Epoch  913/1500:Epoch loss: 0.1879 - avg acc: 69.5% - val-roc: 0.7806 - val-ap: 0.8281 (0.1s/epoch)
Epoch  914/1500:Epoch loss: 0.1638 - avg acc: 50.4% - val-roc: 0.8163 - val-ap: 0.8841 (0.1s/epoch)
Epoch  915/1500:Epoch loss: 0.1648 - avg acc: 71.8% - val-roc: 0.8214 - val-ap: 0.8912 (0.1s/epoch)
Epoch  916/1500:Epoch loss: 0.1580 - avg acc: 72.5% - val-roc: 0.8163 - val-ap: 0.8910 (0.1s/epoch)
Epoch  917/1500:Epoch loss: 0.1611 - avg acc: 75.6% - val-roc: 0.7959 - val-ap: 0.8684 (0.1s/epoch)
Epoch  918/1500:Epoch loss: 0.1652 - avg acc: 75.6% - val-roc: 0.7551 - val-ap: 0.7737 (0.1s/epoch)
Epoch  919/1500:Epoch loss: 0.1584 - avg acc: 71.0% - val-roc: 0.7704 - val-ap: 0.8023 (0.1s/epoch)
Epoch  920/1500:Epoch loss: 0.1645 - avg acc: 74.0% - val-roc: 0.7653 - val-ap: 0.7998 (0.1s/epoch)
Epoch  921/1500:Epoch loss: 0.1450 - avg acc: 76.3% - val-roc: 0.7449 - val-ap: 0.7360 (0.1s/epoch)
Epoch  922/1500:Epoch loss: 0.1519 - avg acc: 74.8% - val-roc: 0.7551 - val-ap: 0.7434 (0.1s/epoch)
Epoch  923/1500:Epoch loss: 0.1456 - avg acc: 77.1% - val-roc: 0.7500 - val-ap: 0.7380 (0.1s/epoch)
Epoch  924/1500:Epoch loss: 0.1429 - avg acc: 74.8% - val-roc: 0.7755 - val-ap: 0.7471 (0.1s/epoch)
Epoch  925/1500:Epoch loss: 0.1527 - avg acc: 71.8% - val-roc: 0.7653 - val-ap: 0.7430 (0.1s/epoch)
Epoch  926/1500:Epoch loss: 0.1522 - avg acc: 75.6% - val-roc: 0.7704 - val-ap: 0.7412 (0.1s/epoch)
Epoch  927/1500:Epoch loss: 0.1640 - avg acc: 73.3% - val-roc: 0.7806 - val-ap: 0.7447 (0.1s/epoch)
Epoch  928/1500:Epoch loss: 0.1503 - avg acc: 64.1% - val-roc: 0.8163 - val-ap: 0.8690 (0.1s/epoch)
Epoch  929/1500:Epoch loss: 0.1382 - avg acc: 74.0% - val-roc: 0.7908 - val-ap: 0.8651 (0.1s/epoch)
Epoch  930/1500:Epoch loss: 0.1280 - avg acc: 73.3% - val-roc: 0.7755 - val-ap: 0.8201 (0.1s/epoch)
Epoch  931/1500:Epoch loss: 0.1454 - avg acc: 71.8% - val-roc: 0.8010 - val-ap: 0.8583 (0.1s/epoch)
Epoch  932/1500:Epoch loss: 0.1290 - avg acc: 78.6% - val-roc: 0.7704 - val-ap: 0.8324 (0.1s/epoch)
Epoch  933/1500:Epoch loss: 0.1467 - avg acc: 77.1% - val-roc: 0.7551 - val-ap: 0.7704 (0.1s/epoch)
Epoch  934/1500:Epoch loss: 0.1397 - avg acc: 78.6% - val-roc: 0.7551 - val-ap: 0.8196 (0.1s/epoch)
Epoch  935/1500:Epoch loss: 0.1457 - avg acc: 79.4% - val-roc: 0.7500 - val-ap: 0.7350 (0.1s/epoch)
Epoch  936/1500:Epoch loss: 0.1427 - avg acc: 79.4% - val-roc: 0.8010 - val-ap: 0.8683 (0.1s/epoch)
Epoch  937/1500:Epoch loss: 0.1432 - avg acc: 76.3% - val-roc: 0.7806 - val-ap: 0.8405 (0.1s/epoch)
Epoch  938/1500:Epoch loss: 0.1273 - avg acc: 75.6% - val-roc: 0.8061 - val-ap: 0.8788 (0.1s/epoch)
Epoch  939/1500:Epoch loss: 0.1480 - avg acc: 73.3% - val-roc: 0.8367 - val-ap: 0.8886 (0.1s/epoch)
Epoch  940/1500:Epoch loss: 0.1533 - avg acc: 75.6% - val-roc: 0.8214 - val-ap: 0.8848 (0.1s/epoch)
Epoch  941/1500:Epoch loss: 0.1558 - avg acc: 77.9% - val-roc: 0.8520 - val-ap: 0.8983 (0.1s/epoch)
Epoch  942/1500:Epoch loss: 0.1340 - avg acc: 79.4% - val-roc: 0.8724 - val-ap: 0.9100 (0.1s/epoch)
Epoch  943/1500:Epoch loss: 0.1480 - avg acc: 79.4% - val-roc: 0.8724 - val-ap: 0.9100 (0.1s/epoch)
Epoch  944/1500:Epoch loss: 0.1706 - avg acc: 74.8% - val-roc: 0.8827 - val-ap: 0.9177 (0.1s/epoch)
Epoch  945/1500:Epoch loss: 0.1438 - avg acc: 77.1% - val-roc: 0.8724 - val-ap: 0.9047 (0.1s/epoch)
Epoch  946/1500:Epoch loss: 0.1367 - avg acc: 77.9% - val-roc: 0.8776 - val-ap: 0.9048 (0.1s/epoch)
Epoch  947/1500:Epoch loss: 0.2059 - avg acc: 74.8% - val-roc: 0.8673 - val-ap: 0.9050 (0.1s/epoch)
Epoch  948/1500:Epoch loss: 0.1490 - avg acc: 68.7% - val-roc: 0.8724 - val-ap: 0.9121 (0.1s/epoch)
Epoch  949/1500:Epoch loss: 0.1648 - avg acc: 68.7% - val-roc: 0.8776 - val-ap: 0.9144 (0.1s/epoch)
Epoch  950/1500:Epoch loss: 0.1607 - avg acc: 74.8% - val-roc: 0.8724 - val-ap: 0.9057 (0.1s/epoch)
Epoch  951/1500:Epoch loss: 0.1528 - avg acc: 77.1% - val-roc: 0.8724 - val-ap: 0.9057 (0.1s/epoch)
Epoch  952/1500:Epoch loss: 0.1421 - avg acc: 77.1% - val-roc: 0.8724 - val-ap: 0.9057 (0.1s/epoch)
Epoch  953/1500:Epoch loss: 0.1612 - avg acc: 78.6% - val-roc: 0.8673 - val-ap: 0.8944 (0.1s/epoch)
Epoch  954/1500:Epoch loss: 0.1704 - avg acc: 70.2% - val-roc: 0.8980 - val-ap: 0.9227 (0.1s/epoch)
Epoch  955/1500:Epoch loss: 0.1550 - avg acc: 75.6% - val-roc: 0.8980 - val-ap: 0.9284 (0.1s/epoch)
Epoch  956/1500:Epoch loss: 0.1386 - avg acc: 74.8% - val-roc: 0.8929 - val-ap: 0.9271 (0.1s/epoch)
Epoch  957/1500:Epoch loss: 0.2367 - avg acc: 74.0% - val-roc: 0.9082 - val-ap: 0.9324 (0.1s/epoch)
Epoch  958/1500:Epoch loss: 0.1503 - avg acc: 74.8% - val-roc: 0.8878 - val-ap: 0.9109 (0.1s/epoch)
Epoch  959/1500:Epoch loss: 0.1702 - avg acc: 77.1% - val-roc: 0.8878 - val-ap: 0.9109 (0.1s/epoch)
Epoch  960/1500:Epoch loss: 0.2040 - avg acc: 77.9% - val-roc: 0.8878 - val-ap: 0.9109 (0.1s/epoch)
Epoch  961/1500:Epoch loss: 0.1418 - avg acc: 79.4% - val-roc: 0.8827 - val-ap: 0.9068 (0.1s/epoch)
Epoch  962/1500:Epoch loss: 0.1477 - avg acc: 76.3% - val-roc: 0.8929 - val-ap: 0.9204 (0.1s/epoch)
Epoch  963/1500:Epoch loss: 0.1505 - avg acc: 77.9% - val-roc: 0.8827 - val-ap: 0.9133 (0.1s/epoch)
Epoch  964/1500:Epoch loss: 0.1477 - avg acc: 80.2% - val-roc: 0.8929 - val-ap: 0.9204 (0.1s/epoch)
Epoch  965/1500:Epoch loss: 0.1610 - avg acc: 79.4% - val-roc: 0.8673 - val-ap: 0.9044 (0.1s/epoch)
Epoch  966/1500:Epoch loss: 0.1509 - avg acc: 84.0% - val-roc: 0.8827 - val-ap: 0.9171 (0.1s/epoch)
Epoch  967/1500:Epoch loss: 0.1285 - avg acc: 86.3% - val-roc: 0.8827 - val-ap: 0.9171 (0.1s/epoch)
Epoch  968/1500:Epoch loss: 0.1829 - avg acc: 81.7% - val-roc: 0.8878 - val-ap: 0.9219 (0.1s/epoch)
Epoch  969/1500:Epoch loss: 0.1824 - avg acc: 78.6% - val-roc: 0.8878 - val-ap: 0.9205 (0.1s/epoch)
Epoch  970/1500:Epoch loss: 0.1424 - avg acc: 84.0% - val-roc: 0.8878 - val-ap: 0.9205 (0.1s/epoch)
Epoch  971/1500:Epoch loss: 0.1434 - avg acc: 79.4% - val-roc: 0.8724 - val-ap: 0.9075 (0.1s/epoch)
Epoch  972/1500:Epoch loss: 0.1577 - avg acc: 84.0% - val-roc: 0.8878 - val-ap: 0.9185 (0.1s/epoch)
Epoch  973/1500:Epoch loss: 0.1708 - avg acc: 80.2% - val-roc: 0.8776 - val-ap: 0.9106 (0.1s/epoch)
Epoch  974/1500:Epoch loss: 0.1281 - avg acc: 80.2% - val-roc: 0.8980 - val-ap: 0.9300 (0.1s/epoch)
Epoch  975/1500:Epoch loss: 0.1398 - avg acc: 83.2% - val-roc: 0.9031 - val-ap: 0.9341 (0.1s/epoch)
Epoch  976/1500:Epoch loss: 0.1709 - avg acc: 82.4% - val-roc: 0.9031 - val-ap: 0.9310 (0.1s/epoch)
Epoch  977/1500:Epoch loss: 0.1403 - avg acc: 82.4% - val-roc: 0.9082 - val-ap: 0.9349 (0.1s/epoch)
Epoch  978/1500:Epoch loss: 0.1356 - avg acc: 84.0% - val-roc: 0.9082 - val-ap: 0.9349 (0.1s/epoch)
Epoch  979/1500:Epoch loss: 0.1396 - avg acc: 84.7% - val-roc: 0.9031 - val-ap: 0.9277 (0.2s/epoch)
Epoch  980/1500:Epoch loss: 0.1442 - avg acc: 84.7% - val-roc: 0.8980 - val-ap: 0.9321 (0.1s/epoch)
Epoch  981/1500:Epoch loss: 0.1218 - avg acc: 84.0% - val-roc: 0.8878 - val-ap: 0.9114 (0.1s/epoch)
Epoch  982/1500:Epoch loss: 0.1649 - avg acc: 84.0% - val-roc: 0.8980 - val-ap: 0.9227 (0.2s/epoch)
Epoch  983/1500:Epoch loss: 0.1680 - avg acc: 83.2% - val-roc: 0.8878 - val-ap: 0.9217 (0.1s/epoch)
Epoch  984/1500:Epoch loss: 0.1339 - avg acc: 84.0% - val-roc: 0.8980 - val-ap: 0.9321 (0.1s/epoch)
Epoch  985/1500:Epoch loss: 0.1375 - avg acc: 84.7% - val-roc: 0.9184 - val-ap: 0.9461 (0.1s/epoch)
Epoch  986/1500:Epoch loss: 0.1542 - avg acc: 84.7% - val-roc: 0.9031 - val-ap: 0.9386 (0.1s/epoch)
Epoch  987/1500:Epoch loss: 0.1527 - avg acc: 82.4% - val-roc: 0.9082 - val-ap: 0.9349 (0.1s/epoch)
Epoch  988/1500:Epoch loss: 0.1514 - avg acc: 73.3% - val-roc: 0.9133 - val-ap: 0.9434 (0.1s/epoch)
Epoch  989/1500:Epoch loss: 0.1375 - avg acc: 77.9% - val-roc: 0.9082 - val-ap: 0.9375 (0.2s/epoch)
Epoch  990/1500:Epoch loss: 0.1327 - avg acc: 74.8% - val-roc: 0.9031 - val-ap: 0.9407 (0.1s/epoch)
Epoch  991/1500:Epoch loss: 0.1319 - avg acc: 79.4% - val-roc: 0.8929 - val-ap: 0.9282 (0.1s/epoch)
Epoch  992/1500:Epoch loss: 0.1424 - avg acc: 82.4% - val-roc: 0.8980 - val-ap: 0.9276 (0.1s/epoch)
Epoch  993/1500:Epoch loss: 0.1165 - avg acc: 82.4% - val-roc: 0.8929 - val-ap: 0.9225 (0.1s/epoch)
Epoch  994/1500:Epoch loss: 0.1247 - avg acc: 79.4% - val-roc: 0.8776 - val-ap: 0.9144 (0.1s/epoch)
Epoch  995/1500:Epoch loss: 0.1519 - avg acc: 82.4% - val-roc: 0.8724 - val-ap: 0.9103 (0.1s/epoch)
Epoch  996/1500:Epoch loss: 0.1363 - avg acc: 84.7% - val-roc: 0.8622 - val-ap: 0.8855 (0.2s/epoch)
Epoch  997/1500:Epoch loss: 0.1628 - avg acc: 84.0% - val-roc: 0.8571 - val-ap: 0.8929 (0.1s/epoch)
Epoch  998/1500:Epoch loss: 0.1368 - avg acc: 84.0% - val-roc: 0.8418 - val-ap: 0.8711 (0.1s/epoch)
Epoch  999/1500:Epoch loss: 0.1253 - avg acc: 80.9% - val-roc: 0.8418 - val-ap: 0.8796 (0.1s/epoch)
Epoch  1000/1500:Epoch loss: 0.1399 - avg acc: 82.4% - val-roc: 0.8469 - val-ap: 0.8664 (0.1s/epoch)
Epoch  1001/1500:Epoch loss: 0.1383 - avg acc: 84.0% - val-roc: 0.8163 - val-ap: 0.8155 (0.1s/epoch)
Epoch  1002/1500:Epoch loss: 0.1386 - avg acc: 83.2% - val-roc: 0.8367 - val-ap: 0.8339 (0.1s/epoch)
Epoch  1003/1500:Epoch loss: 0.1340 - avg acc: 82.4% - val-roc: 0.8571 - val-ap: 0.8688 (0.1s/epoch)
Epoch  1004/1500:Epoch loss: 0.1599 - avg acc: 83.2% - val-roc: 0.8571 - val-ap: 0.8688 (0.1s/epoch)
Epoch  1005/1500:Epoch loss: 0.1144 - avg acc: 81.7% - val-roc: 0.8520 - val-ap: 0.8545 (0.1s/epoch)
Epoch  1006/1500:Epoch loss: 0.1430 - avg acc: 82.4% - val-roc: 0.8418 - val-ap: 0.8606 (0.1s/epoch)
Epoch  1007/1500:Epoch loss: 0.1661 - avg acc: 83.2% - val-roc: 0.8520 - val-ap: 0.8673 (0.1s/epoch)
Epoch  1008/1500:Epoch loss: 0.1522 - avg acc: 83.2% - val-roc: 0.8520 - val-ap: 0.8545 (0.1s/epoch)
Epoch  1009/1500:Epoch loss: 0.1705 - avg acc: 83.2% - val-roc: 0.8673 - val-ap: 0.8955 (0.1s/epoch)
Epoch  1010/1500:Epoch loss: 0.1559 - avg acc: 83.2% - val-roc: 0.8520 - val-ap: 0.8722 (0.1s/epoch)
Epoch  1011/1500:Epoch loss: 0.1221 - avg acc: 81.7% - val-roc: 0.8418 - val-ap: 0.8460 (0.1s/epoch)
Epoch  1012/1500:Epoch loss: 0.1530 - avg acc: 82.4% - val-roc: 0.8316 - val-ap: 0.8232 (0.1s/epoch)
Epoch  1013/1500:Epoch loss: 0.1340 - avg acc: 82.4% - val-roc: 0.8418 - val-ap: 0.8553 (0.1s/epoch)
Epoch  1014/1500:Epoch loss: 0.1599 - avg acc: 83.2% - val-roc: 0.8265 - val-ap: 0.7993 (0.1s/epoch)
Epoch  1015/1500:Epoch loss: 0.1360 - avg acc: 82.4% - val-roc: 0.8214 - val-ap: 0.7636 (0.1s/epoch)
Epoch  1016/1500:Epoch loss: 0.1345 - avg acc: 80.9% - val-roc: 0.8214 - val-ap: 0.7636 (0.1s/epoch)
Epoch  1017/1500:Epoch loss: 0.1559 - avg acc: 82.4% - val-roc: 0.8316 - val-ap: 0.8232 (0.1s/epoch)
Epoch  1018/1500:Epoch loss: 0.1342 - avg acc: 84.7% - val-roc: 0.8163 - val-ap: 0.7578 (0.1s/epoch)
Epoch  1019/1500:Epoch loss: 0.1541 - avg acc: 84.0% - val-roc: 0.8214 - val-ap: 0.7593 (0.1s/epoch)
Epoch  1020/1500:Epoch loss: 0.1925 - avg acc: 86.3% - val-roc: 0.8214 - val-ap: 0.7615 (0.1s/epoch)
Epoch  1021/1500:Epoch loss: 0.1159 - avg acc: 84.7% - val-roc: 0.8163 - val-ap: 0.7578 (0.1s/epoch)
Epoch  1022/1500:Epoch loss: 0.1403 - avg acc: 86.3% - val-roc: 0.8112 - val-ap: 0.7484 (0.1s/epoch)
Epoch  1023/1500:Epoch loss: 0.1298 - avg acc: 85.5% - val-roc: 0.8367 - val-ap: 0.8485 (0.1s/epoch)
Epoch  1024/1500:Epoch loss: 0.1314 - avg acc: 84.0% - val-roc: 0.8163 - val-ap: 0.8211 (0.1s/epoch)
Epoch  1025/1500:Epoch loss: 0.1457 - avg acc: 84.0% - val-roc: 0.8163 - val-ap: 0.8244 (0.1s/epoch)
Epoch  1026/1500:Epoch loss: 0.1207 - avg acc: 83.2% - val-roc: 0.8112 - val-ap: 0.8211 (0.1s/epoch)
Epoch  1027/1500:Epoch loss: 0.1418 - avg acc: 83.2% - val-roc: 0.8265 - val-ap: 0.8306 (0.2s/epoch)
Epoch  1028/1500:Epoch loss: 0.1224 - avg acc: 82.4% - val-roc: 0.8214 - val-ap: 0.8331 (0.1s/epoch)
Epoch  1029/1500:Epoch loss: 0.1495 - avg acc: 81.7% - val-roc: 0.8316 - val-ap: 0.8420 (0.1s/epoch)
Epoch  1030/1500:Epoch loss: 0.1796 - avg acc: 82.4% - val-roc: 0.8265 - val-ap: 0.8383 (0.1s/epoch)
Epoch  1031/1500:Epoch loss: 0.1277 - avg acc: 82.4% - val-roc: 0.8571 - val-ap: 0.8828 (0.1s/epoch)
Epoch  1032/1500:Epoch loss: 0.1158 - avg acc: 82.4% - val-roc: 0.8418 - val-ap: 0.8553 (0.1s/epoch)
Epoch  1033/1500:Epoch loss: 0.1287 - avg acc: 81.7% - val-roc: 0.8418 - val-ap: 0.8487 (0.2s/epoch)
Epoch  1034/1500:Epoch loss: 0.1374 - avg acc: 82.4% - val-roc: 0.8622 - val-ap: 0.8866 (0.2s/epoch)
Epoch  1035/1500:Epoch loss: 0.1499 - avg acc: 83.2% - val-roc: 0.8827 - val-ap: 0.9171 (0.1s/epoch)
Epoch  1036/1500:Epoch loss: 0.1295 - avg acc: 82.4% - val-roc: 0.8827 - val-ap: 0.9171 (0.1s/epoch)
Epoch  1037/1500:Epoch loss: 0.1340 - avg acc: 83.2% - val-roc: 0.8776 - val-ap: 0.9133 (0.1s/epoch)
Epoch  1038/1500:Epoch loss: 0.1438 - avg acc: 84.7% - val-roc: 0.8827 - val-ap: 0.9171 (0.1s/epoch)
Epoch  1039/1500:Epoch loss: 0.1505 - avg acc: 84.7% - val-roc: 0.8776 - val-ap: 0.9186 (0.1s/epoch)
Epoch  1040/1500:Epoch loss: 0.2847 - avg acc: 84.0% - val-roc: 0.8776 - val-ap: 0.9133 (0.1s/epoch)
Epoch  1041/1500:Epoch loss: 0.1482 - avg acc: 83.2% - val-roc: 0.8622 - val-ap: 0.8943 (0.1s/epoch)
Epoch  1042/1500:Epoch loss: 0.1222 - avg acc: 82.4% - val-roc: 0.8673 - val-ap: 0.8955 (0.1s/epoch)
Epoch  1043/1500:Epoch loss: 0.1373 - avg acc: 83.2% - val-roc: 0.8776 - val-ap: 0.9106 (0.1s/epoch)
Epoch  1044/1500:Epoch loss: 0.1339 - avg acc: 81.7% - val-roc: 0.8724 - val-ap: 0.9052 (0.1s/epoch)
Epoch  1045/1500:Epoch loss: 0.1280 - avg acc: 81.7% - val-roc: 0.8520 - val-ap: 0.8873 (0.1s/epoch)
Epoch  1046/1500:Epoch loss: 0.1450 - avg acc: 83.2% - val-roc: 0.8367 - val-ap: 0.8074 (0.1s/epoch)
Epoch  1047/1500:Epoch loss: 0.2073 - avg acc: 80.2% - val-roc: 0.8520 - val-ap: 0.8634 (0.1s/epoch)
Epoch  1048/1500:Epoch loss: 0.1817 - avg acc: 80.9% - val-roc: 0.8520 - val-ap: 0.8634 (0.1s/epoch)
Epoch  1049/1500:Epoch loss: 0.1741 - avg acc: 81.7% - val-roc: 0.8316 - val-ap: 0.8066 (0.1s/epoch)
Epoch  1050/1500:Epoch loss: 0.1162 - avg acc: 79.4% - val-roc: 0.8316 - val-ap: 0.8066 (0.1s/epoch)
Epoch  1051/1500:Epoch loss: 0.1645 - avg acc: 77.1% - val-roc: 0.8520 - val-ap: 0.8745 (0.1s/epoch)
Epoch  1052/1500:Epoch loss: 0.1492 - avg acc: 65.6% - val-roc: 0.8469 - val-ap: 0.8925 (0.1s/epoch)
Epoch  1053/1500:Epoch loss: 0.1205 - avg acc: 65.6% - val-roc: 0.8367 - val-ap: 0.8627 (0.1s/epoch)
Epoch  1054/1500:Epoch loss: 0.1346 - avg acc: 73.3% - val-roc: 0.8316 - val-ap: 0.8386 (0.1s/epoch)
Epoch  1055/1500:Epoch loss: 0.1214 - avg acc: 78.6% - val-roc: 0.8316 - val-ap: 0.8250 (0.1s/epoch)
Epoch  1056/1500:Epoch loss: 0.1344 - avg acc: 73.3% - val-roc: 0.8367 - val-ap: 0.8429 (0.1s/epoch)
Epoch  1057/1500:Epoch loss: 0.1387 - avg acc: 77.9% - val-roc: 0.8418 - val-ap: 0.8471 (0.1s/epoch)
Epoch  1058/1500:Epoch loss: 0.1254 - avg acc: 81.7% - val-roc: 0.8571 - val-ap: 0.8688 (0.1s/epoch)
Epoch  1059/1500:Epoch loss: 0.1340 - avg acc: 73.3% - val-roc: 0.8418 - val-ap: 0.8560 (0.1s/epoch)
Epoch  1060/1500:Epoch loss: 0.1475 - avg acc: 80.9% - val-roc: 0.8316 - val-ap: 0.8055 (0.1s/epoch)
Epoch  1061/1500:Epoch loss: 0.1243 - avg acc: 81.7% - val-roc: 0.8418 - val-ap: 0.8323 (0.1s/epoch)
Epoch  1062/1500:Epoch loss: 0.1354 - avg acc: 83.2% - val-roc: 0.8418 - val-ap: 0.8128 (0.1s/epoch)
Epoch  1063/1500:Epoch loss: 0.1160 - avg acc: 84.0% - val-roc: 0.8367 - val-ap: 0.7771 (0.1s/epoch)
Epoch  1064/1500:Epoch loss: 0.1265 - avg acc: 84.0% - val-roc: 0.8316 - val-ap: 0.7757 (0.2s/epoch)
Epoch  1065/1500:Epoch loss: 0.1471 - avg acc: 81.7% - val-roc: 0.8367 - val-ap: 0.8074 (0.1s/epoch)
Epoch  1066/1500:Epoch loss: 0.1327 - avg acc: 83.2% - val-roc: 0.8418 - val-ap: 0.8110 (0.1s/epoch)
Epoch  1067/1500:Epoch loss: 0.1114 - avg acc: 80.2% - val-roc: 0.8214 - val-ap: 0.7595 (0.1s/epoch)
Epoch  1068/1500:Epoch loss: 0.1311 - avg acc: 83.2% - val-roc: 0.8163 - val-ap: 0.7573 (0.2s/epoch)
Epoch  1069/1500:Epoch loss: 0.1410 - avg acc: 84.7% - val-roc: 0.8163 - val-ap: 0.7526 (0.1s/epoch)
Epoch  1070/1500:Epoch loss: 0.1476 - avg acc: 85.5% - val-roc: 0.8418 - val-ap: 0.8092 (0.1s/epoch)
Epoch  1071/1500:Epoch loss: 0.1449 - avg acc: 85.5% - val-roc: 0.8214 - val-ap: 0.7614 (0.1s/epoch)
Epoch  1072/1500:Epoch loss: 0.1208 - avg acc: 84.7% - val-roc: 0.8163 - val-ap: 0.8303 (0.1s/epoch)
Epoch  1073/1500:Epoch loss: 0.1395 - avg acc: 81.7% - val-roc: 0.8367 - val-ap: 0.8427 (0.1s/epoch)
Epoch  1074/1500:Epoch loss: 0.1410 - avg acc: 82.4% - val-roc: 0.8520 - val-ap: 0.8682 (0.1s/epoch)
Epoch  1075/1500:Epoch loss: 0.1564 - avg acc: 80.9% - val-roc: 0.8367 - val-ap: 0.8523 (0.1s/epoch)
Epoch  1076/1500:Epoch loss: 0.1725 - avg acc: 83.2% - val-roc: 0.8520 - val-ap: 0.8731 (0.1s/epoch)
Epoch  1077/1500:Epoch loss: 0.1783 - avg acc: 84.7% - val-roc: 0.8878 - val-ap: 0.9156 (0.1s/epoch)
Epoch  1078/1500:Epoch loss: 0.1252 - avg acc: 83.2% - val-roc: 0.8776 - val-ap: 0.8861 (0.1s/epoch)
Epoch  1079/1500:Epoch loss: 0.1151 - avg acc: 81.7% - val-roc: 0.8571 - val-ap: 0.8969 (0.1s/epoch)
Epoch  1080/1500:Epoch loss: 0.1288 - avg acc: 80.9% - val-roc: 0.8571 - val-ap: 0.8953 (0.1s/epoch)
Epoch  1081/1500:Epoch loss: 0.1307 - avg acc: 81.7% - val-roc: 0.8469 - val-ap: 0.8619 (0.1s/epoch)
Epoch  1082/1500:Epoch loss: 0.1211 - avg acc: 80.9% - val-roc: 0.8520 - val-ap: 0.8591 (0.1s/epoch)
Epoch  1083/1500:Epoch loss: 0.1313 - avg acc: 82.4% - val-roc: 0.8214 - val-ap: 0.8277 (0.1s/epoch)
Epoch  1084/1500:Epoch loss: 0.1382 - avg acc: 82.4% - val-roc: 0.8163 - val-ap: 0.8267 (0.1s/epoch)
Epoch  1085/1500:Epoch loss: 0.1285 - avg acc: 80.2% - val-roc: 0.8469 - val-ap: 0.8680 (0.1s/epoch)
Epoch  1086/1500:Epoch loss: 0.1350 - avg acc: 80.9% - val-roc: 0.8367 - val-ap: 0.7735 (0.1s/epoch)
Epoch  1087/1500:Epoch loss: 0.1161 - avg acc: 82.4% - val-roc: 0.8316 - val-ap: 0.7646 (0.1s/epoch)
Epoch  1088/1500:Epoch loss: 0.1142 - avg acc: 84.0% - val-roc: 0.8367 - val-ap: 0.7771 (0.1s/epoch)
Epoch  1089/1500:Epoch loss: 0.1193 - avg acc: 84.0% - val-roc: 0.8316 - val-ap: 0.7717 (0.1s/epoch)
Epoch  1090/1500:Epoch loss: 0.1315 - avg acc: 85.5% - val-roc: 0.8265 - val-ap: 0.7610 (0.1s/epoch)
Epoch  1091/1500:Epoch loss: 0.1369 - avg acc: 85.5% - val-roc: 0.8163 - val-ap: 0.7464 (0.1s/epoch)
Epoch  1092/1500:Epoch loss: 0.1298 - avg acc: 85.5% - val-roc: 0.8214 - val-ap: 0.7822 (0.1s/epoch)
Epoch  1093/1500:Epoch loss: 0.1948 - avg acc: 85.5% - val-roc: 0.8776 - val-ap: 0.8995 (0.1s/epoch)
Epoch  1094/1500:Epoch loss: 0.1217 - avg acc: 84.7% - val-roc: 0.8673 - val-ap: 0.8822 (0.2s/epoch)
Epoch  1095/1500:Epoch loss: 0.1373 - avg acc: 84.7% - val-roc: 0.8571 - val-ap: 0.8764 (0.1s/epoch)
Epoch  1096/1500:Epoch loss: 0.1379 - avg acc: 80.9% - val-roc: 0.8163 - val-ap: 0.7863 (0.1s/epoch)
Epoch  1097/1500:Epoch loss: 0.1187 - avg acc: 80.9% - val-roc: 0.8163 - val-ap: 0.7863 (0.1s/epoch)
Epoch  1098/1500:Epoch loss: 0.1535 - avg acc: 80.9% - val-roc: 0.8010 - val-ap: 0.7717 (0.1s/epoch)
Epoch  1099/1500:Epoch loss: 0.1417 - avg acc: 80.2% - val-roc: 0.7959 - val-ap: 0.7381 (0.1s/epoch)
Epoch  1100/1500:Epoch loss: 0.1811 - avg acc: 81.7% - val-roc: 0.7959 - val-ap: 0.7390 (0.1s/epoch)
Epoch  1101/1500:Epoch loss: 0.1335 - avg acc: 82.4% - val-roc: 0.7908 - val-ap: 0.7259 (0.1s/epoch)
Epoch  1102/1500:Epoch loss: 0.1200 - avg acc: 83.2% - val-roc: 0.7806 - val-ap: 0.7174 (0.1s/epoch)
Epoch  1103/1500:Epoch loss: 0.1163 - avg acc: 84.0% - val-roc: 0.7806 - val-ap: 0.7174 (0.1s/epoch)
Epoch  1104/1500:Epoch loss: 0.1319 - avg acc: 83.2% - val-roc: 0.7908 - val-ap: 0.7265 (0.1s/epoch)
Epoch  1105/1500:Epoch loss: 0.1301 - avg acc: 84.0% - val-roc: 0.7857 - val-ap: 0.7229 (0.1s/epoch)
Epoch  1106/1500:Epoch loss: 0.1195 - avg acc: 84.0% - val-roc: 0.7908 - val-ap: 0.7265 (0.1s/epoch)
Epoch  1107/1500:Epoch loss: 0.1311 - avg acc: 80.9% - val-roc: 0.7755 - val-ap: 0.7088 (0.1s/epoch)
Epoch  1108/1500:Epoch loss: 0.1225 - avg acc: 82.4% - val-roc: 0.7755 - val-ap: 0.7114 (0.1s/epoch)
Epoch  1109/1500:Epoch loss: 0.1280 - avg acc: 82.4% - val-roc: 0.7857 - val-ap: 0.7180 (0.1s/epoch)
Epoch  1110/1500:Epoch loss: 0.1271 - avg acc: 84.0% - val-roc: 0.7704 - val-ap: 0.7077 (0.1s/epoch)
Epoch  1111/1500:Epoch loss: 0.1262 - avg acc: 85.5% - val-roc: 0.8112 - val-ap: 0.8200 (0.1s/epoch)
Epoch  1112/1500:Epoch loss: 0.1200 - avg acc: 85.5% - val-roc: 0.8367 - val-ap: 0.8550 (0.1s/epoch)
Epoch  1113/1500:Epoch loss: 0.1462 - avg acc: 83.2% - val-roc: 0.8469 - val-ap: 0.8631 (0.1s/epoch)
Epoch  1114/1500:Epoch loss: 0.1358 - avg acc: 82.4% - val-roc: 0.8316 - val-ap: 0.8272 (0.1s/epoch)
Epoch  1115/1500:Epoch loss: 0.1171 - avg acc: 84.0% - val-roc: 0.8265 - val-ap: 0.8093 (0.1s/epoch)
Epoch  1116/1500:Epoch loss: 0.1264 - avg acc: 82.4% - val-roc: 0.8112 - val-ap: 0.7971 (0.1s/epoch)
Epoch  1117/1500:Epoch loss: 0.1164 - avg acc: 84.0% - val-roc: 0.8214 - val-ap: 0.7795 (0.1s/epoch)
Epoch  1118/1500:Epoch loss: 0.1418 - avg acc: 83.2% - val-roc: 0.8367 - val-ap: 0.8153 (0.1s/epoch)
Epoch  1119/1500:Epoch loss: 0.1206 - avg acc: 86.3% - val-roc: 0.8418 - val-ap: 0.8398 (0.1s/epoch)
Epoch  1120/1500:Epoch loss: 0.1107 - avg acc: 86.3% - val-roc: 0.8520 - val-ap: 0.8593 (0.1s/epoch)
Epoch  1121/1500:Epoch loss: 0.1210 - avg acc: 85.5% - val-roc: 0.8622 - val-ap: 0.8784 (0.1s/epoch)
Epoch  1122/1500:Epoch loss: 0.1167 - avg acc: 84.7% - val-roc: 0.8520 - val-ap: 0.8612 (0.1s/epoch)
Epoch  1123/1500:Epoch loss: 0.1192 - avg acc: 85.5% - val-roc: 0.8520 - val-ap: 0.8646 (0.1s/epoch)
Epoch  1124/1500:Epoch loss: 0.1429 - avg acc: 87.8% - val-roc: 0.8520 - val-ap: 0.8646 (0.1s/epoch)
Epoch  1125/1500:Epoch loss: 0.1254 - avg acc: 85.5% - val-roc: 0.8367 - val-ap: 0.8485 (0.2s/epoch)
Epoch  1126/1500:Epoch loss: 0.1360 - avg acc: 83.2% - val-roc: 0.8316 - val-ap: 0.8504 (0.1s/epoch)
Epoch  1127/1500:Epoch loss: 0.1151 - avg acc: 81.7% - val-roc: 0.8418 - val-ap: 0.8605 (0.1s/epoch)
Epoch  1128/1500:Epoch loss: 0.1134 - avg acc: 83.2% - val-roc: 0.8571 - val-ap: 0.8842 (0.1s/epoch)
Epoch  1129/1500:Epoch loss: 0.1307 - avg acc: 87.0% - val-roc: 0.8776 - val-ap: 0.8977 (0.1s/epoch)
Epoch  1130/1500:Epoch loss: 0.1169 - avg acc: 84.0% - val-roc: 0.8776 - val-ap: 0.9067 (0.1s/epoch)
Epoch  1131/1500:Epoch loss: 0.1169 - avg acc: 84.0% - val-roc: 0.8776 - val-ap: 0.9067 (0.1s/epoch)
Epoch  1132/1500:Epoch loss: 0.1392 - avg acc: 83.2% - val-roc: 0.8724 - val-ap: 0.9021 (0.1s/epoch)
Epoch  1133/1500:Epoch loss: 0.1348 - avg acc: 81.7% - val-roc: 0.8827 - val-ap: 0.9110 (0.1s/epoch)
Epoch  1134/1500:Epoch loss: 0.1294 - avg acc: 81.7% - val-roc: 0.8929 - val-ap: 0.9200 (0.1s/epoch)
Epoch  1135/1500:Epoch loss: 0.1067 - avg acc: 84.0% - val-roc: 0.8827 - val-ap: 0.9093 (0.1s/epoch)
Epoch  1136/1500:Epoch loss: 0.1236 - avg acc: 84.0% - val-roc: 0.8622 - val-ap: 0.8829 (0.1s/epoch)
Epoch  1137/1500:Epoch loss: 0.1507 - avg acc: 85.5% - val-roc: 0.8724 - val-ap: 0.8879 (0.1s/epoch)
Epoch  1138/1500:Epoch loss: 0.1175 - avg acc: 85.5% - val-roc: 0.8622 - val-ap: 0.8758 (0.1s/epoch)
Epoch  1139/1500:Epoch loss: 0.1167 - avg acc: 86.3% - val-roc: 0.8571 - val-ap: 0.8655 (0.1s/epoch)
Epoch  1140/1500:Epoch loss: 0.1286 - avg acc: 86.3% - val-roc: 0.8112 - val-ap: 0.7499 (0.1s/epoch)
Epoch  1141/1500:Epoch loss: 0.1318 - avg acc: 86.3% - val-roc: 0.8265 - val-ap: 0.7652 (0.1s/epoch)
Epoch  1142/1500:Epoch loss: 0.1293 - avg acc: 87.0% - val-roc: 0.8265 - val-ap: 0.7623 (0.1s/epoch)
Epoch  1143/1500:Epoch loss: 0.1449 - avg acc: 85.5% - val-roc: 0.8520 - val-ap: 0.8194 (0.1s/epoch)
Epoch  1144/1500:Epoch loss: 0.1309 - avg acc: 85.5% - val-roc: 0.8316 - val-ap: 0.8000 (0.1s/epoch)
Epoch  1145/1500:Epoch loss: 0.1323 - avg acc: 86.3% - val-roc: 0.8520 - val-ap: 0.8564 (0.2s/epoch)
Epoch  1146/1500:Epoch loss: 0.1102 - avg acc: 86.3% - val-roc: 0.8469 - val-ap: 0.8606 (0.1s/epoch)
Epoch  1147/1500:Epoch loss: 0.1340 - avg acc: 86.3% - val-roc: 0.8622 - val-ap: 0.8798 (0.1s/epoch)
Epoch  1148/1500:Epoch loss: 0.1363 - avg acc: 87.0% - val-roc: 0.8724 - val-ap: 0.8887 (0.1s/epoch)
Epoch  1149/1500:Epoch loss: 0.2544 - avg acc: 86.3% - val-roc: 0.8163 - val-ap: 0.8212 (0.1s/epoch)
Epoch  1150/1500:Epoch loss: 0.0964 - avg acc: 86.3% - val-roc: 0.8214 - val-ap: 0.8272 (0.1s/epoch)
Epoch  1151/1500:Epoch loss: 0.1162 - avg acc: 84.7% - val-roc: 0.8520 - val-ap: 0.8679 (0.1s/epoch)
Epoch  1152/1500:Epoch loss: 0.1349 - avg acc: 84.7% - val-roc: 0.8112 - val-ap: 0.8195 (0.1s/epoch)
Epoch  1153/1500:Epoch loss: 0.1195 - avg acc: 84.7% - val-roc: 0.8316 - val-ap: 0.8472 (0.2s/epoch)
Epoch  1154/1500:Epoch loss: 0.1385 - avg acc: 85.5% - val-roc: 0.8571 - val-ap: 0.8748 (0.1s/epoch)
Epoch  1155/1500:Epoch loss: 0.1273 - avg acc: 87.0% - val-roc: 0.8673 - val-ap: 0.8854 (0.1s/epoch)
Epoch  1156/1500:Epoch loss: 0.1209 - avg acc: 87.0% - val-roc: 0.8622 - val-ap: 0.8768 (0.1s/epoch)
Epoch  1157/1500:Epoch loss: 0.1086 - avg acc: 84.7% - val-roc: 0.8316 - val-ap: 0.8296 (0.1s/epoch)
Epoch  1158/1500:Epoch loss: 0.1001 - avg acc: 82.4% - val-roc: 0.8469 - val-ap: 0.8527 (0.1s/epoch)
Epoch  1159/1500:Epoch loss: 0.1165 - avg acc: 84.7% - val-roc: 0.8673 - val-ap: 0.8808 (0.1s/epoch)
Epoch  1160/1500:Epoch loss: 0.1800 - avg acc: 86.3% - val-roc: 0.8673 - val-ap: 0.8595 (0.1s/epoch)
Epoch  1161/1500:Epoch loss: 0.1082 - avg acc: 86.3% - val-roc: 0.8724 - val-ap: 0.8645 (0.1s/epoch)
Epoch  1162/1500:Epoch loss: 0.1242 - avg acc: 86.3% - val-roc: 0.8827 - val-ap: 0.8915 (0.1s/epoch)
Epoch  1163/1500:Epoch loss: 0.1096 - avg acc: 87.0% - val-roc: 0.8776 - val-ap: 0.8885 (0.1s/epoch)
Epoch  1164/1500:Epoch loss: 0.1368 - avg acc: 79.4% - val-roc: 0.8673 - val-ap: 0.8804 (0.1s/epoch)
Epoch  1165/1500:Epoch loss: 0.2544 - avg acc: 83.2% - val-roc: 0.8827 - val-ap: 0.9036 (0.1s/epoch)
Epoch  1166/1500:Epoch loss: 0.1211 - avg acc: 82.4% - val-roc: 0.8776 - val-ap: 0.8947 (0.1s/epoch)
Epoch  1167/1500:Epoch loss: 0.1123 - avg acc: 84.0% - val-roc: 0.8673 - val-ap: 0.8804 (0.1s/epoch)
Epoch  1168/1500:Epoch loss: 0.1232 - avg acc: 86.3% - val-roc: 0.8827 - val-ap: 0.9110 (0.1s/epoch)
Epoch  1169/1500:Epoch loss: 0.0976 - avg acc: 86.3% - val-roc: 0.8827 - val-ap: 0.9110 (0.1s/epoch)
Epoch  1170/1500:Epoch loss: 0.1319 - avg acc: 86.3% - val-roc: 0.8673 - val-ap: 0.8804 (0.1s/epoch)
Epoch  1171/1500:Epoch loss: 0.1425 - avg acc: 88.5% - val-roc: 0.8571 - val-ap: 0.8715 (0.1s/epoch)
Epoch  1172/1500:Epoch loss: 0.1329 - avg acc: 84.0% - val-roc: 0.8163 - val-ap: 0.8005 (0.1s/epoch)
Epoch  1173/1500:Epoch loss: 0.1552 - avg acc: 84.7% - val-roc: 0.8163 - val-ap: 0.7796 (0.1s/epoch)
Epoch  1174/1500:Epoch loss: 0.1488 - avg acc: 77.9% - val-roc: 0.8673 - val-ap: 0.8804 (0.1s/epoch)
Epoch  1175/1500:Epoch loss: 0.1349 - avg acc: 76.3% - val-roc: 0.7908 - val-ap: 0.8141 (0.1s/epoch)
Epoch  1176/1500:Epoch loss: 0.1352 - avg acc: 79.4% - val-roc: 0.8418 - val-ap: 0.8458 (0.1s/epoch)
Epoch  1177/1500:Epoch loss: 0.1217 - avg acc: 80.9% - val-roc: 0.7908 - val-ap: 0.8306 (0.1s/epoch)
Epoch  1178/1500:Epoch loss: 0.1264 - avg acc: 80.2% - val-roc: 0.8112 - val-ap: 0.8301 (0.1s/epoch)
Epoch  1179/1500:Epoch loss: 0.1377 - avg acc: 79.4% - val-roc: 0.8520 - val-ap: 0.8699 (0.1s/epoch)
Epoch  1180/1500:Epoch loss: 0.1183 - avg acc: 75.6% - val-roc: 0.8520 - val-ap: 0.8509 (0.1s/epoch)
Epoch  1181/1500:Epoch loss: 0.1103 - avg acc: 77.9% - val-roc: 0.8469 - val-ap: 0.8519 (0.1s/epoch)
Epoch  1182/1500:Epoch loss: 0.1166 - avg acc: 78.6% - val-roc: 0.8571 - val-ap: 0.8740 (0.1s/epoch)
Epoch  1183/1500:Epoch loss: 0.1246 - avg acc: 80.2% - val-roc: 0.8571 - val-ap: 0.8653 (0.2s/epoch)
Epoch  1184/1500:Epoch loss: 0.1075 - avg acc: 82.4% - val-roc: 0.8622 - val-ap: 0.8670 (0.1s/epoch)
Epoch  1185/1500:Epoch loss: 0.0939 - avg acc: 87.0% - val-roc: 0.8827 - val-ap: 0.8963 (0.1s/epoch)
Epoch  1186/1500:Epoch loss: 0.1360 - avg acc: 86.3% - val-roc: 0.8827 - val-ap: 0.8963 (0.1s/epoch)
Epoch  1187/1500:Epoch loss: 0.1188 - avg acc: 84.0% - val-roc: 0.8622 - val-ap: 0.8893 (0.1s/epoch)
Epoch  1188/1500:Epoch loss: 0.1695 - avg acc: 77.1% - val-roc: 0.8827 - val-ap: 0.8977 (0.1s/epoch)
Epoch  1189/1500:Epoch loss: 0.1082 - avg acc: 77.9% - val-roc: 0.8724 - val-ap: 0.8867 (0.1s/epoch)
Epoch  1190/1500:Epoch loss: 0.1083 - avg acc: 77.1% - val-roc: 0.8776 - val-ap: 0.8875 (0.1s/epoch)
Epoch  1191/1500:Epoch loss: 0.0960 - avg acc: 79.4% - val-roc: 0.8776 - val-ap: 0.8875 (0.1s/epoch)
Epoch  1192/1500:Epoch loss: 0.0965 - avg acc: 71.0% - val-roc: 0.8571 - val-ap: 0.8612 (0.1s/epoch)
Epoch  1193/1500:Epoch loss: 0.1001 - avg acc: 65.6% - val-roc: 0.8367 - val-ap: 0.8266 (0.1s/epoch)
Epoch  1194/1500:Epoch loss: 0.1321 - avg acc: 75.6% - val-roc: 0.8418 - val-ap: 0.8518 (0.1s/epoch)
Epoch  1195/1500:Epoch loss: 0.1339 - avg acc: 83.2% - val-roc: 0.8214 - val-ap: 0.8343 (0.1s/epoch)
Epoch  1196/1500:Epoch loss: 0.0956 - avg acc: 79.4% - val-roc: 0.8418 - val-ap: 0.8592 (0.1s/epoch)
Epoch  1197/1500:Epoch loss: 0.1118 - avg acc: 83.2% - val-roc: 0.8214 - val-ap: 0.8412 (0.1s/epoch)
Epoch  1198/1500:Epoch loss: 0.1224 - avg acc: 82.4% - val-roc: 0.8265 - val-ap: 0.8511 (0.1s/epoch)
Epoch  1199/1500:Epoch loss: 0.0950 - avg acc: 84.0% - val-roc: 0.8418 - val-ap: 0.8564 (0.1s/epoch)
Epoch  1200/1500:Epoch loss: 0.1542 - avg acc: 81.7% - val-roc: 0.8827 - val-ap: 0.8814 (0.1s/epoch)
Epoch  1201/1500:Epoch loss: 0.1127 - avg acc: 77.9% - val-roc: 0.8010 - val-ap: 0.7415 (0.1s/epoch)
Epoch  1202/1500:Epoch loss: 0.1435 - avg acc: 77.9% - val-roc: 0.8010 - val-ap: 0.7378 (0.1s/epoch)
Epoch  1203/1500:Epoch loss: 0.1297 - avg acc: 80.9% - val-roc: 0.8010 - val-ap: 0.7378 (0.1s/epoch)
Epoch  1204/1500:Epoch loss: 0.1459 - avg acc: 82.4% - val-roc: 0.8214 - val-ap: 0.7669 (0.2s/epoch)
Epoch  1205/1500:Epoch loss: 0.1385 - avg acc: 83.2% - val-roc: 0.8214 - val-ap: 0.7669 (0.1s/epoch)
Epoch  1206/1500:Epoch loss: 0.1217 - avg acc: 78.6% - val-roc: 0.8112 - val-ap: 0.7516 (0.1s/epoch)
Epoch  1207/1500:Epoch loss: 0.1193 - avg acc: 81.7% - val-roc: 0.8061 - val-ap: 0.7467 (0.2s/epoch)
Epoch  1208/1500:Epoch loss: 0.1215 - avg acc: 78.6% - val-roc: 0.8010 - val-ap: 0.7199 (0.1s/epoch)
Epoch  1209/1500:Epoch loss: 0.1408 - avg acc: 81.7% - val-roc: 0.8214 - val-ap: 0.7813 (0.1s/epoch)
Epoch  1210/1500:Epoch loss: 0.1179 - avg acc: 81.7% - val-roc: 0.8163 - val-ap: 0.7761 (0.1s/epoch)
Epoch  1211/1500:Epoch loss: 0.0983 - avg acc: 87.0% - val-roc: 0.8061 - val-ap: 0.7327 (0.1s/epoch)
Epoch  1212/1500:Epoch loss: 0.1180 - avg acc: 84.7% - val-roc: 0.8061 - val-ap: 0.7327 (0.1s/epoch)
Epoch  1213/1500:Epoch loss: 0.1056 - avg acc: 84.0% - val-roc: 0.8010 - val-ap: 0.7165 (0.1s/epoch)
Epoch  1214/1500:Epoch loss: 0.1017 - avg acc: 87.0% - val-roc: 0.7857 - val-ap: 0.6921 (0.1s/epoch)
Epoch  1215/1500:Epoch loss: 0.1042 - avg acc: 79.4% - val-roc: 0.7857 - val-ap: 0.7075 (0.2s/epoch)
Epoch  1216/1500:Epoch loss: 0.1061 - avg acc: 73.3% - val-roc: 0.7959 - val-ap: 0.7124 (0.1s/epoch)
Epoch  1217/1500:Epoch loss: 0.1082 - avg acc: 81.7% - val-roc: 0.7704 - val-ap: 0.6729 (0.2s/epoch)
Epoch  1218/1500:Epoch loss: 0.1126 - avg acc: 83.2% - val-roc: 0.7806 - val-ap: 0.6764 (0.1s/epoch)
Epoch  1219/1500:Epoch loss: 0.0850 - avg acc: 80.2% - val-roc: 0.7704 - val-ap: 0.6833 (0.1s/epoch)
Epoch  1220/1500:Epoch loss: 0.1191 - avg acc: 84.7% - val-roc: 0.7653 - val-ap: 0.6774 (0.1s/epoch)
Epoch  1221/1500:Epoch loss: 0.1358 - avg acc: 84.0% - val-roc: 0.7857 - val-ap: 0.7155 (0.2s/epoch)
Epoch  1222/1500:Epoch loss: 0.1032 - avg acc: 86.3% - val-roc: 0.7806 - val-ap: 0.7047 (0.1s/epoch)
Epoch  1223/1500:Epoch loss: 0.1019 - avg acc: 89.3% - val-roc: 0.7755 - val-ap: 0.7031 (0.1s/epoch)
Epoch  1224/1500:Epoch loss: 0.1207 - avg acc: 85.5% - val-roc: 0.7755 - val-ap: 0.7031 (0.1s/epoch)
Epoch  1225/1500:Epoch loss: 0.1068 - avg acc: 86.3% - val-roc: 0.7755 - val-ap: 0.7031 (0.1s/epoch)
Epoch  1226/1500:Epoch loss: 0.1317 - avg acc: 89.3% - val-roc: 0.7857 - val-ap: 0.7063 (0.1s/epoch)
Epoch  1227/1500:Epoch loss: 0.1112 - avg acc: 85.5% - val-roc: 0.7857 - val-ap: 0.7063 (0.1s/epoch)
Epoch  1228/1500:Epoch loss: 0.1089 - avg acc: 77.1% - val-roc: 0.7755 - val-ap: 0.7031 (0.1s/epoch)
Epoch  1229/1500:Epoch loss: 0.0950 - avg acc: 84.0% - val-roc: 0.7755 - val-ap: 0.7000 (0.1s/epoch)
Epoch  1230/1500:Epoch loss: 0.1116 - avg acc: 87.8% - val-roc: 0.7806 - val-ap: 0.7095 (0.1s/epoch)
Epoch  1231/1500:Epoch loss: 0.0991 - avg acc: 77.9% - val-roc: 0.7806 - val-ap: 0.7357 (0.1s/epoch)
Epoch  1232/1500:Epoch loss: 0.1307 - avg acc: 79.4% - val-roc: 0.7908 - val-ap: 0.7432 (0.1s/epoch)
Epoch  1233/1500:Epoch loss: 0.1404 - avg acc: 84.0% - val-roc: 0.7908 - val-ap: 0.7170 (0.1s/epoch)
Epoch  1234/1500:Epoch loss: 0.1243 - avg acc: 82.4% - val-roc: 0.8010 - val-ap: 0.7331 (0.1s/epoch)
Epoch  1235/1500:Epoch loss: 0.1273 - avg acc: 87.0% - val-roc: 0.8061 - val-ap: 0.7362 (0.1s/epoch)
Epoch  1236/1500:Epoch loss: 0.1019 - avg acc: 87.0% - val-roc: 0.8112 - val-ap: 0.7411 (0.1s/epoch)
Epoch  1237/1500:Epoch loss: 0.1118 - avg acc: 89.3% - val-roc: 0.8112 - val-ap: 0.7683 (0.1s/epoch)
Epoch  1238/1500:Epoch loss: 0.1108 - avg acc: 89.3% - val-roc: 0.8112 - val-ap: 0.7720 (0.2s/epoch)
Epoch  1239/1500:Epoch loss: 0.1189 - avg acc: 84.7% - val-roc: 0.7959 - val-ap: 0.7295 (0.1s/epoch)
Epoch  1240/1500:Epoch loss: 0.0989 - avg acc: 85.5% - val-roc: 0.7755 - val-ap: 0.6889 (0.1s/epoch)
Epoch  1241/1500:Epoch loss: 0.1120 - avg acc: 87.0% - val-roc: 0.7704 - val-ap: 0.6833 (0.1s/epoch)
Epoch  1242/1500:Epoch loss: 0.1144 - avg acc: 80.9% - val-roc: 0.7755 - val-ap: 0.6889 (0.1s/epoch)
Epoch  1243/1500:Epoch loss: 0.0909 - avg acc: 83.2% - val-roc: 0.8163 - val-ap: 0.8172 (0.1s/epoch)
Epoch  1244/1500:Epoch loss: 0.1127 - avg acc: 79.4% - val-roc: 0.8673 - val-ap: 0.8873 (0.1s/epoch)
Epoch  1245/1500:Epoch loss: 0.1539 - avg acc: 83.2% - val-roc: 0.8673 - val-ap: 0.8884 (0.1s/epoch)
Epoch  1246/1500:Epoch loss: 0.1240 - avg acc: 85.5% - val-roc: 0.8520 - val-ap: 0.8671 (0.1s/epoch)
Epoch  1247/1500:Epoch loss: 0.0949 - avg acc: 87.8% - val-roc: 0.8571 - val-ap: 0.8753 (0.1s/epoch)
Epoch  1248/1500:Epoch loss: 0.0929 - avg acc: 88.5% - val-roc: 0.8469 - val-ap: 0.8684 (0.1s/epoch)
Epoch  1249/1500:Epoch loss: 0.0809 - avg acc: 85.5% - val-roc: 0.8622 - val-ap: 0.8830 (0.1s/epoch)
Epoch  1250/1500:Epoch loss: 0.1276 - avg acc: 84.0% - val-roc: 0.8316 - val-ap: 0.8320 (0.1s/epoch)
Epoch  1251/1500:Epoch loss: 0.0913 - avg acc: 87.0% - val-roc: 0.8316 - val-ap: 0.8469 (0.1s/epoch)
Epoch  1252/1500:Epoch loss: 0.0984 - avg acc: 85.5% - val-roc: 0.8571 - val-ap: 0.8688 (0.1s/epoch)
Epoch  1253/1500:Epoch loss: 0.0965 - avg acc: 87.8% - val-roc: 0.8418 - val-ap: 0.8523 (0.1s/epoch)
Epoch  1254/1500:Epoch loss: 0.1238 - avg acc: 85.5% - val-roc: 0.8622 - val-ap: 0.8755 (0.1s/epoch)
Epoch  1255/1500:Epoch loss: 0.0913 - avg acc: 83.2% - val-roc: 0.8520 - val-ap: 0.8534 (0.1s/epoch)
Epoch  1256/1500:Epoch loss: 0.1060 - avg acc: 80.9% - val-roc: 0.8469 - val-ap: 0.8467 (0.1s/epoch)
Epoch  1257/1500:Epoch loss: 0.1087 - avg acc: 77.1% - val-roc: 0.8673 - val-ap: 0.8762 (0.1s/epoch)
Epoch  1258/1500:Epoch loss: 0.0874 - avg acc: 80.9% - val-roc: 0.8316 - val-ap: 0.8152 (0.1s/epoch)
Epoch  1259/1500:Epoch loss: 0.0977 - avg acc: 82.4% - val-roc: 0.8214 - val-ap: 0.7893 (0.1s/epoch)
Epoch  1260/1500:Epoch loss: 0.1153 - avg acc: 83.2% - val-roc: 0.8214 - val-ap: 0.7893 (0.1s/epoch)
Epoch  1261/1500:Epoch loss: 0.1188 - avg acc: 87.0% - val-roc: 0.8316 - val-ap: 0.7978 (0.1s/epoch)
Epoch  1262/1500:Epoch loss: 0.1016 - avg acc: 82.4% - val-roc: 0.8112 - val-ap: 0.7778 (0.1s/epoch)
Epoch  1263/1500:Epoch loss: 0.0787 - avg acc: 84.0% - val-roc: 0.8316 - val-ap: 0.8261 (0.2s/epoch)
Epoch  1264/1500:Epoch loss: 0.1162 - avg acc: 81.7% - val-roc: 0.8163 - val-ap: 0.7796 (0.1s/epoch)
Epoch  1265/1500:Epoch loss: 0.1142 - avg acc: 84.0% - val-roc: 0.8112 - val-ap: 0.7439 (0.1s/epoch)
Epoch  1266/1500:Epoch loss: 0.0871 - avg acc: 86.3% - val-roc: 0.7755 - val-ap: 0.6952 (0.1s/epoch)
Epoch  1267/1500:Epoch loss: 0.1028 - avg acc: 84.7% - val-roc: 0.7908 - val-ap: 0.7075 (0.1s/epoch)
Epoch  1268/1500:Epoch loss: 0.1040 - avg acc: 77.9% - val-roc: 0.7806 - val-ap: 0.6959 (0.1s/epoch)
Epoch  1269/1500:Epoch loss: 0.1073 - avg acc: 81.7% - val-roc: 0.7806 - val-ap: 0.6959 (0.1s/epoch)
Epoch  1270/1500:Epoch loss: 0.0806 - avg acc: 86.3% - val-roc: 0.7755 - val-ap: 0.6977 (0.1s/epoch)
Epoch  1271/1500:Epoch loss: 0.1011 - avg acc: 88.5% - val-roc: 0.7653 - val-ap: 0.6803 (0.1s/epoch)
Epoch  1272/1500:Epoch loss: 0.1157 - avg acc: 86.3% - val-roc: 0.7755 - val-ap: 0.6848 (0.1s/epoch)
Epoch  1273/1500:Epoch loss: 0.1238 - avg acc: 87.0% - val-roc: 0.7755 - val-ap: 0.6889 (0.1s/epoch)
Epoch  1274/1500:Epoch loss: 0.0839 - avg acc: 86.3% - val-roc: 0.7755 - val-ap: 0.6889 (0.1s/epoch)
Epoch  1275/1500:Epoch loss: 0.1005 - avg acc: 87.8% - val-roc: 0.7755 - val-ap: 0.6889 (0.1s/epoch)
Epoch  1276/1500:Epoch loss: 0.1217 - avg acc: 89.3% - val-roc: 0.8316 - val-ap: 0.7931 (0.1s/epoch)
Epoch  1277/1500:Epoch loss: 0.1042 - avg acc: 89.3% - val-roc: 0.8776 - val-ap: 0.8989 (0.1s/epoch)
Epoch  1278/1500:Epoch loss: 0.1048 - avg acc: 87.8% - val-roc: 0.9031 - val-ap: 0.9257 (0.1s/epoch)
Epoch  1279/1500:Epoch loss: 0.0932 - avg acc: 83.2% - val-roc: 0.8878 - val-ap: 0.9073 (0.1s/epoch)
Epoch  1280/1500:Epoch loss: 0.1108 - avg acc: 85.5% - val-roc: 0.8724 - val-ap: 0.8888 (0.1s/epoch)
Epoch  1281/1500:Epoch loss: 0.1067 - avg acc: 88.5% - val-roc: 0.8418 - val-ap: 0.8594 (0.1s/epoch)
Epoch  1282/1500:Epoch loss: 0.0912 - avg acc: 90.1% - val-roc: 0.8214 - val-ap: 0.7866 (0.1s/epoch)
Epoch  1283/1500:Epoch loss: 0.1088 - avg acc: 89.3% - val-roc: 0.8265 - val-ap: 0.7914 (0.1s/epoch)
Epoch  1284/1500:Epoch loss: 0.1123 - avg acc: 88.5% - val-roc: 0.8163 - val-ap: 0.7488 (0.1s/epoch)
Epoch  1285/1500:Epoch loss: 0.0930 - avg acc: 88.5% - val-roc: 0.8214 - val-ap: 0.7504 (0.1s/epoch)
Epoch  1286/1500:Epoch loss: 0.1040 - avg acc: 88.5% - val-roc: 0.8265 - val-ap: 0.7861 (0.1s/epoch)
Epoch  1287/1500:Epoch loss: 0.0873 - avg acc: 90.1% - val-roc: 0.7959 - val-ap: 0.7432 (0.1s/epoch)
Epoch  1288/1500:Epoch loss: 0.1096 - avg acc: 89.3% - val-roc: 0.7908 - val-ap: 0.6973 (0.1s/epoch)
Epoch  1289/1500:Epoch loss: 0.0841 - avg acc: 84.7% - val-roc: 0.8010 - val-ap: 0.7481 (0.1s/epoch)
Epoch  1290/1500:Epoch loss: 0.0835 - avg acc: 87.0% - val-roc: 0.8061 - val-ap: 0.7616 (0.1s/epoch)
Epoch  1291/1500:Epoch loss: 0.1239 - avg acc: 87.0% - val-roc: 0.8878 - val-ap: 0.9073 (0.1s/epoch)
Epoch  1292/1500:Epoch loss: 0.0909 - avg acc: 89.3% - val-roc: 0.8878 - val-ap: 0.9115 (0.1s/epoch)
Epoch  1293/1500:Epoch loss: 0.1171 - avg acc: 89.3% - val-roc: 0.9133 - val-ap: 0.9372 (0.1s/epoch)
Epoch  1294/1500:Epoch loss: 0.1838 - avg acc: 81.7% - val-roc: 0.8980 - val-ap: 0.9241 (0.1s/epoch)
Epoch  1295/1500:Epoch loss: 0.1201 - avg acc: 80.2% - val-roc: 0.8469 - val-ap: 0.8989 (0.1s/epoch)
Epoch  1296/1500:Epoch loss: 0.1154 - avg acc: 84.7% - val-roc: 0.8673 - val-ap: 0.9082 (0.1s/epoch)
Epoch  1297/1500:Epoch loss: 0.1150 - avg acc: 87.8% - val-roc: 0.8622 - val-ap: 0.9017 (0.1s/epoch)
Epoch  1298/1500:Epoch loss: 0.1176 - avg acc: 86.3% - val-roc: 0.8418 - val-ap: 0.8814 (0.1s/epoch)
Epoch  1299/1500:Epoch loss: 0.1024 - avg acc: 83.2% - val-roc: 0.8367 - val-ap: 0.8735 (0.1s/epoch)
Epoch  1300/1500:Epoch loss: 0.1256 - avg acc: 84.0% - val-roc: 0.8010 - val-ap: 0.8480 (0.1s/epoch)
Epoch  1301/1500:Epoch loss: 0.0769 - avg acc: 87.0% - val-roc: 0.8367 - val-ap: 0.8616 (0.1s/epoch)
Epoch  1302/1500:Epoch loss: 0.0851 - avg acc: 86.3% - val-roc: 0.8316 - val-ap: 0.8514 (0.1s/epoch)
Epoch  1303/1500:Epoch loss: 0.1023 - avg acc: 84.7% - val-roc: 0.8163 - val-ap: 0.8363 (0.1s/epoch)
Epoch  1304/1500:Epoch loss: 0.2264 - avg acc: 84.0% - val-roc: 0.8367 - val-ap: 0.8486 (0.1s/epoch)
Epoch  1305/1500:Epoch loss: 0.0958 - avg acc: 88.5% - val-roc: 0.8316 - val-ap: 0.8363 (0.1s/epoch)
Epoch  1306/1500:Epoch loss: 0.1097 - avg acc: 90.1% - val-roc: 0.7959 - val-ap: 0.6948 (0.1s/epoch)
Epoch  1307/1500:Epoch loss: 0.1194 - avg acc: 88.5% - val-roc: 0.7908 - val-ap: 0.6902 (0.1s/epoch)
Epoch  1308/1500:Epoch loss: 0.0954 - avg acc: 87.0% - val-roc: 0.7857 - val-ap: 0.6867 (0.1s/epoch)
Epoch  1309/1500:Epoch loss: 0.1221 - avg acc: 87.8% - val-roc: 0.8010 - val-ap: 0.6991 (0.1s/epoch)
Epoch  1310/1500:Epoch loss: 0.1267 - avg acc: 87.0% - val-roc: 0.8010 - val-ap: 0.7015 (0.1s/epoch)
Epoch  1311/1500:Epoch loss: 0.1106 - avg acc: 90.1% - val-roc: 0.8010 - val-ap: 0.7015 (0.1s/epoch)
Epoch  1312/1500:Epoch loss: 0.1064 - avg acc: 89.3% - val-roc: 0.8010 - val-ap: 0.7015 (0.1s/epoch)
Epoch  1313/1500:Epoch loss: 0.1331 - avg acc: 87.0% - val-roc: 0.7959 - val-ap: 0.6975 (0.1s/epoch)
Epoch  1314/1500:Epoch loss: 0.1167 - avg acc: 87.8% - val-roc: 0.7857 - val-ap: 0.6896 (0.1s/epoch)
Epoch  1315/1500:Epoch loss: 0.1905 - avg acc: 90.1% - val-roc: 0.8010 - val-ap: 0.7015 (0.1s/epoch)
Epoch  1316/1500:Epoch loss: 0.1155 - avg acc: 88.5% - val-roc: 0.7959 - val-ap: 0.7268 (0.1s/epoch)
Epoch  1317/1500:Epoch loss: 0.1041 - avg acc: 86.3% - val-roc: 0.8316 - val-ap: 0.7967 (0.1s/epoch)
Epoch  1318/1500:Epoch loss: 0.0949 - avg acc: 87.0% - val-roc: 0.8469 - val-ap: 0.8106 (0.1s/epoch)
Epoch  1319/1500:Epoch loss: 0.1089 - avg acc: 88.5% - val-roc: 0.8469 - val-ap: 0.8117 (0.1s/epoch)
Epoch  1320/1500:Epoch loss: 0.0850 - avg acc: 88.5% - val-roc: 0.8316 - val-ap: 0.7980 (0.1s/epoch)
Epoch  1321/1500:Epoch loss: 0.1129 - avg acc: 87.8% - val-roc: 0.8316 - val-ap: 0.7995 (0.1s/epoch)
Epoch  1322/1500:Epoch loss: 0.1226 - avg acc: 88.5% - val-roc: 0.8265 - val-ap: 0.7949 (0.1s/epoch)
Epoch  1323/1500:Epoch loss: 0.1061 - avg acc: 88.5% - val-roc: 0.8214 - val-ap: 0.7554 (0.1s/epoch)
Epoch  1324/1500:Epoch loss: 0.1069 - avg acc: 87.0% - val-roc: 0.8112 - val-ap: 0.7459 (0.1s/epoch)
Epoch  1325/1500:Epoch loss: 0.1189 - avg acc: 89.3% - val-roc: 0.8112 - val-ap: 0.7408 (0.1s/epoch)
Epoch  1326/1500:Epoch loss: 0.1117 - avg acc: 85.5% - val-roc: 0.8010 - val-ap: 0.7356 (0.1s/epoch)
Epoch  1327/1500:Epoch loss: 0.1164 - avg acc: 84.7% - val-roc: 0.7857 - val-ap: 0.7069 (0.1s/epoch)
Epoch  1328/1500:Epoch loss: 0.1292 - avg acc: 88.5% - val-roc: 0.7806 - val-ap: 0.6865 (0.1s/epoch)
Epoch  1329/1500:Epoch loss: 0.0993 - avg acc: 89.3% - val-roc: 0.7959 - val-ap: 0.7031 (0.1s/epoch)
Epoch  1330/1500:Epoch loss: 0.1036 - avg acc: 88.5% - val-roc: 0.8112 - val-ap: 0.7353 (0.1s/epoch)
Epoch  1331/1500:Epoch loss: 0.1094 - avg acc: 88.5% - val-roc: 0.8010 - val-ap: 0.7212 (0.1s/epoch)
Epoch  1332/1500:Epoch loss: 0.0882 - avg acc: 87.8% - val-roc: 0.8214 - val-ap: 0.7795 (0.1s/epoch)
Epoch  1333/1500:Epoch loss: 0.1164 - avg acc: 86.3% - val-roc: 0.8469 - val-ap: 0.8550 (0.1s/epoch)
Epoch  1334/1500:Epoch loss: 0.1139 - avg acc: 88.5% - val-roc: 0.8163 - val-ap: 0.7749 (0.2s/epoch)
Epoch  1335/1500:Epoch loss: 0.1041 - avg acc: 88.5% - val-roc: 0.8214 - val-ap: 0.7987 (0.3s/epoch)
Epoch  1336/1500:Epoch loss: 0.0990 - avg acc: 88.5% - val-roc: 0.8163 - val-ap: 0.7950 (0.1s/epoch)
Epoch  1337/1500:Epoch loss: 0.1004 - avg acc: 89.3% - val-roc: 0.8316 - val-ap: 0.8309 (0.1s/epoch)
Epoch  1338/1500:Epoch loss: 0.1075 - avg acc: 89.3% - val-roc: 0.8061 - val-ap: 0.7343 (0.1s/epoch)
Epoch  1339/1500:Epoch loss: 0.0972 - avg acc: 89.3% - val-roc: 0.8010 - val-ap: 0.7212 (0.1s/epoch)
Epoch  1340/1500:Epoch loss: 0.1287 - avg acc: 89.3% - val-roc: 0.8061 - val-ap: 0.7307 (0.1s/epoch)
Epoch  1341/1500:Epoch loss: 0.1001 - avg acc: 88.5% - val-roc: 0.8112 - val-ap: 0.7701 (0.1s/epoch)
Epoch  1342/1500:Epoch loss: 0.0898 - avg acc: 89.3% - val-roc: 0.7959 - val-ap: 0.7004 (0.1s/epoch)
Epoch  1343/1500:Epoch loss: 0.0958 - avg acc: 89.3% - val-roc: 0.7959 - val-ap: 0.7312 (0.1s/epoch)
Epoch  1344/1500:Epoch loss: 0.1018 - avg acc: 89.3% - val-roc: 0.7959 - val-ap: 0.7004 (0.1s/epoch)
Epoch  1345/1500:Epoch loss: 0.0884 - avg acc: 89.3% - val-roc: 0.7959 - val-ap: 0.7312 (0.1s/epoch)
Epoch  1346/1500:Epoch loss: 0.1115 - avg acc: 89.3% - val-roc: 0.7908 - val-ap: 0.7294 (0.1s/epoch)
Epoch  1347/1500:Epoch loss: 0.0875 - avg acc: 89.3% - val-roc: 0.7908 - val-ap: 0.7294 (0.1s/epoch)
Epoch  1348/1500:Epoch loss: 0.1233 - avg acc: 89.3% - val-roc: 0.7857 - val-ap: 0.6937 (0.1s/epoch)
Epoch  1349/1500:Epoch loss: 0.0947 - avg acc: 88.5% - val-roc: 0.7857 - val-ap: 0.6937 (0.1s/epoch)
Epoch  1350/1500:Epoch loss: 0.0812 - avg acc: 88.5% - val-roc: 0.7908 - val-ap: 0.6912 (0.1s/epoch)
Epoch  1351/1500:Epoch loss: 0.0955 - avg acc: 88.5% - val-roc: 0.7908 - val-ap: 0.6912 (0.1s/epoch)
Epoch  1352/1500:Epoch loss: 0.1044 - avg acc: 88.5% - val-roc: 0.7857 - val-ap: 0.6867 (0.1s/epoch)
Epoch  1353/1500:Epoch loss: 0.0918 - avg acc: 88.5% - val-roc: 0.7806 - val-ap: 0.6850 (0.1s/epoch)
Epoch  1354/1500:Epoch loss: 0.0966 - avg acc: 88.5% - val-roc: 0.7806 - val-ap: 0.6932 (0.1s/epoch)
Epoch  1355/1500:Epoch loss: 0.0899 - avg acc: 89.3% - val-roc: 0.7806 - val-ap: 0.6900 (0.1s/epoch)
Epoch  1356/1500:Epoch loss: 0.0901 - avg acc: 89.3% - val-roc: 0.7806 - val-ap: 0.6900 (0.1s/epoch)
Epoch  1357/1500:Epoch loss: 0.1027 - avg acc: 89.3% - val-roc: 0.7908 - val-ap: 0.7294 (0.1s/epoch)
Epoch  1358/1500:Epoch loss: 0.1039 - avg acc: 89.3% - val-roc: 0.7755 - val-ap: 0.6883 (0.1s/epoch)
Epoch  1359/1500:Epoch loss: 0.0761 - avg acc: 88.5% - val-roc: 0.7602 - val-ap: 0.6793 (0.1s/epoch)
Epoch  1360/1500:Epoch loss: 0.0908 - avg acc: 90.1% - val-roc: 0.8010 - val-ap: 0.7039 (0.1s/epoch)
Epoch  1361/1500:Epoch loss: 0.0795 - avg acc: 89.3% - val-roc: 0.8469 - val-ap: 0.8083 (0.1s/epoch)
Epoch  1362/1500:Epoch loss: 0.0726 - avg acc: 89.3% - val-roc: 0.8316 - val-ap: 0.7807 (0.1s/epoch)
Epoch  1363/1500:Epoch loss: 0.0907 - avg acc: 90.1% - val-roc: 0.8061 - val-ap: 0.7110 (0.1s/epoch)
Epoch  1364/1500:Epoch loss: 0.0866 - avg acc: 90.1% - val-roc: 0.8061 - val-ap: 0.7110 (0.1s/epoch)
Epoch  1365/1500:Epoch loss: 0.0709 - avg acc: 90.1% - val-roc: 0.8163 - val-ap: 0.7169 (0.1s/epoch)
Epoch  1366/1500:Epoch loss: 0.1158 - avg acc: 90.1% - val-roc: 0.8010 - val-ap: 0.6966 (0.1s/epoch)
Epoch  1367/1500:Epoch loss: 0.0600 - avg acc: 90.8% - val-roc: 0.8112 - val-ap: 0.7050 (0.1s/epoch)
Epoch  1368/1500:Epoch loss: 0.0817 - avg acc: 90.1% - val-roc: 0.8010 - val-ap: 0.7015 (0.1s/epoch)
Epoch  1369/1500:Epoch loss: 0.0934 - avg acc: 90.1% - val-roc: 0.7908 - val-ap: 0.6902 (0.1s/epoch)
Epoch  1370/1500:Epoch loss: 0.0859 - avg acc: 90.1% - val-roc: 0.7908 - val-ap: 0.6902 (0.1s/epoch)
Epoch  1371/1500:Epoch loss: 0.0932 - avg acc: 90.8% - val-roc: 0.7959 - val-ap: 0.6948 (0.1s/epoch)
Epoch  1372/1500:Epoch loss: 0.0853 - avg acc: 90.8% - val-roc: 0.8010 - val-ap: 0.6982 (0.1s/epoch)
Epoch  1373/1500:Epoch loss: 0.0701 - avg acc: 90.8% - val-roc: 0.8010 - val-ap: 0.7067 (0.1s/epoch)
Epoch  1374/1500:Epoch loss: 0.0822 - avg acc: 90.8% - val-roc: 0.8112 - val-ap: 0.7144 (0.1s/epoch)
Epoch  1375/1500:Epoch loss: 0.0983 - avg acc: 90.1% - val-roc: 0.7959 - val-ap: 0.6948 (0.1s/epoch)
Epoch  1376/1500:Epoch loss: 0.1060 - avg acc: 89.3% - val-roc: 0.7857 - val-ap: 0.6989 (0.1s/epoch)
Epoch  1377/1500:Epoch loss: 0.1020 - avg acc: 90.1% - val-roc: 0.8316 - val-ap: 0.7988 (0.1s/epoch)
Epoch  1378/1500:Epoch loss: 0.1607 - avg acc: 90.1% - val-roc: 0.8622 - val-ap: 0.8660 (0.1s/epoch)
Epoch  1379/1500:Epoch loss: 0.0934 - avg acc: 90.1% - val-roc: 0.8622 - val-ap: 0.8667 (0.1s/epoch)
Epoch  1380/1500:Epoch loss: 0.1261 - avg acc: 90.1% - val-roc: 0.8673 - val-ap: 0.8726 (0.1s/epoch)
Epoch  1381/1500:Epoch loss: 0.1757 - avg acc: 88.5% - val-roc: 0.8367 - val-ap: 0.8327 (0.1s/epoch)
Epoch  1382/1500:Epoch loss: 0.1097 - avg acc: 87.0% - val-roc: 0.8214 - val-ap: 0.8342 (0.1s/epoch)
Epoch  1383/1500:Epoch loss: 0.1159 - avg acc: 88.5% - val-roc: 0.8061 - val-ap: 0.8134 (0.1s/epoch)
Epoch  1384/1500:Epoch loss: 0.1109 - avg acc: 90.8% - val-roc: 0.8061 - val-ap: 0.7807 (0.1s/epoch)
Epoch  1385/1500:Epoch loss: 0.1037 - avg acc: 87.8% - val-roc: 0.8010 - val-ap: 0.7220 (0.1s/epoch)
Epoch  1386/1500:Epoch loss: 0.1277 - avg acc: 88.5% - val-roc: 0.8265 - val-ap: 0.7534 (0.1s/epoch)
Epoch  1387/1500:Epoch loss: 0.0892 - avg acc: 88.5% - val-roc: 0.8469 - val-ap: 0.7747 (0.1s/epoch)
Epoch  1388/1500:Epoch loss: 0.0961 - avg acc: 89.3% - val-roc: 0.8571 - val-ap: 0.7832 (0.1s/epoch)
Epoch  1389/1500:Epoch loss: 0.0982 - avg acc: 90.1% - val-roc: 0.8571 - val-ap: 0.7814 (0.1s/epoch)
Epoch  1390/1500:Epoch loss: 0.1002 - avg acc: 89.3% - val-roc: 0.8622 - val-ap: 0.7844 (0.1s/epoch)
Epoch  1391/1500:Epoch loss: 0.1399 - avg acc: 90.1% - val-roc: 0.8571 - val-ap: 0.8107 (0.1s/epoch)
Epoch  1392/1500:Epoch loss: 0.0994 - avg acc: 88.5% - val-roc: 0.8724 - val-ap: 0.8255 (0.1s/epoch)
Epoch  1393/1500:Epoch loss: 0.1204 - avg acc: 88.5% - val-roc: 0.8673 - val-ap: 0.7913 (0.1s/epoch)
Epoch  1394/1500:Epoch loss: 0.0868 - avg acc: 90.1% - val-roc: 0.8673 - val-ap: 0.8244 (0.1s/epoch)
Epoch  1395/1500:Epoch loss: 0.1130 - avg acc: 90.1% - val-roc: 0.8571 - val-ap: 0.7833 (0.1s/epoch)
Epoch  1396/1500:Epoch loss: 0.0899 - avg acc: 90.1% - val-roc: 0.8673 - val-ap: 0.8212 (0.1s/epoch)
Epoch  1397/1500:Epoch loss: 0.0933 - avg acc: 88.5% - val-roc: 0.8776 - val-ap: 0.8480 (0.1s/epoch)
Epoch  1398/1500:Epoch loss: 0.1267 - avg acc: 90.1% - val-roc: 0.8724 - val-ap: 0.8439 (0.1s/epoch)
Epoch  1399/1500:Epoch loss: 0.0800 - avg acc: 87.8% - val-roc: 0.8163 - val-ap: 0.8461 (0.1s/epoch)
Epoch  1400/1500:Epoch loss: 0.1011 - avg acc: 87.8% - val-roc: 0.8571 - val-ap: 0.8704 (0.1s/epoch)
Epoch  1401/1500:Epoch loss: 0.1051 - avg acc: 87.0% - val-roc: 0.8622 - val-ap: 0.8762 (0.1s/epoch)
Epoch  1402/1500:Epoch loss: 0.1224 - avg acc: 87.0% - val-roc: 0.8673 - val-ap: 0.8873 (0.1s/epoch)
Epoch  1403/1500:Epoch loss: 0.0793 - avg acc: 87.0% - val-roc: 0.8622 - val-ap: 0.8815 (0.1s/epoch)
Epoch  1404/1500:Epoch loss: 0.0861 - avg acc: 87.8% - val-roc: 0.8367 - val-ap: 0.8572 (0.1s/epoch)
Epoch  1405/1500:Epoch loss: 0.0939 - avg acc: 87.8% - val-roc: 0.8214 - val-ap: 0.8411 (0.1s/epoch)
Epoch  1406/1500:Epoch loss: 0.0913 - avg acc: 89.3% - val-roc: 0.8214 - val-ap: 0.8076 (0.1s/epoch)
Epoch  1407/1500:Epoch loss: 0.0929 - avg acc: 88.5% - val-roc: 0.8418 - val-ap: 0.8278 (0.1s/epoch)
Epoch  1408/1500:Epoch loss: 0.1085 - avg acc: 90.8% - val-roc: 0.8571 - val-ap: 0.8376 (0.1s/epoch)
Epoch  1409/1500:Epoch loss: 0.0804 - avg acc: 89.3% - val-roc: 0.8520 - val-ap: 0.8322 (0.1s/epoch)
Epoch  1410/1500:Epoch loss: 0.1043 - avg acc: 89.3% - val-roc: 0.8469 - val-ap: 0.8457 (0.1s/epoch)
Epoch  1411/1500:Epoch loss: 0.0845 - avg acc: 90.1% - val-roc: 0.8265 - val-ap: 0.8131 (0.1s/epoch)
Epoch  1412/1500:Epoch loss: 0.1069 - avg acc: 90.1% - val-roc: 0.8469 - val-ap: 0.8311 (0.1s/epoch)
Epoch  1413/1500:Epoch loss: 0.0702 - avg acc: 89.3% - val-roc: 0.8571 - val-ap: 0.8379 (0.1s/epoch)
Epoch  1414/1500:Epoch loss: 0.1072 - avg acc: 89.3% - val-roc: 0.8673 - val-ap: 0.8584 (0.1s/epoch)
Epoch  1415/1500:Epoch loss: 0.0938 - avg acc: 89.3% - val-roc: 0.8724 - val-ap: 0.8615 (0.1s/epoch)
Epoch  1416/1500:Epoch loss: 0.1155 - avg acc: 90.1% - val-roc: 0.8520 - val-ap: 0.7787 (0.1s/epoch)
Epoch  1417/1500:Epoch loss: 0.0655 - avg acc: 90.1% - val-roc: 0.8418 - val-ap: 0.7709 (0.1s/epoch)
Epoch  1418/1500:Epoch loss: 0.1027 - avg acc: 90.1% - val-roc: 0.8673 - val-ap: 0.8439 (0.1s/epoch)
Epoch  1419/1500:Epoch loss: 0.0764 - avg acc: 90.8% - val-roc: 0.8520 - val-ap: 0.8142 (0.1s/epoch)
Epoch  1420/1500:Epoch loss: 0.0764 - avg acc: 90.8% - val-roc: 0.8520 - val-ap: 0.8142 (0.1s/epoch)
Epoch  1421/1500:Epoch loss: 0.0854 - avg acc: 90.8% - val-roc: 0.8673 - val-ap: 0.8452 (0.1s/epoch)
Epoch  1422/1500:Epoch loss: 0.1452 - avg acc: 90.1% - val-roc: 0.8571 - val-ap: 0.8362 (0.1s/epoch)
Epoch  1423/1500:Epoch loss: 0.0723 - avg acc: 89.3% - val-roc: 0.8622 - val-ap: 0.7898 (0.1s/epoch)
Epoch  1424/1500:Epoch loss: 0.0913 - avg acc: 88.5% - val-roc: 0.8571 - val-ap: 0.7872 (0.1s/epoch)
Epoch  1425/1500:Epoch loss: 0.0996 - avg acc: 88.5% - val-roc: 0.8520 - val-ap: 0.7821 (0.1s/epoch)
Epoch  1426/1500:Epoch loss: 0.0860 - avg acc: 90.1% - val-roc: 0.8520 - val-ap: 0.7853 (0.1s/epoch)
Epoch  1427/1500:Epoch loss: 0.0846 - avg acc: 89.3% - val-roc: 0.8520 - val-ap: 0.7839 (0.1s/epoch)
Epoch  1428/1500:Epoch loss: 0.0799 - avg acc: 89.3% - val-roc: 0.8571 - val-ap: 0.7880 (0.1s/epoch)
Epoch  1429/1500:Epoch loss: 0.0705 - avg acc: 89.3% - val-roc: 0.8673 - val-ap: 0.7977 (0.1s/epoch)
Epoch  1430/1500:Epoch loss: 0.0878 - avg acc: 90.1% - val-roc: 0.8622 - val-ap: 0.7930 (0.1s/epoch)
Epoch  1431/1500:Epoch loss: 0.1080 - avg acc: 90.1% - val-roc: 0.8622 - val-ap: 0.8237 (0.1s/epoch)
Epoch  1432/1500:Epoch loss: 0.0859 - avg acc: 90.1% - val-roc: 0.8571 - val-ap: 0.8183 (0.1s/epoch)
Epoch  1433/1500:Epoch loss: 0.0814 - avg acc: 90.1% - val-roc: 0.8673 - val-ap: 0.8439 (0.1s/epoch)
Epoch  1434/1500:Epoch loss: 0.1196 - avg acc: 90.8% - val-roc: 0.8673 - val-ap: 0.8439 (0.1s/epoch)
Epoch  1435/1500:Epoch loss: 0.1055 - avg acc: 90.1% - val-roc: 0.8673 - val-ap: 0.8559 (0.1s/epoch)
Epoch  1436/1500:Epoch loss: 0.0948 - avg acc: 90.1% - val-roc: 0.8776 - val-ap: 0.8760 (0.1s/epoch)
Epoch  1437/1500:Epoch loss: 0.1025 - avg acc: 90.1% - val-roc: 0.8929 - val-ap: 0.9084 (0.1s/epoch)
Epoch  1438/1500:Epoch loss: 0.0858 - avg acc: 90.1% - val-roc: 0.8980 - val-ap: 0.9163 (0.1s/epoch)
Epoch  1439/1500:Epoch loss: 0.0906 - avg acc: 90.1% - val-roc: 0.8724 - val-ap: 0.8865 (0.1s/epoch)
Epoch  1440/1500:Epoch loss: 0.0899 - avg acc: 90.1% - val-roc: 0.8776 - val-ap: 0.8859 (0.1s/epoch)
Epoch  1441/1500:Epoch loss: 0.0860 - avg acc: 90.1% - val-roc: 0.8827 - val-ap: 0.8902 (0.1s/epoch)
Epoch  1442/1500:Epoch loss: 0.0854 - avg acc: 90.1% - val-roc: 0.8980 - val-ap: 0.9090 (0.1s/epoch)
Epoch  1443/1500:Epoch loss: 0.0757 - avg acc: 90.1% - val-roc: 0.9082 - val-ap: 0.9241 (0.1s/epoch)
Epoch  1444/1500:Epoch loss: 0.0670 - avg acc: 90.8% - val-roc: 0.9031 - val-ap: 0.9221 (0.1s/epoch)
Epoch  1445/1500:Epoch loss: 0.0713 - avg acc: 90.8% - val-roc: 0.9082 - val-ap: 0.9276 (0.1s/epoch)
Epoch  1446/1500:Epoch loss: 0.1070 - avg acc: 90.8% - val-roc: 0.9133 - val-ap: 0.9326 (0.1s/epoch)
Epoch  1447/1500:Epoch loss: 0.0740 - avg acc: 90.8% - val-roc: 0.9133 - val-ap: 0.9355 (0.1s/epoch)
Epoch  1448/1500:Epoch loss: 0.1094 - avg acc: 91.6% - val-roc: 0.9184 - val-ap: 0.9420 (0.1s/epoch)
Epoch  1449/1500:Epoch loss: 0.0784 - avg acc: 90.8% - val-roc: 0.9184 - val-ap: 0.9420 (0.1s/epoch)
Epoch  1450/1500:Epoch loss: 0.0647 - avg acc: 90.8% - val-roc: 0.9082 - val-ap: 0.9332 (0.1s/epoch)
Epoch  1451/1500:Epoch loss: 0.0852 - avg acc: 90.8% - val-roc: 0.9184 - val-ap: 0.9420 (0.1s/epoch)
Epoch  1452/1500:Epoch loss: 0.0870 - avg acc: 91.6% - val-roc: 0.9184 - val-ap: 0.9420 (0.1s/epoch)
Epoch  1453/1500:Epoch loss: 0.0934 - avg acc: 90.8% - val-roc: 0.9184 - val-ap: 0.9420 (0.1s/epoch)
Epoch  1454/1500:Epoch loss: 0.0734 - avg acc: 90.8% - val-roc: 0.9133 - val-ap: 0.9340 (0.1s/epoch)
Epoch  1455/1500:Epoch loss: 0.0799 - avg acc: 90.8% - val-roc: 0.8980 - val-ap: 0.9203 (0.1s/epoch)
Epoch  1456/1500:Epoch loss: 0.1532 - avg acc: 91.6% - val-roc: 0.8980 - val-ap: 0.9241 (0.1s/epoch)
Epoch  1457/1500:Epoch loss: 0.0936 - avg acc: 91.6% - val-roc: 0.9184 - val-ap: 0.9391 (0.1s/epoch)
Epoch  1458/1500:Epoch loss: 0.0871 - avg acc: 90.8% - val-roc: 0.9082 - val-ap: 0.9314 (0.1s/epoch)
Epoch  1459/1500:Epoch loss: 0.1676 - avg acc: 89.3% - val-roc: 0.8929 - val-ap: 0.9239 (0.1s/epoch)
Epoch  1460/1500:Epoch loss: 0.0743 - avg acc: 89.3% - val-roc: 0.9031 - val-ap: 0.9296 (0.1s/epoch)
Epoch  1461/1500:Epoch loss: 0.0953 - avg acc: 89.3% - val-roc: 0.8980 - val-ap: 0.9251 (0.1s/epoch)
Epoch  1462/1500:Epoch loss: 0.0769 - avg acc: 90.1% - val-roc: 0.9082 - val-ap: 0.9322 (0.1s/epoch)
Epoch  1463/1500:Epoch loss: 0.0812 - avg acc: 89.3% - val-roc: 0.9082 - val-ap: 0.9322 (0.1s/epoch)
Epoch  1464/1500:Epoch loss: 0.0871 - avg acc: 89.3% - val-roc: 0.9031 - val-ap: 0.9257 (0.1s/epoch)
Epoch  1465/1500:Epoch loss: 0.0832 - avg acc: 90.1% - val-roc: 0.8929 - val-ap: 0.9137 (0.1s/epoch)
Epoch  1466/1500:Epoch loss: 0.0794 - avg acc: 85.5% - val-roc: 0.8980 - val-ap: 0.9129 (0.1s/epoch)
Epoch  1467/1500:Epoch loss: 0.0978 - avg acc: 87.0% - val-roc: 0.9184 - val-ap: 0.9360 (0.1s/epoch)
Epoch  1468/1500:Epoch loss: 0.1051 - avg acc: 86.3% - val-roc: 0.8878 - val-ap: 0.8991 (0.1s/epoch)
Epoch  1469/1500:Epoch loss: 0.0960 - avg acc: 87.0% - val-roc: 0.8980 - val-ap: 0.9165 (0.1s/epoch)
Epoch  1470/1500:Epoch loss: 0.1143 - avg acc: 88.5% - val-roc: 0.8980 - val-ap: 0.9165 (0.1s/epoch)
Epoch  1471/1500:Epoch loss: 0.0969 - avg acc: 87.8% - val-roc: 0.8878 - val-ap: 0.8844 (0.1s/epoch)
Epoch  1472/1500:Epoch loss: 0.0987 - avg acc: 88.5% - val-roc: 0.8776 - val-ap: 0.8758 (0.1s/epoch)
Epoch  1473/1500:Epoch loss: 0.1058 - avg acc: 88.5% - val-roc: 0.8980 - val-ap: 0.9199 (0.1s/epoch)
Epoch  1474/1500:Epoch loss: 0.0952 - avg acc: 87.8% - val-roc: 0.9082 - val-ap: 0.9284 (0.1s/epoch)
Epoch  1475/1500:Epoch loss: 0.0915 - avg acc: 88.5% - val-roc: 0.9031 - val-ap: 0.9200 (0.1s/epoch)
Epoch  1476/1500:Epoch loss: 0.1120 - avg acc: 88.5% - val-roc: 0.9031 - val-ap: 0.9200 (0.1s/epoch)
Epoch  1477/1500:Epoch loss: 0.0920 - avg acc: 90.1% - val-roc: 0.8980 - val-ap: 0.9181 (0.1s/epoch)
Epoch  1478/1500:Epoch loss: 0.0626 - avg acc: 90.1% - val-roc: 0.8980 - val-ap: 0.9181 (0.1s/epoch)
Epoch  1479/1500:Epoch loss: 0.0988 - avg acc: 90.1% - val-roc: 0.9031 - val-ap: 0.9200 (0.1s/epoch)
Epoch  1480/1500:Epoch loss: 0.0902 - avg acc: 90.1% - val-roc: 0.9031 - val-ap: 0.9221 (0.1s/epoch)
Epoch  1481/1500:Epoch loss: 0.1145 - avg acc: 90.1% - val-roc: 0.8980 - val-ap: 0.9157 (0.1s/epoch)
Epoch  1482/1500:Epoch loss: 0.0950 - avg acc: 89.3% - val-roc: 0.8980 - val-ap: 0.9140 (0.1s/epoch)
Epoch  1483/1500:Epoch loss: 0.1320 - avg acc: 90.1% - val-roc: 0.8980 - val-ap: 0.9104 (0.1s/epoch)
Epoch  1484/1500:Epoch loss: 0.1287 - avg acc: 90.1% - val-roc: 0.8673 - val-ap: 0.8650 (0.1s/epoch)
Epoch  1485/1500:Epoch loss: 0.0775 - avg acc: 89.3% - val-roc: 0.8724 - val-ap: 0.8682 (0.1s/epoch)
Epoch  1486/1500:Epoch loss: 0.1074 - avg acc: 88.5% - val-roc: 0.8776 - val-ap: 0.8866 (0.1s/epoch)
Epoch  1487/1500:Epoch loss: 0.0832 - avg acc: 89.3% - val-roc: 0.8827 - val-ap: 0.8903 (0.1s/epoch)
Epoch  1488/1500:Epoch loss: 0.0928 - avg acc: 89.3% - val-roc: 0.8776 - val-ap: 0.8881 (0.1s/epoch)
Epoch  1489/1500:Epoch loss: 0.0952 - avg acc: 89.3% - val-roc: 0.8776 - val-ap: 0.8881 (0.1s/epoch)
Epoch  1490/1500:Epoch loss: 0.0926 - avg acc: 89.3% - val-roc: 0.8776 - val-ap: 0.8881 (0.1s/epoch)
Epoch  1491/1500:Epoch loss: 0.0757 - avg acc: 89.3% - val-roc: 0.8622 - val-ap: 0.8602 (0.1s/epoch)
Epoch  1492/1500:Epoch loss: 0.1760 - avg acc: 90.1% - val-roc: 0.8571 - val-ap: 0.8339 (0.1s/epoch)
Epoch  1493/1500:Epoch loss: 0.0857 - avg acc: 89.3% - val-roc: 0.8622 - val-ap: 0.8382 (0.1s/epoch)
Epoch  1494/1500:Epoch loss: 0.0895 - avg acc: 89.3% - val-roc: 0.8418 - val-ap: 0.7729 (0.1s/epoch)
Epoch  1495/1500:Epoch loss: 0.1012 - avg acc: 89.3% - val-roc: 0.8265 - val-ap: 0.7650 (0.1s/epoch)
Epoch  1496/1500:Epoch loss: 0.0889 - avg acc: 89.3% - val-roc: 0.8367 - val-ap: 0.7710 (0.1s/epoch)
Epoch  1497/1500:Epoch loss: 0.0905 - avg acc: 89.3% - val-roc: 0.8367 - val-ap: 0.7719 (0.1s/epoch)
Epoch  1498/1500:Epoch loss: 0.0773 - avg acc: 89.3% - val-roc: 0.8316 - val-ap: 0.7691 (0.1s/epoch)
Epoch  1499/1500:Epoch loss: 0.0992 - avg acc: 89.3% - val-roc: 0.8418 - val-ap: 0.7749 (0.1s/epoch)
Epoch  1500/1500:Epoch loss: 0.0849 - avg acc: 90.1% - val-roc: 0.8418 - val-ap: 0.7749 (0.1s/epoch)
Done!
Test ROC: 0.8722 - Test AP: 0.9376
</pre></div>
</div>
</div>
</div>
</section>
<section id="plots-of-training-history">
<h3>Plots of training history<a class="headerlink" href="#plots-of-training-history" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_history</span><span class="p">(</span><span class="n">history</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/768ce018e6fac48abdaaa85364b2b9a859ad21306f6ad71a54840d0bebbe9e0c.png" src="../_images/768ce018e6fac48abdaaa85364b2b9a859ad21306f6ad71a54840d0bebbe9e0c.png" />
</div>
</div>
</section>
</section>
<section id="validation-on-unseen-data">
<h2>Validation on unseen data<a class="headerlink" href="#validation-on-unseen-data" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_roc</span><span class="p">,</span> <span class="n">test_ap</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">test</span><span class="p">(</span>
    <span class="n">dataloaders</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">return_preds</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test ROC-AUC: </span><span class="si">{</span><span class="n">test_roc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test AP: </span><span class="si">{</span><span class="n">test_ap</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot the ROC curve</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">plot_roc_curve</span><span class="p">(</span><span class="n">dataloaders</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Number of correct positive predictions on test set: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">preds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">ys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">}</span><span class="s2"> out of </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Number of correct negative predictions on test set: </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">preds</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">ys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">}</span><span class="s2"> out of </span><span class="si">{</span><span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test ROC-AUC: 0.8722
Test AP: 0.9376
</pre></div>
</div>
<img alt="../_images/e45e743fcdc206160fee1e1314d5f1d1f3985bf9e84fcb41e60702a77482835f.png" src="../_images/e45e743fcdc206160fee1e1314d5f1d1f3985bf9e84fcb41e60702a77482835f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of correct positive predictions on test set: 14 out of 20
Number of correct negative predictions on test set: 7 out of 9
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">show_preds_distribution</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e500f1eb252d9560eabe49571d4ff06120dd58b40a08b111163c391a59b11085.png" src="../_images/e500f1eb252d9560eabe49571d4ff06120dd58b40a08b111163c391a59b11085.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This plot shows the distribution of the labels and predictions;
predictions are overlayed on top of the labels,
showing whether they are missing or surnumerous.
The labels are 20 positive and 9 negative.
The predictions are 16 positive and 13 negative.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9b30f29169b7a173f81890321eddbbb1286976ea3bc8776f74398c70bd84210c.png" src="../_images/9b30f29169b7a173f81890321eddbbb1286976ea3bc8776f74398c70bd84210c.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mislabeled</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_mislabeled_molecules</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">ys</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">mislabeled</span><span class="p">)</span><span class="si">}</span><span class="s2"> mislabeled molecules&quot;</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">id_mol</span> <span class="ow">in</span> <span class="n">mislabeled</span><span class="p">:</span>
    <span class="n">mols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dataloaders</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">dataset</span><span class="p">[</span><span class="n">id_mol</span><span class="p">])</span>

<span class="n">thresh_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">preds</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="n">mislabeled</span><span class="p">]</span>
<span class="n">utils</span><span class="o">.</span><span class="n">draw_molecule_from_dict</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span>
    <span class="n">preds</span><span class="o">=</span><span class="n">thresh_preds</span><span class="p">,</span>
    <span class="n">mol_ids</span><span class="o">=</span><span class="n">mislabeled</span><span class="p">,</span>
    <span class="n">n_cols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8 mislabeled molecules
</pre></div>
</div>
<img alt="../_images/4327386ef468ce2715c5c8a8111e2a57f67291041cdda8394f7e143f105d4923.png" src="../_images/4327386ef468ce2715c5c8a8111e2a57f67291041cdda8394f7e143f105d4923.png" />
</div>
</div>
</section>
<section id="full-dataset-performance">
<h2>Full dataset performance<a class="headerlink" href="#full-dataset-performance" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_all</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">create_dataset_dict</span><span class="p">(</span><span class="n">add_edge_features</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">full_dataset</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">MutagDataset</span><span class="p">(</span><span class="n">data_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="full-roc-curve">
<h3>Full ROC curve<a class="headerlink" href="#full-roc-curve" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_roc</span><span class="p">,</span> <span class="n">full_ap</span><span class="p">,</span> <span class="n">preds</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">test</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">return_preds</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Full ROC-AUC: </span><span class="si">{</span><span class="n">full_roc</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Full AP: </span><span class="si">{</span><span class="n">full_ap</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Plot the ROC curve</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">plot_roc_curve</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

<span class="n">preds</span> <span class="o">=</span> <span class="n">preds</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">ys</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Number of correct positive predictions on test set: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">preds</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">ys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span><span class="si">}</span><span class="s2"> out of </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;Number of correct negative predictions on test set: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">preds</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">ys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="si">}</span><span class="s2"> out of </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ys</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Full ROC-AUC: 0.9525
Full AP: 0.9631
</pre></div>
</div>
<img alt="../_images/7ab1b309d1eaeaee738dcb94da4efbd03e4d4847d9b74bf70b68eb68e9e4af82.png" src="../_images/7ab1b309d1eaeaee738dcb94da4efbd03e4d4847d9b74bf70b68eb68e9e4af82.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of correct positive predictions on test set: 107 out of 125
Number of correct negative predictions on test set: 57 out of 63
</pre></div>
</div>
</div>
</div>
</section>
<section id="predictions-distribution">
<h3>Predictions distribution<a class="headerlink" href="#predictions-distribution" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">show_preds_distribution</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/58f7e45025ccec395b16c8b6e28ec391c915a0d8444be2e72b7126294ac830e0.png" src="../_images/58f7e45025ccec395b16c8b6e28ec391c915a0d8444be2e72b7126294ac830e0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This plot shows the distribution of the labels and predictions;
predictions are overlayed on top of the labels,
showing whether they are missing or surnumerous.
The labels are 125 positive and 63 negative.
The predictions are 113 positive and 75 negative.
</pre></div>
</div>
</div>
</div>
</section>
<section id="confusion-matrix">
<h3>Confusion matrix<a class="headerlink" href="#confusion-matrix" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">utils</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e678cc1c371c114273b588afe10c92a741b5cbedc47e7cadb424b97f8a588664.png" src="../_images/e678cc1c371c114273b588afe10c92a741b5cbedc47e7cadb424b97f8a588664.png" />
</div>
</div>
</section>
<section id="check-mislabelled-molecules">
<h3>Check mislabelled molecules<a class="headerlink" href="#check-mislabelled-molecules" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mislabeled</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">find_mislabeled_molecules</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">ys</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">mislabeled</span><span class="p">)</span><span class="si">}</span><span class="s2"> mislabeled molecules&quot;</span><span class="p">)</span>
<span class="n">mols</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">id_mol</span> <span class="ow">in</span> <span class="n">mislabeled</span><span class="p">:</span>
    <span class="n">mols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">full_dataset</span><span class="p">[</span><span class="n">id_mol</span><span class="p">])</span>

<span class="n">thresh_preds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">preds</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)[</span><span class="n">mislabeled</span><span class="p">]</span>
<span class="n">utils</span><span class="o">.</span><span class="n">draw_molecule_from_dict</span><span class="p">(</span>
    <span class="n">mols</span><span class="p">[:</span><span class="mi">30</span><span class="p">],</span>
    <span class="n">preds</span><span class="o">=</span><span class="n">thresh_preds</span><span class="p">,</span>
    <span class="n">mol_ids</span><span class="o">=</span><span class="n">mislabeled</span><span class="p">,</span>
    <span class="n">n_cols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">n_rows</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
    <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24 mislabeled molecules
</pre></div>
</div>
<img alt="../_images/8e87b4d09bdfc4be78365c9611fe9e051659c3ff890a0307f5746d7a53bf7334.png" src="../_images/8e87b4d09bdfc4be78365c9611fe9e051659c3ff890a0307f5746d7a53bf7334.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./rendered_notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="SAGE.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">GraphSAGE</p>
      </div>
    </a>
    <a class="right-next"
       href="EdgeAttentionGCN.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Edge-Enhanced Attention GCN</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#layer-definition">Layer definition</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training">Training</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model">Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#training-parameters">Training parameters</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#train-loop">Train loop</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plots-of-training-history">Plots of training history</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-on-unseen-data">Validation on unseen data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#full-dataset-performance">Full dataset performance</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-roc-curve">Full ROC curve</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predictions-distribution">Predictions distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confusion-matrix">Confusion matrix</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-mislabelled-molecules">Check mislabelled molecules</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Cyril Achard
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=c5ced968eda925caa686"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>